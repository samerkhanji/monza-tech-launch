/**
 * setup-env.js
 * Quick setup script to create .env.local with Supabase credentials
 * Run: node setup-env.js
 */
const fs = require('fs');
const path = require('path');

// Known Supabase URL from your app
const SUPABASE_URL = 'https://wunqntfreyezylvbzvxc.supabase.co';

console.log('üîß MONZA TECH ENVIRONMENT SETUP');
console.log('================================');
console.log('');
console.log('‚úÖ Found your Supabase URL:', SUPABASE_URL);
console.log('');
console.log('‚ùì YOU NEED 2 MORE CREDENTIALS:');
console.log('');
console.log('1Ô∏è‚É£ ANON KEY (public key):');
console.log('   Go to: https://supabase.com/dashboard/project/wunqntfreyezylvbzvxc/settings/api');
console.log('   Copy the "anon/public" key');
console.log('');
console.log('2Ô∏è‚É£ SERVICE ROLE KEY (private key):');
console.log('   Copy the "service_role" key from the same page');
console.log('   ‚ö†Ô∏è  KEEP THIS SECRET - never expose in frontend');
console.log('');

// Get input from user
const readline = require('readline');
const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

console.log('üìù Enter your credentials below:');
console.log('');

rl.question('üîë Paste your ANON KEY: ', (anonKey) => {
  rl.question('üîê Paste your SERVICE_ROLE KEY: ', (serviceKey) => {
    
    const envContent = `# Monza Tech Supabase Configuration
# Auto-generated by setup-env.js

# Public API URL
VITE_SUPABASE_URL=${SUPABASE_URL}

# Public anon key (safe for frontend)
VITE_SUPABASE_ANON_KEY=${anonKey}

# Service role key (PRIVATE - for uploads only)
VITE_SUPABASE_SERVICE_ROLE_KEY=${serviceKey}

# Generated on: ${new Date().toISOString()}
`;

    // Write .env.local file
    const envPath = path.join(__dirname, '.env.local');
    
    try {
      fs.writeFileSync(envPath, envContent);
      
      console.log('');
      console.log('üéâ SUCCESS! Environment file created!');
      console.log('');
      console.log('‚úÖ Created: .env.local');
      console.log('‚úÖ Configured: VITE_SUPABASE_URL');
      console.log('‚úÖ Configured: VITE_SUPABASE_ANON_KEY'); 
      console.log('‚úÖ Configured: VITE_SUPABASE_SERVICE_ROLE_KEY');
      console.log('');
      console.log('üöÄ READY TO UPLOAD YOUR 107 CARS!');
      console.log('');
      console.log('Next steps:');
      console.log('1. npm run upload:monza-inventory');
      console.log('2. Refresh your car inventory page');
      console.log('3. See all vehicles displayed!');
      console.log('');
      
    } catch (error) {
      console.error('‚ùå Failed to create .env.local:', error.message);
      console.log('');
      console.log('üìã MANUAL SETUP:');
      console.log('Create a file called .env.local and add:');
      console.log('');
      console.log(envContent);
    }
    
    rl.close();
  });
});
