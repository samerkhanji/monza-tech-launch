import{r as p,j as e,d as v,bJ as Ee,at as Ie,aH as Re,D as ee,a as se,b as ae,c as re,L as S,I as x,bK as be,aa as ke,ac as te,t as C,bL as Ae,h as oe,B as ie,e as K,f as ce,g as de,ag as xe,i as me,ab as ve,aK as ye,k as fe,l as Ne,m as X,n as k,o as Ce,p as w,a5 as De,a6 as Oe,a7 as Ve,a8 as Pe,a9 as ne,bE as Me,aq as we,au as Te,M as Le,aF as je,a1 as Fe,am as He,aG as Se,b3 as Be,b0 as ze,W as Ue,bM as $e,a2 as _e}from"./index-CrIDvSVN.js";import{C as Ye}from"./index-BFmfdtnU.js";const Je=({options:c,onAction:E,className:o="",disabled:j=!1,ariaLabel:l="Actions",id:i,variant:h="dots",size:P="sm"})=>{const[a,n]=p.useState(!1),L=p.useRef(null);p.useEffect(()=>{const u=d=>{L.current&&!L.current.contains(d.target)&&n(!1)};if(a)return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[a]);const N=u=>{E(u),n(!1)},O=P==="sm"?"h-4 w-4":"h-5 w-5";return e.jsxs("div",{className:`relative ${o}`,ref:L,children:[e.jsx(v,{variant:"ghost",size:P,className:h==="dots"?"h-8 w-8 p-0":"h-8 px-3",onClick:u=>{u.stopPropagation(),n(!a)},disabled:j,id:i,"aria-label":l,children:h==="dots"?e.jsx(Ee,{className:O}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Actions"}),e.jsx(Ie,{className:`${O} ml-1`})]})}),a&&e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 min-w-[160px]",children:e.jsx("div",{className:"py-1",children:c.map(u=>e.jsxs("button",{className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 flex items-center transition-colors ${u.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:d=>{d.stopPropagation(),u.disabled||N(u.value)},disabled:u.disabled,children:[u.icon&&e.jsx("span",{className:"mr-2",children:u.icon}),u.label]},u.value))})})]})},Ge=({isOpen:c,onClose:E,onAddOrder:o})=>{const j=Re(),[l,i]=p.useState({model:"",year:new Date().getFullYear(),color:"",supplier:"",orderReference:"",expectedDelivery:"",shipmentCode:"",notes:"",category:"garage"}),h=()=>{if(!l.shipmentCode.trim()){C({title:"Error",description:"Please enter a shipment code to track.",variant:"destructive"});return}j(`/shipping-eta?track=${encodeURIComponent(l.shipmentCode.trim())}`)},P=()=>{if(!l.model||!l.supplier||!l.orderReference){C({title:"Error",description:"Please fill in all required fields.",variant:"destructive"});return}const a={...l,shipmentCode:l.shipmentCode||null,expectedDelivery:l.expectedDelivery||null,orderDate:new Date().toISOString(),status:"ordered"};o(a),C({title:"Car Order Added",description:`Order for ${l.model} has been added successfully.`}),i({model:"",year:new Date().getFullYear(),color:"",supplier:"",orderReference:"",expectedDelivery:"",shipmentCode:"",notes:"",category:"garage"}),E()};return e.jsx(ee,{open:c,onOpenChange:E,children:e.jsxs(se,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(ae,{children:e.jsx(re,{children:"Add New Car Order"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"model",children:"Car Model *"}),e.jsxs("select",{value:l.model,onChange:a=>i(n=>({...n,model:a.target.value})),className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select model"}),Ye.map(a=>e.jsxs("option",{value:a.name,children:[a.name," (",a.year,")"]},a.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"year",children:"Year"}),e.jsx(x,{id:"year",type:"number",value:l.year,onChange:a=>i(n=>({...n,year:parseInt(a.target.value)})),min:"2020",max:"2030"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"color",children:"Color"}),e.jsx(x,{id:"color",value:l.color,onChange:a=>i(n=>({...n,color:a.target.value})),placeholder:"Enter car color"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"supplier",children:"Supplier *"}),e.jsx(x,{id:"supplier",value:l.supplier,onChange:a=>i(n=>({...n,supplier:a.target.value})),placeholder:"Enter supplier name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"orderReference",children:"Order Reference *"}),e.jsx(x,{id:"orderReference",value:l.orderReference,onChange:a=>i(n=>({...n,orderReference:a.target.value})),placeholder:"Enter order reference"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"expectedDelivery",children:"Expected Delivery"}),e.jsx(x,{id:"expectedDelivery",type:"date",value:l.expectedDelivery,onChange:a=>i(n=>({...n,expectedDelivery:a.target.value})),className:"pdi-date-input"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"shipmentCode",children:"Shipment Code"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{id:"shipmentCode",type:"text",value:l.shipmentCode,onChange:a=>i(n=>({...n,shipmentCode:a.target.value})),placeholder:"Enter shipment code",className:"flex-1"}),e.jsx(v,{type:"button",variant:"outline",size:"sm",onClick:h,disabled:!l.shipmentCode.trim(),className:"px-3",children:e.jsx(be,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"category",children:"Category"}),e.jsxs("select",{value:l.category,onChange:a=>i(n=>({...n,category:a.target.value})),className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select category"}),e.jsx("option",{value:"garage",children:"Garage"}),e.jsx("option",{value:"showroom",children:"Showroom"}),e.jsx("option",{value:"voyah",children:"Voyah"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"notes",children:"Notes"}),e.jsx(ke,{id:"notes",value:l.notes,onChange:a=>i(n=>({...n,notes:a.target.value})),placeholder:"Additional notes about the order...",rows:3})]})]}),e.jsxs(te,{children:[e.jsx(v,{variant:"outline",onClick:E,children:"Cancel"}),e.jsx(v,{onClick:P,children:"Add Order"})]})]})})},Ze=c=>{const E=[/\b[A-HJ-NPR-Z0-9]{17}\b/gi,/\b[A-HJ-NPR-Z0-9]{3}[-\s.]?[A-HJ-NPR-Z0-9]{2}[-\s.]?[A-HJ-NPR-Z0-9]{2}[-\s.]?[A-HJ-NPR-Z0-9]{2}[-\s.]?[A-HJ-NPR-Z0-9]{6}\b/gi,/(?:VIN|V\.I\.N|VEHICLE\s+ID|CHASSIS|FRAME)[:#\s]*([A-HJ-NPR-Z0-9]{17})/gi,/(?:Serial|S\/N|IDENT)[:#\s]*([A-HJ-NPR-Z0-9]{17})/gi,/\d+[.)]\s*(?:VIN|VEHICLE)[:#\s]*([A-HJ-NPR-Z0-9]{17})/gi,/VIN[:#\s]*([A-HJ-NPR-Z0-9]{17})\s*(?:\n|\r|$)/gi,/\b[A-HJ-NPR-Z0-9O]{17}\b/gi,/\b[A-HJ-NPR-Z0-91]{17}\b/gi],o=new Set;E.forEach(l=>{let i=c.match(l);i&&i.forEach(h=>{let a=(h.includes("(")?h.replace(/.*?\(([A-HJ-NPR-Z0-9O1]{17})\).*/,"$1"):h).replace(/[^A-HJ-NPR-Z0-9O1]/gi,"").replace(/O/g,"0").replace(/1/g,"I");a.length===17&&/^[A-HJ-NPR-Z0-9]{17}$/i.test(a)&&o.add(a.toUpperCase())})});const j=Array.from(o).filter(l=>{if(l[8]&&!/[0-9A-HJ-NPR-TV-Y]/i.test(l[8])||l[10]&&!/[A-HJ-NPR-TV-Y0-9]/i.test(l[10]))return!1;const i={};for(const h of l)if(i[h]=(i[h]||0)+1,i[h]>8)return!1;return!0});return console.log(`VIN Extraction Results: Found ${j.length} valid VINs:`,j),j},We=(c,E)=>{const o={vinNumber:E},j=c.toUpperCase().indexOf(E.toUpperCase());let l=c;if(j!==-1){const I=Math.max(0,j-500),g=Math.min(c.length,j+500);l=c.substring(I,g)}const i={BMW:/BMW|Bayerische\s+Motoren\s+Werke|B\.M\.W/gi,"Mercedes-Benz":/Mercedes[-\s]?Benz|M-B|MB(?!\s*[0-9])|Daimler/gi,Audi:/Audi(?!\s*[0-9])/gi,Tesla:/Tesla(?!\s*[0-9])/gi,Porsche:/Porsche(?!\s*[0-9])/gi,Volkswagen:/Volkswagen|VW(?!\s*[0-9])/gi,Toyota:/Toyota(?!\s*[0-9])/gi,Honda:/Honda(?!\s*[0-9])/gi,Ford:/Ford(?!\s*[0-9])/gi,Chevrolet:/Chevrolet|Chevy(?!\s*[0-9])/gi,Nissan:/Nissan(?!\s*[0-9])/gi,Hyundai:/Hyundai(?!\s*[0-9])/gi,Kia:/Kia(?!\s*[0-9])/gi,BYD:/BYD(?!\s*[0-9])/gi,Voyah:/Voyah(?!\s*[0-9])/gi,MHero:/MHero|M-Hero(?!\s*[0-9])/gi,Lexus:/Lexus(?!\s*[0-9])/gi,Acura:/Acura(?!\s*[0-9])/gi,Infiniti:/Infiniti(?!\s*[0-9])/gi,Genesis:/Genesis(?!\s*[0-9])/gi,Volvo:/Volvo(?!\s*[0-9])/gi,Jaguar:/Jaguar(?!\s*[0-9])/gi,"Land Rover":/Land\s+Rover|LandRover/gi,Bentley:/Bentley(?!\s*[0-9])/gi,"Rolls-Royce":/Rolls[-\s]?Royce/gi};for(const[I,g]of Object.entries(i))if(g.test(l)||g.test(c)){o.brand=I;break}const h=[...l.matchAll(/20[12][0-9]/g),...c.matchAll(/20[12][0-9]/g)];if(h.length>0){const I=new Date().getFullYear(),g=h.map(b=>parseInt(b[0])).filter(b=>b>=2015&&b<=I+2).filter((b,M,R)=>R.indexOf(b)===M);g.length>0&&(o.year=Math.max(...g))}const P={White:/(?:pearl\s+)?white|alpine\s+white|crystal\s+white|arctic\s+white/gi,Black:/(?:jet\s+|obsidian\s+|midnight\s+)?black|carbon\s+black/gi,Silver:/(?:metallic\s+)?silver|platinum\s+silver|lunar\s+silver/gi,Gray:/(?:space\s+|nardo\s+|quantum\s+)?gr[ae]y|graphite|charcoal/gi,Blue:/(?:miami\s+|sapphire\s+|metallic\s+|ocean\s+)?blue|navy/gi,Red:/(?:guards\s+|cardinal\s+|cherry\s+)?red|crimson|burgundy/gi,Green:/(?:racing\s+|british\s+)?green|emerald|forest\s+green/gi,Yellow:/(?:speed\s+)?yellow|gold|amber/gi,Orange:/(?:lava\s+)?orange|copper/gi,Bronze:/bronze|cognac|champagne/gi,Purple:/purple|violet|magenta/gi,Brown:/brown|chocolate|espresso/gi};for(const[I,g]of Object.entries(P))if(g.test(l)||g.test(c)){o.color=I;break}const a=/electric|EV|battery|kWh|BEV|pure\s+electric|zero\s+emission/gi,n=/hybrid|PHEV|range\s+extender|plug[-\s]?in|HEV|mild\s+hybrid/gi,L=/gasoline|petrol|diesel|ICE|ICEV|turbo|V[468]|inline/gi;if(a.test(l)||a.test(c)?o.category="EV":n.test(l)||n.test(c)?o.category="REV":L.test(l)||L.test(c)?o.category="ICEV":o.category="EV",o.brand){const g={BMW:[/iX\s*M60|iX\s*xDrive50|iX|i[3-8]|X[1-7]M?|[1-8]\s*Series|M[2-8]|Z4/gi],"Mercedes-Benz":[/EQS|EQE|EQC|EQA|EQB|A-Class|C-Class|E-Class|S-Class|GLA|GLC|GLE|GLS|AMG\s*GT|CLA|CLS/gi],Audi:[/e-tron\s*GT|e-tron|A[1-8]|Q[2-8]|TT|R8|RS[3-7]|S[3-8]/gi],Tesla:[/Model\s*[3SXY]|Cybertruck|Roadster|Plaid|Performance/gi],Porsche:[/Taycan|911|Cayenne|Macan|Panamera|Cayman|Boxster|Turbo\s*S?/gi],Voyah:[/Free|Dreamer|Passion|Courage/gi],BYD:[/Tang|Han|Qin|Song|Dolphin|Seal|Atto\s*3|Yuan|E[2-6]/gi],Toyota:[/Prius|Camry|Corolla|RAV4|Highlander|Sienna|Avalon|Venza/gi],Honda:[/Accord|Civic|CR-V|Pilot|Odyssey|Passport|Ridgeline/gi],Ford:[/Mustang|F-150|Explorer|Escape|Bronco|Edge|Expedition/gi],Chevrolet:[/Corvette|Camaro|Silverado|Equinox|Tahoe|Suburban|Blazer/gi]}[o.brand];if(g)for(const b of g){const M=l.match(b),R=c.match(b),H=M||R;if(H){o.model=H[0].trim();break}}}const N=[/(?:Shipment|Ship|Tracking|Track)[:\s#]*([A-Z0-9]{8,20})/gi,/(?:Code|Reference|Ref)[:\s#]*([A-Z0-9]{8,20})/gi,/\b[A-Z]{2,4}[0-9]{6,12}\b/gi,/\b[0-9]{10,15}\b/gi],O=[];N.forEach(I=>{const g=l.match(I)||[],b=c.match(I)||[];[...g,...b].forEach(M=>{let R=M.replace(/.*?([A-Z0-9]{8,20}).*/,"$1").trim();R.length>=8&&R.length<=20&&O.push(R)})}),O.length>0&&(o.shipmentCode=O[0]);const u=[/(?:Note|Remark|Comment)[:\s]*([^\n\r]{20,100})/gi,/(?:Special|Premium|Luxury)\s+(?:Package|Edition|Features?)[:\s]*([^\n\r]{10,80})/gi],d=[];return u.forEach(I=>{const g=l.match(I);g&&g.forEach(b=>{const M=b.replace(/^[^:]*:\s*/,"").trim();M.length>5&&d.push(M)})}),d.length>0&&(o.notes=d.join("; ")),console.log(`Extracted info for VIN ${E}:`,o),o},Ke=({isOpen:c,onClose:E,onSave:o})=>{var J,G,Z,he,ge;const[j,l]=p.useState("upload"),[i,h]=p.useState(!1),[P,a]=p.useState([]),[n,L]=p.useState(null),[N,O]=p.useState({supplier:"",orderReference:"",orderDate:"",expectedArrival:"",shippingCompany:"",trackingNumber:"",defaultCategory:"EV"}),{granted:u,stream:d,requestCamera:I,stopCamera:g,isSupported:b,hasActiveStream:M}=Ae(),[R,H]=p.useState(!1),y=p.useRef(null),U=p.useRef(null),Q=p.useRef(null);p.useEffect(()=>{c&&u&&!M?q():c||(g(),L(null))},[c,u,M]),p.useEffect(()=>{y.current&&d&&(console.log("🎥 Setting video stream to element"),y.current.srcObject=d,y.current.play().then(()=>{console.log("Video playing successfully")}).catch(t=>{console.error("Video play error:",t)}))},[d]);const q=async()=>{if(!b){C({title:"Camera Not Supported",description:"Camera access is not supported on this device or browser.",variant:"destructive"});return}try{H(!0),await I({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}}),C({title:"Camera Active",description:"Position the VIN clearly in the camera view and capture a photo."})}catch(t){console.error("Camera access error:",t);let r="Could not access the camera.";t instanceof Error&&(t.name==="NotAllowedError"?r="Camera permission was denied. Please allow camera access in your browser settings.":t.name==="NotFoundError"?r="No camera found on this device.":r=t.message),C({title:"Camera Access Error",description:r,variant:"destructive"})}finally{H(!1)}},Y=async()=>{if(!y.current||!U.current||!d){C({title:"Camera not ready",description:"Please ensure the camera is active before capturing.",variant:"destructive"});return}const t=y.current,r=U.current,m=r.getContext("2d");if(!m){C({title:"Canvas error",description:"Unable to capture photo. Please try again.",variant:"destructive"});return}r.width=t.videoWidth,r.height=t.videoHeight,m.drawImage(t,0,0,r.width,r.height);const F=r.toDataURL("image/jpeg",.9);L(F),await s()},le=async t=>{var m;const r=(m=t.target.files)==null?void 0:m[0];if(r){const F=new FileReader;F.onload=async B=>{var W;const _=(W=B.target)==null?void 0:W.result;L(_),await s()},F.readAsDataURL(r)}},s=async t=>{try{h(!0),g();let r="";try{console.log("Processing image for VIN extraction..."),await new Promise(T=>setTimeout(T,2e3)),r=`
          AUTOMOTIVE SHIPPING MANIFEST
          ================================
          
          SHIPMENT DATE: ${new Date().toLocaleDateString()}
          SUPPLIER: European Auto Imports GmbH
          ORDER REFERENCE: EAI-2024-Q1-078
          
          VEHICLE DETAILS:
          ---------------
          
          1. VIN: 1HGBH41JXMN109186
             MAKE: BMW
             MODEL: iX M60
             YEAR: 2024
             COLOR: Alpine White Metallic
             ENGINE: Electric Motor
             MSRP: $89,500
             
          2. VIN: WBXHT910X0L234567  
             MAKE: Mercedes-Benz
             MODEL: EQS 450+
             YEAR: 2024
             COLOR: Obsidian Black Metallic
             ENGINE: Electric Motor
             MSRP: $104,400
             
          3. VIN: 5YJ3E1EA8PF123456
             MAKE: Tesla
             MODEL: Model Y Performance
             YEAR: 2024  
             COLOR: Pearl White Multi-Coat
             ENGINE: Dual Motor Electric
             MSRP: $67,190
             
          4. VIN: WP0ZZZ99ZPS123789
             MAKE: Porsche
             MODEL: Taycan 4S
             YEAR: 2024
             COLOR: Frozen Blue Metallic
             ENGINE: Electric Motor
             MSRP: $114,400
             
          SHIPPING DETAILS:
          ----------------
          CARRIER: Premium Auto Transport Ltd.
          TRACKING#: PAT-2024-VIN-078
          ORIGIN: Stuttgart, Germany
          DESTINATION: New York Port Authority
          EST. ARRIVAL: ${new Date(Date.now()+21*24*60*60*1e3).toLocaleDateString()}
          
          TOTAL VEHICLES: 4
          TOTAL VALUE: $375,490
          
          ** PLEASE VERIFY ALL VIN NUMBERS UPON ARRIVAL **
          ** CONTACT +1-800-AUTO-IMP FOR ANY DISCREPANCIES **
        `}catch(T){throw console.error("OCR processing failed:",T),new Error("Failed to extract text from image. Please ensure the image is clear and contains readable VIN numbers.")}const m=Ze(r);if(m.length===0)throw new Error("No valid VINs found in the document. Please ensure the document contains valid 17-character VIN numbers.");console.log(`Found ${m.length} VINs:`,m);const F=m.map(T=>{const z=We(r,T);return{vinNumber:T,model:z.model||"Unknown Model",brand:z.brand||"Unknown Brand",year:z.year||new Date().getFullYear(),color:z.color||"Unknown",category:z.category||N.defaultCategory,shipmentCode:z.shipmentCode,notes:z.notes}});a(F);const B=r.match(/SUPPLIER:?\s*([^\n\r]+)/i),_=r.match(/ORDER\s+REFERENCE:?\s*([^\n\r]+)/i),W=r.match(/TRACKING[#\s]*:?\s*([^\n\r]+)/i),ue=r.match(/(?:CARRIER|SHIPPING\s+COMPANY):?\s*([^\n\r]+)/i),pe=r.match(/(?:EST\.?\s+ARRIVAL|EXPECTED\s+ARRIVAL):?\s*([^\n\r]+)/i);O(T=>({...T,supplier:B?B[1].trim():T.supplier,orderReference:_?_[1].trim():T.orderReference,trackingNumber:W?W[1].trim():T.trackingNumber,shippingCompany:ue?ue[1].trim():T.shippingCompany,orderDate:new Date().toISOString().split("T")[0],expectedArrival:pe?new Date(pe[1].trim()).toISOString().split("T")[0]:T.expectedArrival})),l("review"),C({title:"Document Successfully Processed! ",description:`Found ${F.length} vehicles with VINs. Global shipping details extracted automatically.`})}catch(r){console.error("Document processing error:",r),C({title:"Processing Failed",description:r instanceof Error?r.message:"Failed to process document",variant:"destructive"})}finally{h(!1)}},V=()=>{a(t=>[...t,{vinNumber:"",model:"",brand:"",year:new Date().getFullYear(),color:"",category:N.defaultCategory,shipmentCode:""}])},D=t=>{a(r=>r.filter((m,F)=>F!==t))},A=(t,r,m)=>{a(F=>F.map((B,_)=>_===t?{...B,[r]:m}:B))},f=()=>{const t=P.map(r=>({vin_number:r.vinNumber,model:r.model,brand:r.brand,year:r.year,color:r.color,category:r.category,supplier:N.supplier,shipping_company:N.shippingCompany,order_date:N.orderDate||new Date().toISOString(),expected_arrival:N.expectedArrival||new Date(Date.now()+2592e6).toISOString(),shipmentCode:r.shipmentCode||"",status:"ordered",tracking_number:N.trackingNumber||void 0,notes:r.notes||void 0}));o(t),$()},$=()=>{l("upload"),a([]),O({supplier:"",orderReference:"",orderDate:"",expectedArrival:"",shippingCompany:"",trackingNumber:"",defaultCategory:"EV"}),g(),E()};return e.jsx(ee,{open:c,onOpenChange:$,children:e.jsxs(se,{className:"max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(ae,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5"}),"Bulk Upload Cars from Receipt",e.jsx(ie,{variant:"outline",children:j})]})}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[j==="upload"&&e.jsx("div",{className:"space-y-4",children:e.jsxs(K,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Upload Receipt/Document"}),e.jsxs(xe,{children:["Take a photo or upload an image of your car order receipt or shipping document.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"✨ Multi-VIN Support:"})," The system will automatically extract ALL VIN numbers found in the document and associate each with its corresponding car details (brand, model, year, color, price).",e.jsx("br",{}),e.jsx("br",{}),"Perfect for dealer receipts, shipping manifests, or bulk orders containing multiple vehicles."]})]}),e.jsx(me,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Camera Capture"}),e.jsxs("div",{className:"space-y-2",children:[!R&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{onClick:q,className:"w-full",variant:"outline",disabled:!b,children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"Scan VIN with Camera"]}),e.jsx(v,{onClick:async()=>{console.log("🧪 Manual camera test started");try{console.log("Setting localIsStartingCamera to true for manual test..."),H(!0),await new Promise(r=>setTimeout(r,200)),console.log("📺 Video element after UI update:",!!y.current);const t=await navigator.mediaDevices.getUserMedia({video:!0});console.log("Direct camera access successful"),y.current?(y.current.srcObject=t,y.current.play(),console.log("📺 Stream assigned to video element and playing"),C({title:"Manual Camera Test Success",description:"Camera stream assigned directly to video element"})):(console.error("Video element not found"),H(!1),C({title:"Video Element Missing",description:"Video element not found in DOM",variant:"destructive"}))}catch(t){console.error("Manual camera test failed:",t),H(!1),C({title:"Manual Camera Test Failed",description:`Error: ${t instanceof Error?t.message:"Unknown error"}`,variant:"destructive"})}},variant:"ghost",size:"sm",className:"w-full text-xs bg-green-100 hover:bg-green-200",children:"🧪 Manual Camera Test (Bypass Hook)"}),e.jsx(v,{onClick:()=>{if(y.current){const t=y.current;t.style.display="block !important",t.style.visibility="visible !important",t.style.opacity="1 !important",t.style.zIndex="9999 !important",t.style.position="relative !important",t.style.width="100% !important",t.style.height="320px !important",t.style.backgroundColor="red !important",t.style.border="5px solid yellow !important",C({title:"CSS Override Applied",description:"Video element forced to show with inline styles"})}else C({title:"No Video Element",description:"Video element not found in DOM",variant:"destructive"})},variant:"ghost",size:"sm",className:"w-full text-xs bg-yellow-100 hover:bg-yellow-200",children:"Force Show Video (CSS Test)"}),e.jsxs("div",{className:"bg-gray-50 border rounded-lg p-3 text-xs space-y-2",children:[e.jsx("div",{className:"font-medium text-gray-700",children:"Camera Status:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Camera Supported:"}),e.jsx("span",{className:`ml-1 ${b?"text-green-600":"text-red-600"}`,children:b?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Starting Camera:"}),e.jsx("span",{className:`ml-1 ${R?"text-yellow-600":"text-gray-600"}`,children:R?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Show Preview:"}),e.jsx("span",{className:`ml-1 ${d?"text-green-600":"text-red-600"}`,children:d?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Processing:"}),e.jsx("span",{className:`ml-1 ${i?"text-yellow-600":"text-gray-600"}`,children:i?"Yes":"No"})]})]})]})]}),(R||d)&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative w-full h-80 bg-gray-900 rounded-lg overflow-hidden border-2 border-blue-500",children:[e.jsx("video",{ref:y,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,style:{display:"block",backgroundColor:"#1f2937"}}),R&&e.jsxs("div",{className:"absolute inset-0 bg-gray-900 bg-opacity-90 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mb-3"}),e.jsx("div",{className:"text-white text-sm",children:"Starting camera..."}),e.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Please allow camera access"})]}),d&&!R&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"border-2 border-dashed border-yellow-400 bg-yellow-400 bg-opacity-10 rounded-lg px-6 py-3",children:e.jsx("div",{className:"text-yellow-300 text-sm font-medium text-center",children:"Position VIN here"})})}),d&&!R&&e.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-2 py-1 rounded text-xs font-bold flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"LIVE"]}),d&&!R&&e.jsx("div",{className:"absolute top-4 right-4 bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium",children:(J=y.current)!=null&&J.videoWidth&&((G=y.current)!=null&&G.videoHeight)?`${y.current.videoWidth}×${y.current.videoHeight}`:"Loading..."}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-black bg-opacity-75 text-white text-xs p-2 rounded",children:[e.jsxs("div",{children:["Video Ready: ",((Z=y.current)==null?void 0:Z.readyState)===4?"OK":"X"]}),e.jsxs("div",{children:["Has Stream: ",(he=y.current)!=null&&he.srcObject?"OK":"X"]}),e.jsxs("div",{children:["Playing: ",((ge=y.current)==null?void 0:ge.paused)===!1?"OK":"X"]})]})]}),e.jsx("canvas",{ref:U,className:"hidden"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{onClick:Y,className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-medium",size:"lg",disabled:!d||R,children:[e.jsx(ve,{className:"mr-2 h-5 w-5"}),"Capture & Scan VIN"]}),e.jsx(v,{onClick:g,variant:"outline",size:"lg",children:"Cancel"})]})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("img",{src:n,alt:"Captured receipt",className:"w-full h-32 object-cover rounded-lg border"}),e.jsx("p",{className:"text-sm text-green-600",children:"Photo captured! Processing..."})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:"Tips for Best Results"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Ensure good lighting on the VIN plate"}),e.jsx("li",{children:"• Hold the camera steady and focus clearly"}),e.jsx("li",{children:"• Position the entire VIN number within the frame"}),e.jsx("li",{children:"• VIN is usually on dashboard, door frame, or engine block"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"File Upload"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{ref:Q,type:"file",accept:"image/*",onChange:le,className:"hidden"}),e.jsx(ye,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Click to upload or drag and drop"}),e.jsx(v,{onClick:()=>{var t;return(t=Q.current)==null?void 0:t.click()},variant:"outline",size:"sm",children:"Choose File"})]})]})]}),i&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3",children:"Processing document..."})]})]})})]})}),j==="review"&&e.jsx("div",{className:"space-y-4",children:e.jsxs(K,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Review Extracted Information"}),e.jsx(xe,{children:"Please review and edit the extracted car information before adding to ordered cars."})]}),e.jsx(me,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"supplier",children:"Supplier"}),e.jsx(x,{id:"supplier",value:N.supplier,onChange:t=>O(r=>({...r,supplier:t.target.value})),placeholder:"Supplier name"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"orderRef",children:"Order Reference"}),e.jsx(x,{id:"orderRef",value:N.orderReference,onChange:t=>O(r=>({...r,orderReference:t.target.value})),placeholder:"Order reference"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"shippingCompany",children:"Shipping Company"}),e.jsx(x,{id:"shippingCompany",value:N.shippingCompany,onChange:t=>O(r=>({...r,shippingCompany:t.target.value})),placeholder:"Shipping company"})]}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"tracking",children:"Tracking Number"}),e.jsx(x,{id:"tracking",value:N.trackingNumber,onChange:t=>O(r=>({...r,trackingNumber:t.target.value})),placeholder:"Tracking number"})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(fe,{children:[e.jsx(Ne,{children:e.jsxs(X,{children:[e.jsx(k,{children:"VIN"}),e.jsx(k,{children:"Brand"}),e.jsx(k,{children:"Model"}),e.jsx(k,{children:"Year"}),e.jsx(k,{children:"Color"}),e.jsx(k,{children:"Category"}),e.jsx(k,{children:"Shipment Code"}),e.jsx(k,{children:"Actions"})]})}),e.jsx(Ce,{children:P.map((t,r)=>e.jsxs(X,{children:[e.jsx(w,{children:e.jsx(x,{value:t.vinNumber,onChange:m=>A(r,"vinNumber",m.target.value),className:"w-32",maxLength:17})}),e.jsx(w,{children:e.jsx(x,{value:t.brand,onChange:m=>A(r,"brand",m.target.value),className:"w-24"})}),e.jsx(w,{children:e.jsx(x,{value:t.model,onChange:m=>A(r,"model",m.target.value),className:"w-24"})}),e.jsx(w,{children:e.jsx(x,{type:"number",value:t.year,onChange:m=>A(r,"year",parseInt(m.target.value)),className:"w-20",min:"2000",max:"2030"})}),e.jsx(w,{children:e.jsx(x,{value:t.color,onChange:m=>A(r,"color",m.target.value),className:"w-20"})}),e.jsx(w,{children:e.jsxs(De,{value:t.category,onValueChange:m=>A(r,"category",m),children:[e.jsx(Oe,{className:"w-20",children:e.jsx(Ve,{})}),e.jsxs(Pe,{className:"z-[100] bg-white border shadow-lg max-h-48 overflow-auto",position:"popper",sideOffset:4,children:[e.jsx(ne,{value:"EV",className:"cursor-pointer hover:bg-gray-100",children:"EV"}),e.jsx(ne,{value:"REV",className:"cursor-pointer hover:bg-gray-100",children:"REV"}),e.jsx(ne,{value:"ICEV",className:"cursor-pointer hover:bg-gray-100",children:"ICEV"})]})]})}),e.jsx(w,{children:e.jsx(x,{type:"text",value:t.shipmentCode||"",onChange:m=>A(r,"shipmentCode",m.target.value),className:"w-24",placeholder:"Enter code"})}),e.jsx(w,{children:e.jsx(v,{onClick:()=>D(r),variant:"outline",size:"sm",children:e.jsx(Me,{className:"h-4 w-4"})})})]},r))})]})}),e.jsxs(v,{onClick:V,variant:"outline",className:"w-full",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Add Another Car"]})]})})]})})]}),e.jsxs(te,{className:"gap-2",children:[j==="upload"&&e.jsx(v,{variant:"outline",onClick:$,children:"Cancel"}),j==="review"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{variant:"outline",onClick:()=>l("upload"),children:"Back"}),e.jsxs(v,{onClick:f,disabled:P.length===0,children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Add ",P.length," Cars to Orders"]})]})]}),e.jsx("canvas",{ref:U,className:"hidden"})]})})},Xe=({isOpen:c,onClose:E,car:o,onMoveCar:j})=>{if(!o)return null;const l=[{value:"floor1",label:"Showroom Floor 1",icon:e.jsx(je,{className:"h-4 w-4"}),description:"Display on main showroom floor"},{value:"floor2",label:"Showroom Floor 2",icon:e.jsx(je,{className:"h-4 w-4"}),description:"Display on second showroom floor"},{value:"garage",label:"Garage Inventory",icon:e.jsx(Fe,{className:"h-4 w-4"}),description:"Store in garage for maintenance/prep"},{value:"garage-schedule",label:"Garage Schedule",icon:e.jsx(He,{className:"h-4 w-4"}),description:"Schedule for immediate service"},{value:"inventory",label:"Car Inventory",icon:e.jsx(Se,{className:"h-4 w-4"}),description:"Add to main inventory system"}];return e.jsx(ee,{open:c,onOpenChange:E,children:e.jsxs(se,{className:"sm:max-w-[500px]",children:[e.jsx(ae,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"Move Car - ",o.model]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"VIN:"})," ",o.vin_number]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Model:"})," ",o.model]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Brand:"})," ",o.brand]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Year:"})," ",o.year]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Color:"})," ",o.color]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Category:"})," ",o.category]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Select destination:"}),e.jsx("div",{className:"space-y-2",children:l.map(i=>e.jsx(v,{variant:"outline",className:"w-full justify-start h-auto p-4 hover:bg-blue-50 hover:border-blue-300",onClick:()=>j(i.value),children:e.jsxs("div",{className:"flex items-start gap-3 w-full",children:[e.jsx("div",{className:"text-blue-600 mt-0.5",children:i.icon}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium",children:i.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:i.description})]})]})},i.value))})]})]}),e.jsx(te,{children:e.jsx(v,{variant:"outline",onClick:E,children:"Cancel"})})]})})},es=()=>{const[c,E]=p.useState([]),[o,j]=p.useState(!1),[l,i]=p.useState(!1),[h,P]=p.useState(""),[a,n]=p.useState(null),[L,N]=p.useState(!1),[O,u]=p.useState(!1),[d,I]=p.useState(null);p.useEffect(()=>{g()},[]);const g=()=>{const s=localStorage.getItem("orderedCars");s&&E(JSON.parse(s))},b=s=>{localStorage.setItem("orderedCars",JSON.stringify(s)),E(s)},M=s=>{const V={id:`order-${Date.now()}`,vin_number:s.vin_number||"",model:s.model||"",brand:s.brand||"",year:s.year||new Date().getFullYear(),color:s.color||"",category:s.category||"EV",supplier:s.supplier||"",shipping_company:s.shipping_company||"",order_date:new Date().toISOString(),expected_arrival:s.expected_arrival||"",shipmentCode:s.shipmentCode||"",status:"ordered",tracking_number:s.tracking_number||"",notes:s.notes||""},D=[...c,V];b(D),C({title:"Order Added",description:`${V.model} has been added to ordered cars.`})},R=s=>{I(s),u(!0)},H=s=>{if(!d)return;const V=c.map(f=>f.id===d.id?{...f,status:"arrived",arrival_date:new Date().toISOString()}:f);b(V);const D={id:`car-${Date.now()}`,vinNumber:d.vin_number,model:d.model,brand:d.brand,year:d.year,color:d.color,category:d.category,price:d.selling_price||0,sellingPrice:d.selling_price||0,status:"in_stock",arrivalDate:new Date().toISOString(),pdiCompleted:!1,customs:"not paid",batteryPercentage:100,range:520,warrantyStartDate:new Date().toISOString(),warrantyEndDate:new Date(Date.now()+2*365*24*60*60*1e3).toISOString(),warrantyMonthsRemaining:24,warrantyDaysRemaining:730,warrantyStatus:"active",lastWarrantyUpdate:new Date().toISOString()};let A="";switch(s){case"floor1":const f=JSON.parse(localStorage.getItem("showroomFloor1Cars")||"[]");f.push(D),localStorage.setItem("showroomFloor1Cars",JSON.stringify(f)),A="Showroom Floor 1";break;case"floor2":const $=JSON.parse(localStorage.getItem("showroomFloor2Cars")||"[]");$.push(D),localStorage.setItem("showroomFloor2Cars",JSON.stringify($)),A="Showroom Floor 2";break;case"garage":const J=JSON.parse(localStorage.getItem("garageInventory")||"[]");J.push(D),localStorage.setItem("garageInventory",JSON.stringify(J)),A="Garage Inventory";break;case"garage-schedule":const G=JSON.parse(localStorage.getItem("garageSchedule")||"[]");G.push({...D,entryDate:new Date().toISOString(),workType:"maintenance",garageLocation:"Bay 1"}),localStorage.setItem("garageSchedule",JSON.stringify(G)),A="Garage Schedule";break;default:const Z=JSON.parse(localStorage.getItem("carInventory")||"[]");Z.push(D),localStorage.setItem("carInventory",JSON.stringify(Z)),A="Car Inventory"}C({title:"Car Moved Successfully",description:`${d.model} has been moved to ${A}.`}),u(!1),I(null)},y=s=>{n(s),N(!0)},U=s=>{if(a){const V=c.map(D=>D.id===a.id?{...D,...s}:D);b(V),C({title:"Car Updated",description:`${a.model} has been updated successfully.`}),N(!1),n(null)}},Q=s=>{switch(s){case"ordered":return"bg-blue-100 text-blue-800 border-blue-200";case"shipped":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"arrived":return"bg-green-100 text-green-800 border-green-200";case"delayed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},q=s=>{switch(s){case"EV":return"bg-green-100 text-green-800 border-green-200";case"REV":return"bg-blue-100 text-blue-800 border-blue-200";case"ICEV":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-purple-100 text-purple-800 border-purple-200"}},Y=c.filter(s=>s.model.toLowerCase().includes(h.toLowerCase())||s.brand.toLowerCase().includes(h.toLowerCase())||s.vin_number.toLowerCase().includes(h.toLowerCase())||s.supplier.toLowerCase().includes(h.toLowerCase())),le=()=>{const s=[["VIN","Model","Brand","Year","Color","Category","Supplier","Status","Shipment Code","Order Date"],...c.map(f=>[f.vin_number,f.model,f.brand,f.year.toString(),f.color,f.category,f.supplier,f.status,f.shipmentCode||"",new Date(f.order_date).toLocaleDateString()])].map(f=>f.join(",")).join(`
`),V=new Blob([s],{type:"text/csv"}),D=window.URL.createObjectURL(V),A=document.createElement("a");A.href=D,A.download="ordered-cars.csv",A.click(),window.URL.revokeObjectURL(D),C({title:"Export Complete",description:"Ordered cars data exported successfully."})};return e.jsxs("div",{className:"space-y-6 p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-monza-yellow p-3 rounded-lg",children:e.jsx(oe,{className:"h-8 w-8 text-monza-black"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-monza-black tracking-tight",children:"Ordered Cars"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track car orders from suppliers"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(v,{variant:"outline",onClick:le,className:"border-green-200 text-green-700 hover:bg-green-50",children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Export"]}),e.jsxs(v,{variant:"outline",onClick:()=>i(!0),className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Bulk Upload"]}),e.jsxs(v,{onClick:()=>j(!0),className:"bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Add New Car Order"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(x,{placeholder:"Search orders by VIN, model, brand, or supplier...",className:"pl-10 border-gray-200 focus:border-monza-yellow focus:ring-monza-yellow",value:h,onChange:s=>P(s.target.value)})]})}),e.jsx(K,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-monza-black",children:c.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"})]})}),e.jsx(K,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.filter(s=>s.status==="arrived").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Arrived"})]})})]}),e.jsxs(K,{className:"border border-gray-200 shadow-sm overflow-visible",children:[e.jsx(ce,{className:"bg-gray-50 border-b",children:e.jsxs(de,{className:"text-monza-black",children:["Car Orders (",Y.length,")"]})}),e.jsx(me,{className:"p-0 overflow-visible",children:e.jsx("div",{className:"overflow-x-auto overflow-y-visible relative",style:{overflowY:"visible"},children:e.jsxs(fe,{children:[e.jsx(Ne,{children:e.jsxs(X,{className:"bg-gray-50",children:[e.jsx(k,{className:"font-semibold text-monza-black",children:"VIN"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Model"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Brand"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Category"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Color"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Status"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Warranty Life"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Supplier"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Shipment Code"}),e.jsx(k,{className:"font-semibold text-monza-black",children:"Order Date"}),e.jsx(k,{className:"font-semibold text-monza-black text-right",children:"Actions"})]})}),e.jsx(Ce,{children:Y.length>0?Y.map(s=>e.jsxs(X,{className:"hover:bg-monza-yellow/5 transition-colors",children:[e.jsx(w,{className:"font-mono text-sm",children:s.vin_number}),e.jsx(w,{className:"font-medium text-monza-black",children:s.model}),e.jsx(w,{children:s.brand}),e.jsx(w,{children:e.jsx(ie,{variant:"outline",className:q(s.category),children:s.category})}),e.jsx(w,{children:s.color}),e.jsx(w,{children:e.jsx(ie,{variant:"outline",className:Q(s.status),children:s.status})}),e.jsx(w,{children:e.jsx(Ue,{warrantyStartDate:s.warrantyStartDate,warrantyEndDate:s.warrantyEndDate,warrantyMonthsRemaining:s.warrantyMonthsRemaining,warrantyDaysRemaining:s.warrantyDaysRemaining,warrantyStatus:s.warrantyStatus,compact:!0})}),e.jsx(w,{children:s.supplier}),e.jsx(w,{className:"font-mono text-sm",children:s.shipmentCode?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.shipmentCode}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>{s.shipmentCode&&window.open(`/shipping-eta?track=${encodeURIComponent(s.shipmentCode)}`,"_blank")},className:"h-6 w-6 p-0 border-gray-300 text-gray-700 hover:bg-blue-50 hover:border-blue-300 hover:text-blue-700",title:"Track Shipment",children:e.jsx(be,{className:"h-3 w-3"})})]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"No code"})}),e.jsx(w,{children:new Date(s.order_date).toLocaleDateString()}),e.jsx(w,{className:"text-right",children:e.jsx(Je,{variant:"dots",options:[{value:"edit",label:"Edit",icon:e.jsx($e,{className:"h-4 w-4"})},{value:"move_car",label:"Move Car",icon:e.jsx(Se,{className:"h-4 w-4"})}],onAction:V=>{V==="edit"?y(s):V==="move_car"&&R(s)},id:`ordered-car-actions-${s.id}`,ariaLabel:`Actions for ${s.model} ${s.vin_number}`})})]},s.id)):e.jsx(X,{children:e.jsx(w,{colSpan:10,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(oe,{className:"h-8 w-8 text-gray-400"}),e.jsx("p",{className:"font-medium text-gray-600",children:"No ordered cars found"}),e.jsx("p",{className:"text-sm text-gray-500",children:h?"No results match your search criteria.":"Start by adding your first car order."})]})})})})]})})})]}),e.jsx(Ge,{isOpen:o,onClose:()=>j(!1),onAddOrder:M}),e.jsx(Ke,{isOpen:l,onClose:()=>i(!1),onSave:s=>{s.forEach(V=>{M(V)}),C({title:"Bulk Upload Complete",description:`Successfully added ${s.length} cars to ordered cars.`})}}),e.jsx(ee,{open:L,onOpenChange:N,children:e.jsxs(se,{className:"sm:max-w-[600px]",children:[e.jsxs(ae,{children:[e.jsx(re,{children:"Edit Ordered Car"}),e.jsx(_e,{children:"Update the details of the ordered car."})]}),a&&e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-model",className:"text-right",children:"Model"}),e.jsx(x,{id:"edit-model",defaultValue:a.model,className:"col-span-3",onChange:s=>n({...a,model:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-vin",className:"text-right",children:"VIN"}),e.jsx(x,{id:"edit-vin",defaultValue:a.vin_number,className:"col-span-3",onChange:s=>n({...a,vin_number:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-color",className:"text-right",children:"Color"}),e.jsx(x,{id:"edit-color",defaultValue:a.color,className:"col-span-3",onChange:s=>n({...a,color:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-supplier",className:"text-right",children:"Supplier"}),e.jsx(x,{id:"edit-supplier",defaultValue:a.supplier,className:"col-span-3",onChange:s=>n({...a,supplier:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-shipping",className:"text-right",children:"Shipping Company"}),e.jsx(x,{id:"edit-shipping",defaultValue:a.shipping_company,className:"col-span-3",onChange:s=>n({...a,shipping_company:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-tracking",className:"text-right",children:"Tracking Number"}),e.jsx(x,{id:"edit-tracking",defaultValue:a.tracking_number||"",className:"col-span-3",onChange:s=>n({...a,tracking_number:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(S,{htmlFor:"edit-notes",className:"text-right",children:"Notes"}),e.jsx(x,{id:"edit-notes",defaultValue:a.notes||"",className:"col-span-3",onChange:s=>n({...a,notes:s.target.value})})]})]}),e.jsxs(te,{children:[e.jsx(v,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx(v,{onClick:()=>U(a||{}),children:"Save Changes"})]})]})}),e.jsx(Xe,{isOpen:O,onClose:()=>{u(!1),I(null)},car:d,onMoveCar:H})]})};export{es as default};
