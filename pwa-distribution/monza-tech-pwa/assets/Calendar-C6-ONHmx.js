import{r as N,c2 as M,aR as V,aZ as $,j as e,D as z,a as I,b as R,c as q,w as y,a2 as H,aS as U,aT as h,aU as u,aV as f,aW as E,I as S,aX as p,c3 as Y,a5 as _,a6 as B,a7 as O,a8 as W,a9 as K,a3 as L,bF as X,ac as Z,h as j,a_ as G,bT as d,t as k,a$ as g,c4 as J,c5 as Q,b3 as ee,aq as se,C as D,B as T}from"./index-D4jk50_k.js";import{C as te}from"./calendar-CMLNzEUz.js";import"./endOfMonth-_MCsYroE.js";import"./subDays-Qjc_kWLc.js";import"./addDays-8Uov6Dzg.js";import"./chevron-left-CyNbDIRH.js";const F=[{id:"khalil",name:"Khalil"},{id:"mark",name:"Mark"},{id:"tamara",name:"Tamara"},{id:"ahmad",name:"Ahmad"},{id:"sara",name:"Sara"},{id:"omar",name:"Omar"}],ae=[{value:"meeting",label:"Customer Meeting"},{value:"repair",label:"Car Repair"},{value:"test_drive",label:"Test Drive"},{value:"maintenance",label:"Maintenance"},{value:"delivery",label:"Car Delivery"}],le=G({title:g().min(2,"Event title is required"),date:Q({required_error:"Please select a date"}),time:g().min(1,"Please select a time"),type:g().min(1,"Please select an event type"),employees:J(g()).min(1,"Please select at least one employee"),carCode:g().optional()}),ne=({open:n,onOpenChange:i,onEventAdded:m})=>{const[x,b]=N.useState([]),{addNotification:v}=M(),r=V({resolver:$(le),defaultValues:{title:"",time:"",type:"",employees:[],carCode:""}}),P=s=>{const l={id:Date.now().toString(),title:s.title,date:new Date(s.date.getFullYear(),s.date.getMonth(),s.date.getDate(),parseInt(s.time.split(":")[0]),parseInt(s.time.split(":")[1])),assignedTo:s.employees.join(", "),carCode:s.carCode,status:"scheduled",type:s.type,employees:s.employees};m(l),s.employees.forEach(o=>{const c=F.find(C=>C.id===o);c&&v({title:"New Event Assignment",description:`You have been assigned to "${s.title}" on ${d(s.date,"PPP")} at ${s.time}`,link:"/calendar",assignedTo:c.name,eventId:l.id})}),k({title:"Event Created",description:`${s.title} has been scheduled for ${d(s.date,"PPP")} at ${s.time}. Notifications sent to assigned employees.`}),r.reset(),b([]),i(!1)},a=(s,l)=>{const o=l?[...x,s]:x.filter(c=>c!==s);b(o),r.setValue("employees",o)};return e.jsx(z,{open:n,onOpenChange:i,children:e.jsxs(I,{className:"sm:max-w-[500px]",children:[e.jsxs(R,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"Add New Event"]}),e.jsx(H,{children:"Schedule a new event and assign team members"})]}),e.jsx(U,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(P),className:"space-y-4",children:[e.jsx(h,{control:r.control,name:"title",render:({field:s})=>e.jsxs(u,{children:[e.jsx(f,{children:"Event Title"}),e.jsx(E,{children:e.jsx(S,{id:"eventTitle",placeholder:"Enter event title",...s})}),e.jsx(p,{})]})}),e.jsx(h,{control:r.control,name:"date",render:({field:s})=>e.jsxs(u,{children:[e.jsx(Y,{label:"Event Date & Time",value:s.value,onChange:s.onChange,required:!0,showTime:!0}),e.jsx(p,{})]})}),e.jsx(h,{control:r.control,name:"type",render:({field:s})=>e.jsxs(u,{children:[e.jsx(f,{children:"Event Type"}),e.jsxs(_,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(E,{children:e.jsx(B,{children:e.jsx(O,{placeholder:"Select event type"})})}),e.jsx(W,{children:ae.map(l=>e.jsx(K,{value:l.value,children:l.label},l.value))})]}),e.jsx(p,{})]})}),e.jsx(h,{control:r.control,name:"employees",render:()=>e.jsxs(u,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"Assign Employees"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto",children:F.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:s.id,checked:x.includes(s.id),onCheckedChange:l=>a(s.id,l)}),e.jsx("label",{htmlFor:s.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s.name})]},s.id))}),e.jsx(p,{})]})}),e.jsx(h,{control:r.control,name:"carCode",render:({field:s})=>e.jsxs(u,{children:[e.jsx(f,{children:"Car Code (Optional)"}),e.jsx(E,{children:e.jsx(S,{id:"eventReference",placeholder:"e.g., VF24-001",...s})}),e.jsx(p,{})]})}),e.jsxs(Z,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(j,{type:"submit",children:"Create Event"})]})]})})]})})},re=[{id:"1",title:"Customer Meeting - Ahmed",date:new Date(2025,4,21,10,0),assignedTo:"Khalil",status:"scheduled",type:"meeting"},{id:"2",title:"Voyah Free Repair",date:new Date(2025,4,20,13,30),assignedTo:"Mark",carCode:"VF24-001",status:"done",type:"repair"},{id:"3",title:"Test Drive - MHero 917",date:new Date(2025,4,22,15,0),assignedTo:"Tamara",carCode:"MH24-008",status:"scheduled",type:"test_drive"}],he=()=>{const[n,i]=N.useState(new Date),[m,x]=N.useState(re),[b,v]=N.useState(!1),r=new Date,a=m.filter(t=>t.date>r&&t.status==="scheduled").sort((t,w)=>t.date.getTime()-w.date.getTime())[0],s=n?m.filter(t=>t.date.getDate()===n.getDate()&&t.date.getMonth()===n.getMonth()&&t.date.getFullYear()===n.getFullYear()):[],l=m.filter(t=>t.status==="scheduled").map(t=>t.date),o=()=>{v(!0)},c=t=>{x(w=>[...w,t])},C=()=>{k({title:"Calendar Exported",description:"Calendar data exported to Excel successfully."})},A=()=>{a&&i(a.date)};return e.jsxs("div",{className:"container p-4 mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Team Calendar"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(j,{variant:"outline",onClick:C,className:"h-9 text-sm",children:[e.jsx(ee,{className:"mr-1 h-4 w-4"}),"Export"]}),e.jsxs(j,{variant:"default",onClick:o,className:"h-9 text-sm",children:[e.jsx(se,{className:"mr-1 h-4 w-4"}),"Add Event"]})]})]}),a&&e.jsx(D,{className:"p-4 mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:e.jsx(y,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"Next Upcoming Event"}),e.jsx("p",{className:"text-blue-700 font-medium",children:a.title}),e.jsxs("p",{className:"text-sm text-blue-600",children:[d(a.date,"PPPP")," at ",d(a.date,"h:mm a")]}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Assigned to: ",a.assignedTo]})]})]}),e.jsx(j,{variant:"outline",size:"sm",onClick:A,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:"View Details"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4",children:[e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"bg-white rounded-lg border border-monza-grey/10 shadow-sm p-2",children:[e.jsx(te,{mode:"single",selected:n,onSelect:i,className:"rounded-md mx-auto pointer-events-auto",modifiers:{hasEvent:l,nextEvent:a?[a.date]:[]},modifiersStyles:{hasEvent:{backgroundColor:"#fef3c7",color:"#92400e",fontWeight:"bold"},nextEvent:{backgroundColor:"#dbeafe",color:"#1e40af",fontWeight:"bold",border:"2px solid #3b82f6"}}}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:n?d(n,"PPPP"):"No date selected"}),e.jsxs("div",{className:"flex justify-center gap-4 mt-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-200 rounded border"}),e.jsx("span",{children:"Has Events"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-200 rounded border-2 border-blue-500"}),e.jsx("span",{children:"Next Event"})]})]})]})]})}),e.jsx(D,{className:"p-3 lg:col-span-8 shadow-sm rounded-lg border border-monza-grey/10",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h2",{className:"text-lg font-semibold border-b pb-2 border-monza-grey/10",children:["Events for ",n?d(n,"PPPP"):"Selected Date"]}),s.length>0?e.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[500px] pr-1",children:s.map(t=>e.jsx(D,{className:`p-2 shadow-sm border-l-4 rounded-md ${t.status==="done"?"border-l-green-500":t.status==="canceled"?"border-l-red-500":"border-l-monza-yellow"} ${t.id===(a==null?void 0:a.id)?"ring-2 ring-blue-300 bg-blue-50":""}`,children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-medium text-sm flex items-center gap-2",children:[t.title,t.id===(a==null?void 0:a.id)&&e.jsx(T,{variant:"outline",className:"text-xs bg-blue-100 text-blue-700 border-blue-300",children:"Next Event"})]}),e.jsx(T,{className:`text-xs font-normal px-1.5 py-0.5 ${t.status==="done"?"bg-green-100 text-green-800 hover:bg-green-200":t.status==="canceled"?"bg-red-100 text-red-800 hover:bg-red-200":"bg-monza-yellow/20 text-monza-black hover:bg-monza-yellow/30"}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 text-xs",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"h-3 w-3 text-muted-foreground mr-1"}),e.jsx("span",{children:d(t.date,"h:mm a")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-muted-foreground mr-1",children:"Assigned:"}),e.jsx("span",{className:"font-medium",children:t.assignedTo})]}),t.carCode&&e.jsx("div",{className:"flex items-center justify-start sm:justify-end",children:e.jsx(T,{variant:"outline",className:"font-normal text-xs h-5",children:t.carCode})})]})]})},t.id))}):e.jsx("div",{className:"flex items-center justify-center py-10 text-muted-foreground bg-gray-50 rounded-md",children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"mx-auto h-6 w-6 text-muted-foreground/60 mb-1"}),e.jsx("p",{className:"text-sm",children:"No events scheduled for this date."})]})})]})})]}),e.jsx(ne,{open:b,onOpenChange:v,onEventAdded:c})]})};export{he as default};
