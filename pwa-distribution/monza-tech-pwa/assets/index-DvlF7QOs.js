import{R as xe,$ as me,r as c,j as e,b1 as he,a3 as F,a as I,b3 as q,b as m,c as h,d as u,b0 as ue,ag as A,f as j,I as je,B as T,Y as ve,Z as pe,_ as E,c2 as X,af as R,a4 as Ne,aA as k,C as H,ad as M,ae as U,az as Z,p as K,g as Q,h as ee,i as W,k as N,l as se,m as f,D as fe,q as ge,v as we,w as be,a2 as ye,cM as te,t as Ae,bY as Te,cN as Ce}from"./index-BKWZsjPE.js";import{u as De}from"./useAuditLog-C5GYwDON.js";import{G as Se}from"./globe-D4FyM4hd.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=xe("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),Me=()=>{const{user:n}=me(),{auditLogs:d}=De(),[ie,ae]=c.useState("overview"),[v,V]=c.useState(""),[_,re]=c.useState(null),[p,z]=c.useState("all"),[D,Y]=c.useState("all"),[S,$]=c.useState("all"),[ce,J]=c.useState(!1),[l,le]=c.useState(null),[C,Re]=c.useState([]),[Ue,Oe]=c.useState(!0);c.useMemo(()=>C.length?{total:C.length,today:0,thisWeek:0}:{total:0,today:0,thisWeek:0},[C]),c.useMemo(()=>C||[],[C]),c.useMemo(()=>[],[C]);const g=c.useMemo(()=>{if((n==null?void 0:n.role)!=="owner"&&(n==null?void 0:n.role)!=="garage_manager")return[];const s=new Map;return d.forEach(t=>{var L,r;s.has(t.userId)||s.set(t.userId,{userId:t.userId,userName:t.userName,userRole:t.userRole,totalActivities:0,todayActivities:0,weekActivities:0,monthActivities:0,lastActivity:t.timestamp,firstActivity:t.timestamp,mostActiveSection:"",mostCommonAction:"",deviceTypes:{},browsers:{},errorCount:0,successRate:100,recentActivities:[]});const i=s.get(t.userId);i.totalActivities++;const a=new Date(t.timestamp),x=new Date,w=new Date(x.getFullYear(),x.getMonth(),x.getDate()),o=new Date(x.getTime()-7*24*60*60*1e3),y=new Date(x.getTime()-30*24*60*60*1e3);a>=w&&i.todayActivities++,a>=o&&i.weekActivities++,a>=y&&i.monthActivities++,new Date(t.timestamp)>new Date(i.lastActivity)&&(i.lastActivity=t.timestamp),new Date(t.timestamp)<new Date(i.firstActivity)&&(i.firstActivity=t.timestamp),(L=t.metadata)!=null&&L.deviceType&&(i.deviceTypes[t.metadata.deviceType]=(i.deviceTypes[t.metadata.deviceType]||0)+1),(r=t.metadata)!=null&&r.browserName&&(i.browsers[t.metadata.browserName]=(i.browsers[t.metadata.browserName]||0)+1)}),s.forEach((t,i)=>{var y,L;const a=d.filter(r=>r.userId===i),x=a.reduce((r,b)=>(r[b.section]=(r[b.section]||0)+1,r),{});t.mostActiveSection=((y=Object.entries(x).sort(([,r],[,b])=>b-r)[0])==null?void 0:y[0])||"None";const w=a.reduce((r,b)=>(r[b.action]=(r[b.action]||0)+1,r),{});t.mostCommonAction=((L=Object.entries(w).sort(([,r],[,b])=>b-r)[0])==null?void 0:L[0])||"None",t.recentActivities=a.slice(0,20);const o=a.filter(r=>r.details.toLowerCase().includes("error")||r.details.toLowerCase().includes("failed")||r.action==="DELETE").length;t.errorCount=o,t.successRate=t.totalActivities>0?Math.round((t.totalActivities-o)/t.totalActivities*100):100}),Array.from(s.values()).sort((t,i)=>new Date(i.lastActivity).getTime()-new Date(t.lastActivity).getTime())},[d,n]);if((n==null?void 0:n.role)!=="owner"&&(n==null?void 0:n.role)!=="garage_manager")return e.jsx(he,{to:"/dashboard",replace:!0});const ne=c.useMemo(()=>g.filter(s=>{const t=!v||s.userName.toLowerCase().includes(v.toLowerCase())||s.userRole.toLowerCase().includes(v.toLowerCase())||s.userId.toLowerCase().includes(v.toLowerCase()),i=p==="all"||p==="today"&&s.todayActivities>0||p==="week"&&s.weekActivities>0||p==="month"&&s.monthActivities>0;return t&&i}),[g,v,p]),G=c.useMemo(()=>d.filter(s=>{var i,a,x,w,o;if(!v)return!0;const t=v.toLowerCase();return s.userName.toLowerCase().includes(t)||s.details.toLowerCase().includes(t)||((i=s.entityName)==null?void 0:i.toLowerCase().includes(t))||((a=s.vinNumber)==null?void 0:a.toLowerCase().includes(t))||((x=s.partNumber)==null?void 0:x.toLowerCase().includes(t))||((w=s.carModel)==null?void 0:w.toLowerCase().includes(t))||((o=s.carBrand)==null?void 0:o.toLowerCase().includes(t))||s.section.toLowerCase().includes(t)||s.action.toLowerCase().includes(t)||s.entityType.toLowerCase().includes(t)}).filter(s=>{if(D!=="all"&&s.section!==D||S!=="all"&&s.action!==S||_&&s.userId!==_)return!1;if(p!=="all"){const t=new Date(s.timestamp),i=new Date;switch(p){case"today":return t.toDateString()===i.toDateString();case"week":return t>=new Date(i.getTime()-7*24*60*60*1e3);case"month":return t>=new Date(i.getTime()-30*24*60*60*1e3)}}return!0}),[d,v,D,S,_,p]),de=s=>{const t=g.find(i=>i.userId===s);t&&(le(t),J(!0))},oe=s=>{const t=g.find(y=>y.userId===s);if(!t)return;const i=d.filter(y=>y.userId===s),a={summary:t,activities:i},x=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),w=URL.createObjectURL(x),o=document.createElement("a");o.href=w,o.download=`user-activity-${t.userName}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(w),Ae({title:"Export Complete",description:`Activity data for ${t.userName} has been exported.`})},P=s=>{switch(s){case"mobile":return e.jsx(Ce,{className:"h-4 w-4"});case"tablet":return e.jsx(Le,{className:"h-4 w-4"});default:return e.jsx(Te,{className:"h-4 w-4"})}},B=s=>{switch(s){case"CREATE":return e.jsx(H,{className:"h-4 w-4 text-green-600"});case"UPDATE":return e.jsx(R,{className:"h-4 w-4 text-blue-600"});case"DELETE":return e.jsx(te,{className:"h-4 w-4 text-red-600"});case"VIEW":return e.jsx(Z,{className:"h-4 w-4 text-gray-600"});case"LOGIN":return e.jsx(H,{className:"h-4 w-4 text-green-600"});case"LOGOUT":return e.jsx(te,{className:"h-4 w-4 text-orange-600"});default:return e.jsx(R,{className:"h-4 w-4 text-gray-600"})}},O=s=>({INVENTORY:"bg-blue-100 text-blue-800",SHOWROOM_1:"bg-green-100 text-green-800",SHOWROOM_2:"bg-purple-100 text-purple-800",GARAGE:"bg-orange-100 text-orange-800",FINANCIAL:"bg-yellow-100 text-yellow-800",REPAIRS:"bg-red-100 text-red-800",PDI:"bg-indigo-100 text-indigo-800",USERS:"bg-gray-100 text-gray-800"})[s]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"User Activity Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor employee activities, track usage patterns, and review individual user histories"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(I,{variant:"outline",onClick:()=>{const s={summary:g,allActivities:d},t=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),i=URL.createObjectURL(t),a=document.createElement("a");a.href=i,a.download=`all-user-activities-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)},children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Export All Data"]})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Advanced Search & Filters"]}),e.jsx(A,{children:"Search across all activities, users, and data. Filter by time range, section, action, or specific user."})]}),e.jsxs(j,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(je,{id:"user-activity-search",placeholder:"Search users, activities, VINs, parts, details...",value:v,onChange:s=>V(s.target.value),className:"w-full"})}),e.jsxs("select",{id:"timeRange",value:p,onChange:s=>z(s.target.value),className:"h-10 w-full px-3 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 relative z-10",style:{appearance:"auto"},children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]}),e.jsxs("select",{id:"section",value:D,onChange:s=>Y(s.target.value),className:"h-10 w-full px-3 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 relative z-10",style:{appearance:"auto"},children:[e.jsx("option",{value:"all",children:"All Sections"}),e.jsx("option",{value:"INVENTORY",children:"Inventory"}),e.jsx("option",{value:"SHOWROOM_1",children:"Showroom 1"}),e.jsx("option",{value:"SHOWROOM_2",children:"Showroom 2"}),e.jsx("option",{value:"GARAGE",children:"Garage"}),e.jsx("option",{value:"FINANCIAL",children:"Financial"}),e.jsx("option",{value:"REPAIRS",children:"Repairs"}),e.jsx("option",{value:"PDI",children:"PDI"}),e.jsx("option",{value:"USERS",children:"Users"})]}),e.jsxs("select",{id:"action",value:S,onChange:s=>$(s.target.value),className:"h-10 w-full px-3 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 relative z-10",style:{appearance:"auto"},children:[e.jsx("option",{value:"all",children:"All Actions"}),e.jsx("option",{value:"CREATE",children:"Create"}),e.jsx("option",{value:"UPDATE",children:"Update"}),e.jsx("option",{value:"DELETE",children:"Delete"}),e.jsx("option",{value:"VIEW",children:"View"}),e.jsx("option",{value:"LOGIN",children:"Login"}),e.jsx("option",{value:"LOGOUT",children:"Logout"}),e.jsx("option",{value:"UPLOAD",children:"Upload"}),e.jsx("option",{value:"DOWNLOAD",children:"Download"})]})]}),(v||p!=="all"||D!=="all"||S!=="all")&&e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsxs(T,{variant:"outline",children:[G.length," results found"]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>{V(""),z("all"),Y("all"),$("all"),re(null)},children:"Clear Filters"})]})]})]}),e.jsxs(ve,{value:ie,onValueChange:ae,className:"space-y-4",children:[e.jsxs(pe,{className:"grid w-full grid-cols-4",children:[e.jsxs(E,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Overview"]}),e.jsxs(E,{value:"users",className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"User Profiles"]}),e.jsxs(E,{value:"activities",className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"All Activities"]}),e.jsxs(E,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Analytics"]})]}),e.jsxs(k,{value:"overview",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active in system"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Today's Activities"}),e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.reduce((s,t)=>s+t.todayActivities,0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all users"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Active Today"}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.filter(s=>s.todayActivities>0).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Users active today"})]})]}),e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Activities"}),e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time activities"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Most Active Users"}),e.jsx(A,{children:"Users with highest activity counts"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-4",children:g.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.userName}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.userRole})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold",children:s.totalActivities}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"activities"})]})]},s.userId))})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Recent Activities"}),e.jsx(A,{children:"Latest system activities"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-3",children:d.slice(0,8).map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-2 border rounded",children:[e.jsx("div",{className:"flex items-center gap-2",children:B(s.action)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:s.userName}),e.jsx(T,{className:O(s.section),variant:"outline",children:s.section.replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.details}),e.jsx("p",{className:"text-xs text-muted-foreground",children:U.formatDateTime(s.timestamp)})]})]},s.id))})})]})]})]}),e.jsx(k,{value:"users",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"User Activity Profiles"}),e.jsx(A,{children:"Click on any user to view their detailed activity history and analytics"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-4",children:ne.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>de(s.userId),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"h-6 w-6 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-lg",children:s.userName}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.userRole})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:t=>{t.stopPropagation(),oe(s.userId)},children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Export"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Z,{className:"h-4 w-4 mr-1"}),"View Details"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:s.totalActivities}),e.jsx("div",{className:"text-xs text-blue-600",children:"Total Activities"})]}),e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.todayActivities}),e.jsx("div",{className:"text-xs text-green-600",children:"Today"})]}),e.jsxs("div",{className:"text-center p-2 bg-purple-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:s.weekActivities}),e.jsx("div",{className:"text-xs text-purple-600",children:"This Week"})]}),e.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded",children:[e.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[s.successRate,"%"]}),e.jsx("div",{className:"text-xs text-orange-600",children:"Success Rate"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Most Active: ",s.mostActiveSection.replace("_"," ")]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:["Last: ",U.formatDateTime(s.lastActivity)]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:Object.entries(s.deviceTypes).map(([t,i])=>e.jsxs("div",{className:"flex items-center gap-1",children:[P(t),e.jsx("span",{className:"text-xs",children:i})]},t))})]})]},s.userId))})})]})}),e.jsx(k,{value:"activities",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"All Activities"}),e.jsxs(A,{children:["Complete activity log with advanced filtering (",G.length," activities shown)"]})]}),e.jsx(j,{children:e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Q,{children:[e.jsx(ee,{children:e.jsxs(W,{children:[e.jsx(N,{children:"Time"}),e.jsx(N,{children:"User"}),e.jsx(N,{children:"Action"}),e.jsx(N,{children:"Section"}),e.jsx(N,{children:"Details"}),e.jsx(N,{children:"Device"})]})}),e.jsx(se,{children:G.slice(0,100).map(s=>{var t,i;return e.jsxs(W,{children:[e.jsx(f,{className:"text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:U.formatDateTime(s.timestamp).split(" ")[1]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:U.formatDateTime(s.timestamp).split(" ")[0]})]})]})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-3 w-3 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:s.userName}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.userRole})]})]})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[B(s.action),e.jsx(T,{variant:"outline",children:s.action})]})}),e.jsx(f,{children:e.jsx(T,{className:O(s.section),variant:"outline",children:s.section.replace("_"," ")})}),e.jsxs(f,{className:"max-w-md",children:[e.jsx("p",{className:"text-sm truncate",children:s.details}),s.entityName&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.entityName})]}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[P(((t=s.metadata)==null?void 0:t.deviceType)||"desktop"),e.jsx("span",{className:"text-xs",children:((i=s.metadata)==null?void 0:i.browserName)||"Unknown"})]})})]},s.id)})})]})})})]})}),e.jsx(k,{value:"analytics",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Section Usage"}),e.jsx(A,{children:"Activity distribution across system sections"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-3",children:Object.entries(d.reduce((s,t)=>(s[t.section]=(s[t.section]||0)+1,s),{})).sort(([,s],[,t])=>t-s).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(T,{className:O(s),variant:"outline",children:s.replace("_"," ")})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:t}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[(t/d.length*100).toFixed(1),"%"]})]})]},s))})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Device & Browser Usage"}),e.jsx(A,{children:"User device and browser preferences"})]}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Device Types"}),e.jsx("div",{className:"space-y-2",children:Object.entries(d.reduce((s,t)=>{var a;const i=((a=t.metadata)==null?void 0:a.deviceType)||"desktop";return s[i]=(s[i]||0)+1,s},{})).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[P(s),e.jsx("span",{className:"capitalize",children:s})]}),e.jsx("span",{className:"font-medium",children:t})]},s))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Browsers"}),e.jsx("div",{className:"space-y-2",children:Object.entries(d.reduce((s,t)=>{var a;const i=((a=t.metadata)==null?void 0:a.browserName)||"Unknown";return s[i]=(s[i]||0)+1,s},{})).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),e.jsx("span",{children:s})]}),e.jsx("span",{className:"font-medium",children:t})]},s))})]})]})})]})]})})]}),e.jsx(fe,{open:ce,onOpenChange:J,children:e.jsxs(ge,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(we,{children:[e.jsxs(be,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),l==null?void 0:l.userName," - Detailed Activity History"]}),e.jsxs(ye,{children:["Complete activity history and analytics for ",l==null?void 0:l.userName," (",l==null?void 0:l.userRole,")"]})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.totalActivities}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Activities"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.todayActivities}),e.jsx("div",{className:"text-sm text-green-600",children:"Today"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:l.weekActivities}),e.jsx("div",{className:"text-sm text-purple-600",children:"This Week"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[l.successRate,"%"]}),e.jsx("div",{className:"text-sm text-orange-600",children:"Success Rate"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Recent Activities (Last 20)"}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(Q,{children:[e.jsx(ee,{children:e.jsxs(W,{children:[e.jsx(N,{children:"Time"}),e.jsx(N,{children:"Action"}),e.jsx(N,{children:"Section"}),e.jsx(N,{children:"Details"})]})}),e.jsx(se,{children:l.recentActivities.map(s=>e.jsxs(W,{children:[e.jsx(f,{className:"text-sm",children:U.formatDateTime(s.timestamp)}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[B(s.action),e.jsx(T,{variant:"outline",children:s.action})]})}),e.jsx(f,{children:e.jsx(T,{className:O(s.section),variant:"outline",children:s.section.replace("_"," ")})}),e.jsx(f,{className:"max-w-md",children:e.jsx("p",{className:"text-sm truncate",children:s.details})})]},s.id))})]})})]})]})]})})]})};export{Me as default};
