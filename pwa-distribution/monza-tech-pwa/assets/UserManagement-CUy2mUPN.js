import{$ as V,r as d,b2 as c,j as e,a3 as G,D as f,aQ as I,a as i,q as b,v as F,w as P,a2 as E,L as l,I as n,a5 as m,a6 as x,a7 as g,a8 as p,a9 as t,aa as U,b as z,c as $,d as q,ag as B,f as Q,av as J,aw as K,M as W}from"./index-BjC2zLSq.js";import{u as j}from"./userAPI-BN0X4miA.js";const Z=()=>{const{user:u}=V(),[S,R]=d.useState([]),[A,N]=d.useState(!0),[k,y]=d.useState(!1),[D,o]=d.useState(!1),[C,w]=d.useState(null),[a,r]=d.useState({name:"",email:"",password:"",role:"assistant",phoneNumber:"",department:"",emergencyContactName:"",emergencyContactPhone:"",address:"",notes:""});d.useEffect(()=>{h()},[]);const h=async()=>{try{N(!0);const s=await j.getAll();R(s)}catch(s){console.error("Failed to load users:",s),c.error("Failed to load users")}finally{N(!1)}},M=async()=>{try{await j.create(a),c.success("User created successfully"),y(!1),v(),h()}catch(s){console.error("Failed to create user:",s),c.error("Failed to create user")}},_=async()=>{if(C)try{await j.update(C.id,a),c.success("User updated successfully"),o(!1),v(),w(null),h()}catch(s){console.error("Failed to update user:",s),c.error("Failed to update user")}},O=async s=>{if(confirm("Are you sure you want to delete this user?"))try{await j.delete(s),c.success("User deleted successfully"),h()}catch(L){console.error("Failed to delete user:",L),c.error("Failed to delete user")}},v=()=>{r({name:"",email:"",password:"",role:"assistant",phoneNumber:"",department:"",emergencyContactName:"",emergencyContactPhone:"",address:"",notes:""})},H=s=>{w(s),r({name:s.name,email:s.email,password:"",role:s.role,hybridRole:s.hybridRole,phoneNumber:s.phoneNumber||"",department:s.department||"",emergencyContactName:s.emergencyContactName||"",emergencyContactPhone:s.emergencyContactPhone||"",address:s.address||"",notes:s.notes||""}),o(!0)};return(u==null?void 0:u.role)!=="owner"?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600",children:"Only owners can access user management."})]})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(G,{className:"h-6 w-6"}),"User Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage system users and their permissions"})]}),e.jsxs(f,{open:k,onOpenChange:y,children:[e.jsx(I,{asChild:!0,children:e.jsx(i,{onClick:v,children:"Add User"})}),e.jsxs(b,{className:"max-w-2xl",children:[e.jsxs(F,{children:[e.jsx(P,{children:"Create New User"}),e.jsx(E,{children:"Add a new user to the system with specific role and permissions."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(n,{id:"name",value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(n,{id:"email",type:"email",value:a.email,onChange:s=>r({...a,email:s.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"Password"}),e.jsx(n,{id:"password",type:"password",value:a.password,onChange:s=>r({...a,password:s.target.value}),placeholder:"Enter password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"role",children:"Role"}),e.jsxs(m,{value:a.role,onValueChange:s=>r({...a,role:s}),children:[e.jsx(x,{id:"role",children:e.jsx(g,{})}),e.jsxs(p,{children:[e.jsx(t,{value:"owner",children:"Owner"}),e.jsx(t,{value:"garage_manager",children:"Garage Manager"}),e.jsx(t,{value:"assistant",children:"Assistant"}),e.jsx(t,{value:"sales",children:"Sales"})]})]})]}),a.role==="sales"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"hybridRole",children:"Hybrid Role"}),e.jsxs(m,{value:a.hybridRole||"",onValueChange:s=>r({...a,hybridRole:s||void 0}),children:[e.jsx(x,{id:"hybridRole",children:e.jsx(g,{placeholder:"Select hybrid role"})}),e.jsxs(p,{children:[e.jsx(t,{value:"sales_garage_marketing",children:"Sales + Garage + Marketing"}),e.jsx(t,{value:"sales_assistant_marketing",children:"Sales + Assistant + Marketing"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone Number"}),e.jsx(n,{id:"phone",value:a.phoneNumber,onChange:s=>r({...a,phoneNumber:s.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"department",children:"Department"}),e.jsx(n,{id:"department",value:a.department,onChange:s=>r({...a,department:s.target.value}),placeholder:"Enter department"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"emergencyName",children:"Emergency Contact Name"}),e.jsx(n,{id:"emergencyName",value:a.emergencyContactName,onChange:s=>r({...a,emergencyContactName:s.target.value}),placeholder:"Emergency contact name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"emergencyPhone",children:"Emergency Contact Phone"}),e.jsx(n,{id:"emergencyPhone",value:a.emergencyContactPhone,onChange:s=>r({...a,emergencyContactPhone:s.target.value}),placeholder:"Emergency contact phone"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(l,{htmlFor:"address",children:"Address"}),e.jsx(n,{id:"address",value:a.address,onChange:s=>r({...a,address:s.target.value}),placeholder:"Enter address"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(l,{htmlFor:"notes",children:"Notes"}),e.jsx(U,{id:"notes",value:a.notes,onChange:s=>r({...a,notes:s.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(i,{onClick:M,children:"Create User"})]})]})]})]}),A?e.jsx("div",{className:"text-center",children:"Loading users..."}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:S.map(s=>e.jsxs(z,{className:"hover:shadow-md transition-shadow",children:[e.jsxs($,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:s.name.charAt(0)})}),s.name]}),e.jsxs(B,{className:"capitalize",children:[s.role," ",s.hybridRole&&`â€¢ ${s.hybridRole.replace(/_/g," ")}`]})]}),e.jsxs(Q,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(J,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.email})]}),s.phoneNumber&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(K,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.phoneNumber})]}),s.address&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:s.address})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-200 flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>H(s),children:"Edit"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>O(s.id),className:"text-red-600 hover:text-red-700",children:"Delete"})]})]})]},s.id))}),e.jsx(f,{open:D,onOpenChange:o,children:e.jsxs(b,{className:"max-w-2xl",children:[e.jsxs(F,{children:[e.jsx(P,{children:"Edit User"}),e.jsx(E,{children:"Update user information and permissions."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editName",children:"Name"}),e.jsx(n,{id:"editName",value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editEmail",children:"Email"}),e.jsx(n,{id:"editEmail",type:"email",value:a.email,onChange:s=>r({...a,email:s.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editPassword",children:"New Password (optional)"}),e.jsx(n,{id:"editPassword",type:"password",value:a.password,onChange:s=>r({...a,password:s.target.value}),placeholder:"Leave empty to keep current password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editRole",children:"Role"}),e.jsxs(m,{value:a.role,onValueChange:s=>r({...a,role:s}),children:[e.jsx(x,{id:"editRole",children:e.jsx(g,{})}),e.jsxs(p,{children:[e.jsx(t,{value:"owner",children:"Owner"}),e.jsx(t,{value:"garage_manager",children:"Garage Manager"}),e.jsx(t,{value:"assistant",children:"Assistant"}),e.jsx(t,{value:"sales",children:"Sales"})]})]})]}),a.role==="sales"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editHybridRole",children:"Hybrid Role"}),e.jsxs(m,{value:a.hybridRole||"",onValueChange:s=>r({...a,hybridRole:s||void 0}),children:[e.jsx(x,{id:"editHybridRole",children:e.jsx(g,{placeholder:"Select hybrid role"})}),e.jsxs(p,{children:[e.jsx(t,{value:"sales_garage_marketing",children:"Sales + Garage + Marketing"}),e.jsx(t,{value:"sales_assistant_marketing",children:"Sales + Assistant + Marketing"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editPhone",children:"Phone Number"}),e.jsx(n,{id:"editPhone",value:a.phoneNumber,onChange:s=>r({...a,phoneNumber:s.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editDepartment",children:"Department"}),e.jsx(n,{id:"editDepartment",value:a.department,onChange:s=>r({...a,department:s.target.value}),placeholder:"Enter department"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editEmergencyName",children:"Emergency Contact Name"}),e.jsx(n,{id:"editEmergencyName",value:a.emergencyContactName,onChange:s=>r({...a,emergencyContactName:s.target.value}),placeholder:"Emergency contact name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"editEmergencyPhone",children:"Emergency Contact Phone"}),e.jsx(n,{id:"editEmergencyPhone",value:a.emergencyContactPhone,onChange:s=>r({...a,emergencyContactPhone:s.target.value}),placeholder:"Emergency contact phone"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(l,{htmlFor:"editAddress",children:"Address"}),e.jsx(n,{id:"editAddress",value:a.address,onChange:s=>r({...a,address:s.target.value}),placeholder:"Enter address"})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(l,{htmlFor:"editNotes",children:"Notes"}),e.jsx(U,{id:"editNotes",value:a.notes,onChange:s=>r({...a,notes:s.target.value}),placeholder:"Additional notes...",rows:3})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(i,{onClick:_,children:"Update User"})]})]})})]})};export{Z as default};
