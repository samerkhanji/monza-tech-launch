import{j as t,D as ee,a as te,b as se,c as re,C as ae,d as oe,e as ne,f as ie,B as b,r as i,s as B,t as c,u as We,g as ve,A as Xe,h as H,Q as Ze,i as xe,X as fe,T as et,k as tt,l as st,m as ye,n as y,o as rt,p as w,W as at,q as ot,F as nt,v as it,M as lt,w as dt,P as ct,V as mt,L as T,I as O,E as ht,x as gt,y as ut,z as pt,G as vt,H as xt,J as ft,K as yt,N as wt,O as X}from"./index-D4jk50_k.js";const St=({isOpen:r,onClose:j,car:m})=>{var S,C;return m?t.jsx(ee,{open:r,onOpenChange:j,children:t.jsxs(te,{className:"max-w-4xl max-h-[90vh]",children:[t.jsx(se,{children:t.jsxs(re,{className:"flex items-center gap-2",children:["ğŸš— Car History - ",m.model," (",m.vinNumber,")"]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(ae,{children:[t.jsx(oe,{children:t.jsx(ne,{children:"Vehicle Information"})}),t.jsx(ie,{children:t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-600",children:"VIN:"}),t.jsx("p",{className:"font-mono",children:m.vinNumber||m.vin||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Model:"}),t.jsx("p",{children:m.model||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Brand:"}),t.jsx("p",{children:m.brand||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Year:"}),t.jsx("p",{children:m.year||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Color:"}),t.jsx("p",{children:m.color||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Status:"}),t.jsx(b,{className:"bg-blue-100 text-blue-800",children:m.status||"Unknown"})]})]})})]}),t.jsxs(ae,{children:[t.jsx(oe,{children:t.jsx(ne,{children:"Current Status"})}),t.jsx(ie,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Price:"}),t.jsxs("span",{className:"font-bold text-green-600",children:["$",((S=m.sellingPrice)==null?void 0:S.toLocaleString())||((C=m.price)==null?void 0:C.toLocaleString())||"N/A"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Battery:"}),t.jsxs("span",{children:[m.batteryPercentage||0,"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"font-medium text-gray-600",children:"Range:"}),t.jsxs("span",{children:[m.range||0," km"]})]})]})})]}),t.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-green-800",children:"âœ… SUCCESS!"}),t.jsx("p",{className:"text-green-600",children:"Car clicking is working correctly!"}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"This is a simplified version of the car history dialog. The full version with tabs will be available once this basic functionality is confirmed."})]})]})]})}):t.jsx(ee,{open:r,onOpenChange:j,children:t.jsxs(te,{className:"max-w-md",children:[t.jsx(se,{children:t.jsx(re,{children:"Car History"})}),t.jsx("div",{className:"p-4",children:t.jsx("p",{children:"No car data available"})})]})})},jt=()=>({connectedUsers:[],currentPageUsers:[],isConnected:!1,broadcastUpdate:async()=>{},updateUserStatus:async()=>{},subscribe:()=>()=>{}});function Dt(){const[r,j]=i.useState([]),[m,S]=i.useState(!0),[C,p]=i.useState(null),[U,F]=i.useState("cars"),{subscribe:D}=jt(),V=async()=>{try{S(!0),p(null);let{data:g,error:h}=await B.from("cars").select("*").order("created_at",{ascending:!1});if(h){const u=await B.from("car_inventory").select("*").order("created_at",{ascending:!1});if(u.error)throw h;F("car_inventory"),g=u.data}else F("cars");j(g||[])}catch(g){p(g instanceof Error?g.message:"Failed to fetch cars"),console.error("Error fetching cars:",g)}finally{S(!1)}},k=async g=>{try{const{data:h,error:u}=await B.from(U).insert([g]).select().single();if(u)throw u;return j(o=>[h,...o]),h}catch(h){return p(h instanceof Error?h.message:"Failed to add car"),console.error("Error adding car:",h),null}},q=async(g,h)=>{try{const{data:u,error:o}=await B.from(U).update({...h,updated_at:new Date().toISOString()}).eq("id",g).select().single();if(o)throw o;return j(n=>n.map(l=>l.id===g?u:l)),u}catch(u){return p(u instanceof Error?u.message:"Failed to update car"),console.error("Error updating car:",u),null}},L=async g=>{try{const{error:h}=await B.from(U).delete().eq("id",g);if(h)throw h;return j(u=>u.filter(o=>o.id!==g)),!0}catch(h){return p(h instanceof Error?h.message:"Failed to delete car"),console.error("Error deleting car:",h),!1}},z=async()=>{await V()};return i.useEffect(()=>{V()},[]),i.useEffect(()=>D(),[D]),{cars:r,loading:m,error:C,refetch:z,addCar:k,updateCar:q,deleteCar:L}}const Z=r=>({id:r.id,vinNumber:r.vin_number||r.vinNumber,model:r.model,brand:r.brand,year:r.year,color:r.color,interiorColor:r.interior_color||r.interiorColor,category:r.category,status:r.status,currentFloor:r.current_location||r.currentLocation||r.currentFloor,arrivalDate:r.arrival_date||r.arrivalDate||new Date().toISOString(),soldDate:r.sold_date||r.soldDate,reservedDate:r.reserved_date||r.reservedDate,sellingPrice:r.selling_price||r.sellingPrice,batteryPercentage:r.battery_percentage||r.batteryPercentage,pdiCompleted:r.pdi_completed||r.pdiCompleted,inShowroom:r.in_showroom||r.inShowroom,showroomNote:r.showroom_note||r.showroomNote,showroomEntryDate:r.showroom_entry_date||r.showroomEntryDate,showroomExitDate:r.showroom_exit_date||r.showroomExitDate,clientName:r.client_name||r.clientName,clientPhone:r.client_phone||r.clientPhone,clientLicensePlate:r.client_license_plate||r.clientLicensePlate,clientEmail:r.client_email||r.clientEmail,clientAddress:r.client_address||r.clientAddress,pdiTechnician:r.pdi_technician||r.pdiTechnician,pdiNotes:r.pdi_notes||r.pdiNotes,pdiPhotos:r.pdi_photos||r.pdiPhotos,pdiDate:r.pdi_date||r.pdiDate,notes:r.notes,lastUpdated:r.last_updated||r.lastUpdated||new Date().toISOString()}),Ct=()=>{const{cars:r,loading:j,error:m,addCar:S,updateCar:C,refetch:p}=Dt(),[U,F]=i.useState([]),[D,V]=i.useState(!1);return i.useEffect(()=>{if(!j&&!D){let o=[];if(r&&r.length>0)o=r.map(Z),console.log(`Car Inventory: Loaded ${o.length} cars from Supabase`);else try{const n=localStorage.getItem("carInventory"),l=localStorage.getItem("showroomFloor1Cars"),I=localStorage.getItem("showroomFloor2Cars"),J=localStorage.getItem("garageCars"),$=localStorage.getItem("inventoryFloor2Cars"),Q=[...n?JSON.parse(n):[],...l?JSON.parse(l):[],...I?JSON.parse(I):[],...J?JSON.parse(J):[],...$?JSON.parse($):[]];Q.length>0?(o=Q.map(Z),console.log(`Car Inventory: Loaded ${o.length} cars from localStorage fallback`)):console.log("Car Inventory: No data found in Supabase or localStorage")}catch(n){console.error("Error loading from localStorage:",n)}F(o),V(!0)}},[r,j,D]),i.useEffect(()=>{if(D&&r&&r.length>0){const o=r.map(Z);F(o)}},[r,D]),{cars:U,loading:j,error:m,handleStatusUpdate:async(o,n)=>{try{const l={status:n,soldDate:n==="sold"?new Date().toISOString():void 0,reservedDate:n==="reserved"?new Date().toISOString():void 0,lastUpdated:new Date().toISOString()};await C(o,l),c({title:"Status Updated",description:`Car status updated to ${n.replace("_"," ")}.`})}catch(l){console.error("Error updating car status:",l),c({title:"Update Failed",description:"Failed to update car status. Please try again.",variant:"destructive"})}},handleShowroomToggle:async(o,n,l)=>{try{const I={inShowroom:n,showroomNote:l,showroomEntryDate:n?new Date().toISOString():void 0,showroomExitDate:n?void 0:new Date().toISOString(),lastUpdated:new Date().toISOString()};await C(o,I),c({title:"Showroom Status Updated",description:`Car ${n?"added to":"removed from"} showroom.`})}catch(I){console.error("Error updating showroom status:",I),c({title:"Update Failed",description:"Failed to update showroom status. Please try again.",variant:"destructive"})}},handleClientInfoSave:async(o,n)=>{try{const l={...n,lastUpdated:new Date().toISOString()};await C(o,l),c({title:"Client Information Saved",description:"Client information has been updated successfully."})}catch(l){console.error("Error saving client info:",l),c({title:"Save Failed",description:"Failed to save client information. Please try again.",variant:"destructive"})}},handlePdiComplete:async(o,n)=>{try{const l={pdiCompleted:!0,pdiTechnician:n.technician,pdiNotes:n.notes,pdiPhotos:n.photos,pdiDate:new Date().toISOString(),lastUpdated:new Date().toISOString()};await C(o,l),c({title:"PDI Completed",description:`PDI completed successfully by ${n.technician}.`})}catch(l){console.error("Error completing PDI:",l),c({title:"PDI Update Failed",description:"Failed to complete PDI. Please try again.",variant:"destructive"})}},handleCarUpdate:async(o,n)=>{try{const l={...n,lastUpdated:new Date().toISOString()};await C(o,l),c({title:"Car Updated",description:"Car information has been updated successfully."})}catch(l){console.error("Error updating car:",l),c({title:"Update Failed",description:"Failed to update car information. Please try again.",variant:"destructive"})}},addCarQuick:async o=>{const n={vin_number:o.vinNumber,model:o.model,brand:o.brand,year:o.year,color:o.color,interior_color:o.interiorColor,category:o.category,status:o.status||"in_stock",arrival_date:o.arrivalDate||new Date().toISOString(),selling_price:o.sellingPrice??o.price,battery_percentage:o.batteryPercentage,pdi_completed:o.pdiCompleted,notes:o.notes};return Object.keys(n).forEach(l=>{n[l]===void 0&&delete n[l]}),await S(n)},loadCars:async()=>{try{await p()}catch(o){console.error("Error loading cars:",o),c({title:"Load Failed",description:"Failed to load car inventory. Please refresh the page.",variant:"destructive"})}}}},bt=()=>{const{cars:r,handleCarUpdate:j,addCarQuick:m}=Ct(),S=r.map(e=>{let s="in_stock";e.status==="sold"?s="sold":e.status==="reserved"?s="reserved":s="in_stock";const v=["EV","REV","ICEV"].includes(e.category)?e.category:"EV";return{id:e.id,vinNumber:e.vinNumber,model:e.model,year:e.year,color:e.color,interiorColor:e.interior_color||e.interiorColor||"",price:e.sellingPrice||0,status:s,category:v,batteryPercentage:e.batteryPercentage||100,range:e.range||520,features:e.features||[],arrivalDate:e.arrivalDate||new Date().toISOString(),pdiCompleted:e.pdiCompleted,pdiStatus:e.pdiCompleted?"completed":"pending",pdiTechnician:e.pdiTechnician,pdiDate:e.pdiDate,pdiNotes:e.pdiNotes,testDriveInfo:e.testDriveInfo,customs:e.customs==="paid"?"paid":"not paid",brand:e.brand,currentFloor:e.current_location||e.category,purchasePrice:e.purchase_price,clientName:e.client_name,clientPhone:e.client_phone,clientLicensePlate:e.client_license_plate,expectedDeliveryDate:e.expected_delivery_date,notes:e.notes,lastModified:e.updated_at,softwareVersion:Math.random()>.5?e.softwareVersion||"2.1.0":void 0,softwareLastUpdated:Math.random()>.5?e.softwareLastUpdated||"2024-01-15":void 0,softwareUpdateBy:Math.random()>.5?e.softwareUpdateBy||"IT Team":void 0,softwareUpdateNotes:Math.random()>.5?e.softwareUpdateNotes||"Routine update":void 0}}),[C]=We(),p=C.get("filter"),U=()=>{switch(p){case"ready":return S.filter(e=>e.status==="sold"||e.pdiStatus==="completed"||e.currentFloor==="showroom"||e.pdiCompleted===!0);case"attention":return S.filter(e=>{var s,a,v;return e.status==="reserved"||e.pdiStatus==="failed"||e.customs==="not paid"||e.softwareVersion===void 0||((s=e.notes)==null?void 0:s.toLowerCase().includes("issue"))||((a=e.notes)==null?void 0:a.toLowerCase().includes("problem"))||((v=e.notes)==null?void 0:v.toLowerCase().includes("repair"))});default:return S}},[F,D]=i.useState(!1),[V,k]=i.useState(!1),[q,L]=i.useState(!1),[z,g]=i.useState(!1),[h,u]=i.useState(!1),[o,n]=i.useState(!1),[l,I]=i.useState(!1),[J,$]=i.useState(!1),[Q,le]=i.useState(!1),[we,K]=i.useState(!1),[de,ce]=i.useState(null),[me,W]=i.useState(null),[d,x]=i.useState(null),[Se,he]=i.useState(!1),[_,ge]=i.useState(null),[je,ue]=i.useState(!1),[De,Ce]=i.useState(!1),[Ne,be]=i.useState(null),[Y,Ie]=i.useState(""),G=(()=>{const e=U();if(!Y.trim())return e;const s=Y.toLowerCase();return e.filter(a=>{var v,N,E,M,R;return a.vinNumber.toLowerCase().includes(s)||a.model.toLowerCase().includes(s)||a.color.toLowerCase().includes(s)||(((v=a.interiorColor)==null?void 0:v.toLowerCase().includes(s))??!1)||a.category.toLowerCase().includes(s)||a.status.toLowerCase().includes(s)||((N=a.brand)==null?void 0:N.toLowerCase().includes(s))||((E=a.clientName)==null?void 0:E.toLowerCase().includes(s))||((M=a.clientPhone)==null?void 0:M.toLowerCase().includes(s))||((R=a.notes)==null?void 0:R.toLowerCase().includes(s))||a.year.toString().includes(s)||a.price.toString().includes(s)})})(),[f,P]=i.useState({vinNumber:"",model:"Voyah Dream",year:2024,color:"",price:0,status:"available",category:"EV",batteryPercentage:100,range:520,pdiStatus:"pending",customs:"not paid",horsePower:350,torque:500,acceleration:"4.5",topSpeed:250,chargingTime:"30 minutes",warranty:"4 years / 80,000 km"}),Pe=async e=>{const s=S.some(a=>a.vinNumber===e);if(!s){const a={vinNumber:e,model:`Vehicle ${e.slice(-4)}`,year:new Date().getFullYear(),color:"Unknown",category:"EV",status:"in_stock",arrivalDate:new Date().toISOString(),batteryPercentage:100,range:0};await m(a)}D(!1),c({title:"VIN Scanned",description:`VIN ${e} ${s?"found":"added to inventory"}`})},_e=(e,s,a)=>{c({title:"Car Moved",description:`Car moved from ${s} to ${a}`})},Te=e=>{c({title:"Car Added",description:"Car has been added to inventory"})},Ee=async()=>{await m({vinNumber:f.vinNumber,model:f.model,year:f.year,color:f.color,category:f.category,status:"in_stock",arrivalDate:new Date().toISOString(),batteryPercentage:f.batteryPercentage,range:f.range,sellingPrice:f.price}),k(!1),P({vinNumber:"",model:"Voyah Dream",year:2024,color:"",price:0,status:"available",category:"EV",batteryPercentage:100,range:520,pdiStatus:"pending",customs:"not paid",horsePower:350,torque:500,acceleration:"4.5",topSpeed:250,chargingTime:"30 minutes",warranty:"4 years / 80,000 km"}),c({title:"Car Added",description:"Car has been added to inventory"})},A=(e,s)=>{const a={...s,sellingPrice:s.price,status:s.status==="available"?"in_stock":s.status,customs:s.customs==="paid"?"paid":"not_paid",softwareVersion:s.softwareVersion,softwareLastUpdated:s.softwareLastUpdated,softwareUpdateBy:s.softwareUpdateBy,softwareUpdateNotes:s.softwareUpdateNotes};j(e,a),L(!1),x(null),c({title:"Car Updated",description:"Car details have been updated"})},Ue=(e,s)=>{if(d){if(console.log(`Moving car ${d.id} to ${e} with notes: ${s}`),e==="garage-schedule"){const a={vinNumber:d.vinNumber,model:d.model,brand:d.brand,year:d.year,color:d.color,status:"waiting",priority:"normal",estimatedDuration:120,notes:s||"Moved from Car Inventory",clientName:d.clientName||"",clientPhone:d.clientPhone||"",arrivalTime:new Date().toISOString(),scheduledTime:new Date().toISOString()},v=localStorage.getItem("garageSchedule"),N=v?JSON.parse(v):{scheduledCars:[]},E={...a,id:Date.now().toString()};N.scheduledCars.push(E),localStorage.setItem("garageSchedule",JSON.stringify(N));const M={...d,id:`garage-${Date.now()}`,status:"in_stock",garageStatus:"stored",currentFloor:"Garage",repairStatus:"pending",assignedMechanic:"",estimatedCompletion:"",repairNotes:s||"Moved from Car Inventory",lastModified:new Date().toISOString()},R=localStorage.getItem("garageCars"),pe=R?JSON.parse(R):[];pe.push(M),localStorage.setItem("garageCars",JSON.stringify(pe)),c({title:"Car Added to Garage Schedule",description:`${d.model} has been added to the garage schedule and inventory for service/repair.`})}else c({title:"Car Moved",description:`${d.model} has been moved`});g(!1),x(null)}},Fe=e=>{W(e),K(!0)},ke=e=>{var s;console.log("ğŸš— Car clicked! Opening history for:",e.model,e.vinNumber),alert(`ğŸš— SUCCESS! You clicked on ${e.model} (VIN: ${e.vinNumber})

Car clicking is working!

Details:
- Model: ${e.model}
- Year: ${e.year}
- Status: ${e.status}
- Price: $${(s=e.price)==null?void 0:s.toLocaleString()}`)},Oe=e=>{x(e),I(!0)},Ve=e=>{const s=e.status==="reserved"||e.status==="sold",a=e.expectedDeliveryDate;s&&a&&!e.pdiCompleted||!e.pdiCompleted?(x(e),setTimeout(()=>$(!0),0)):Oe(e)},Le=e=>{u(!1),x(e),n(!0)},$e=e=>{he(e),n(!1),requestAnimationFrame(()=>{u(!0)})},Ae=(e,s)=>{A(e,{testDriveInfo:{...s,isOnTestDrive:!0}}),c({title:"Test Drive Scheduled",description:`${s.isClientTestDrive?"Client":"Employee"} test drive scheduled`}),u(!1),x(null)},Me=e=>{const s=S.find(M=>M.id===e);if(!s||!s.testDriveInfo)return;const a={isOnTestDrive:s.testDriveInfo.isOnTestDrive,testDriveStartTime:s.testDriveInfo.testDriveStartTime,testDriverName:s.testDriveInfo.testDriverName,testDriverPhone:s.testDriveInfo.testDriverPhone,testDriverLicense:s.testDriveInfo.testDriverLicense,notes:s.testDriveInfo.notes,purpose:s.testDriveInfo.purpose||"Test drive",isClientTestDrive:s.testDriveInfo.isClientTestDrive||!1,loggedBy:s.testDriveInfo.loggedBy||"System",loggedByName:s.testDriveInfo.loggedByName||"System User",loggedAt:s.testDriveInfo.loggedAt||new Date().toISOString(),emergencyContact:s.testDriveInfo.emergencyContact,emergencyContactPhone:s.testDriveInfo.emergencyContactPhone,vehicleVin:s.vinNumber,vehicleModel:s.model},v=X.endTestDrive(a),N=X.addToHistory(s,v);A(e,{testDriveInfo:void 0,testDriveHistory:N.testDriveHistory});const E=X.formatDuration(v.actualDuration||0);c({title:"Test Drive Completed",description:`Test drive completed in ${E}. Added to vehicle history.`})},Re=(e,s)=>{A(e,{pdiCompleted:!0,pdiTechnician:s.technician,pdiNotes:s.notes,pdiPhotos:s.photos,pdiDate:new Date().toISOString()}),c({title:"PDI Completed",description:"Pre-Delivery Inspection has been completed successfully."})},Be=e=>{ce(e),le(!0)},He=(e,s,a)=>{var N;A(e,{status:s,...a,lastUpdated:new Date().toISOString()});const v=(N=S.find(E=>E.id===e))==null?void 0:N.model;c({title:"Car Status Updated",description:`${v} status updated to ${s.replace("_"," ")}`})},qe=e=>{W(e),K(!0)},ze=(e,s)=>{j(e,s)},Je=e=>{ge(e),ue(!0)},Qe=(e,s)=>{j(e,{...s,lastUpdated:new Date().toISOString()}),c({title:"Software Updated",description:"Car software information has been updated"})},Ye=e=>{switch(e){case"available":case"in_stock":return"bg-green-100 text-green-800 border-green-200";case"sold":return"bg-blue-100 text-blue-800 border-blue-200";case"reserved":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Ge=e=>{switch(e){case"available":case"in_stock":return"Available";case"reserved":return"Reserved";case"sold":return"Sold";default:return e}},Ke=e=>{switch(e){case"EV":return"category-ev";case"REV":return"category-rev";case"ICEV":return"category-icev";default:return"bg-gray-400 text-white"}};return t.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Car Inventory"}),p&&t.jsxs(b,{variant:"outline",className:"text-sm font-medium",children:[p==="ready"&&t.jsxs(t.Fragment,{children:[t.jsx(ve,{className:"w-4 h-4 mr-1"}),"Ready Cars"]}),p==="attention"&&t.jsxs(t.Fragment,{children:[t.jsx(Xe,{className:"w-4 h-4 mr-1"}),"Need Attention"]})]})]}),t.jsxs("p",{className:"text-gray-600 mt-1",children:[p==="ready"&&"Cars ready for delivery and completed processing",p==="attention"&&"Cars requiring immediate attention or action",!p&&"Manage your car inventory and track vehicle details"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(H,{onClick:()=>D(!0),variant:"outline",className:"flex items-center gap-2 border-green-200 text-green-700 hover:bg-green-50",children:[t.jsx(Ze,{className:"h-4 w-4"}),"VIN Scanner"]}),t.jsx(H,{onClick:()=>k(!0),className:"flex items-center gap-2 bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:"Add Car Manually"})]})]}),t.jsxs(ae,{children:[t.jsx(oe,{children:t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs(ne,{className:"flex items-center gap-2",children:[t.jsx(xe,{className:"h-5 w-5"}),p==="ready"&&`Ready Cars (${G.length})`,p==="attention"&&`Cars Needing Attention (${G.length})`,!p&&`Car Inventory (${G.length} ${Y?`of ${S.length}`:""})`]}),t.jsxs("div",{className:"flex items-center gap-2",children:[p&&t.jsxs(H,{variant:"outline",size:"sm",onClick:()=>window.location.href="/car-inventory",className:"text-xs",children:[t.jsx(fe,{className:"h-3 w-3 mr-1"}),"Clear Filter"]}),t.jsx(et,{id:"car-inventory-search",value:Y,onChange:Ie,placeholder:"Search VINs, models, clients, colors...",className:"w-full sm:w-auto"})]})]})}),t.jsx(ie,{children:t.jsx("div",{className:"rounded-md border",children:t.jsxs(tt,{children:[t.jsx(st,{children:t.jsxs(ye,{className:"bg-gray-50",children:[t.jsx(y,{className:"font-semibold",children:"VIN"}),t.jsx(y,{className:"font-semibold",children:"Model"}),t.jsx(y,{className:"font-semibold",children:"Category"}),t.jsx(y,{className:"font-semibold",children:"Year"}),t.jsx(y,{className:"font-semibold",children:"Color"}),t.jsx(y,{className:"font-semibold",children:"Color interior"}),t.jsx(y,{className:"font-semibold",children:"Price"}),t.jsx(y,{className:"font-semibold",children:"Status"}),t.jsx(y,{className:"font-semibold",children:"Warranty Life"}),t.jsx(y,{className:"font-semibold",children:"Battery"}),t.jsx(y,{className:"font-semibold",children:"Range Capacity"}),t.jsx(y,{className:"font-semibold",children:"Km Driven"}),t.jsx(y,{className:"font-semibold",children:"Test Drive"}),t.jsx(y,{className:"font-semibold",children:"PDI"}),t.jsx(y,{className:"font-semibold",children:"Customs"}),t.jsx(y,{className:"font-semibold",children:"Software Model"}),t.jsx(y,{className:"font-semibold",children:"Actions"})]})}),t.jsx(rt,{children:G.map(e=>{var s;return t.jsxs(ye,{className:"hover:bg-gray-50 cursor-pointer transition-all hover:bg-blue-50",onClick:()=>ke(e),title:"Click to view complete car history",children:[t.jsx(w,{className:"font-mono text-sm",children:e.vinNumber}),t.jsx(w,{className:"font-medium",children:e.model}),t.jsx(w,{children:t.jsx(b,{className:Ke(e.category),children:e.category})}),t.jsx(w,{children:e.year}),t.jsx(w,{children:e.color}),t.jsx(w,{children:e.interiorColor||e.color||"-"}),t.jsxs(w,{className:"font-medium",children:["$",e.price.toLocaleString()]}),t.jsx(w,{children:t.jsx(b,{className:`${Ye(e.status)} cursor-pointer hover:opacity-80 transition-all hover:scale-105 active:scale-95`,onClick:a=>{a.preventDefault(),a.stopPropagation(),Be(e)},title:"Click to change status",children:Ge(e.status)})}),t.jsx(w,{children:t.jsx(at,{warrantyStartDate:e.warrantyStartDate,warrantyEndDate:e.warrantyEndDate,warrantyMonthsRemaining:e.warrantyMonthsRemaining,warrantyDaysRemaining:e.warrantyDaysRemaining,warrantyStatus:e.warrantyStatus,compact:!0})}),t.jsx(w,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ot,{className:"h-4 w-4"}),e.batteryPercentage,"%"]})}),t.jsx(w,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(nt,{className:"h-4 w-4"}),e.range," km"]})}),t.jsx(w,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(lt,{className:"h-4 w-4"}),it.getKilometersDriven(e.id)," km"]})}),t.jsx(w,{children:(s=e.testDriveInfo)!=null&&s.isOnTestDrive?t.jsxs(b,{className:"bg-blue-100 text-blue-800 border-blue-200 cursor-pointer hover:opacity-80 transition-opacity",onClick:a=>{a.preventDefault(),a.stopPropagation(),Me(e.id)},title:"Click to end test drive",children:[t.jsx(dt,{className:"mr-1 h-3 w-3"}),e.testDriveInfo.isClientTestDrive?"Client":"Employee"," Test Drive"]}):e.status==="sold"||e.status==="reserved"?t.jsx(b,{variant:"outline",className:"bg-gray-50 text-gray-500",children:"Not Available"}):t.jsx(b,{variant:"outline",className:"bg-gray-50 text-gray-500 cursor-pointer hover:bg-blue-50 hover:text-blue-600 transition-colors",onClick:a=>{a.preventDefault(),a.stopPropagation(),Le(e)},title:"Click to schedule test drive",children:"Available"})}),t.jsx(w,{children:t.jsx("div",{className:"cursor-pointer",onClick:a=>{a.preventDefault(),a.stopPropagation(),Ve(e)},children:t.jsx(b,{variant:e.pdiCompleted?"default":"outline",className:`cursor-pointer hover:opacity-80 transition-opacity ${e.pdiCompleted?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:e.pdiCompleted?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-1 text-lg",children:"â˜º"})," Complete"]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-1 text-lg",children:"â˜¹"})," Pending"]})})})}),t.jsx(w,{children:t.jsx(b,{variant:e.customs==="paid"?"default":"destructive",className:"cursor-pointer hover:opacity-80 transition-opacity active:scale-95",onClick:a=>{a.preventDefault(),a.stopPropagation(),qe(e)},title:"Click to manage customs payment",children:e.customs==="paid"?t.jsxs(t.Fragment,{children:[t.jsx(ve,{className:"mr-1 h-4 w-4"})," paid"]}):t.jsxs(t.Fragment,{children:[t.jsx(fe,{className:"mr-1 h-4 w-4"})," ",e.customs||"not paid"]})})}),t.jsx(w,{children:t.jsx("div",{className:"flex items-center gap-1 text-xs cursor-pointer",onClick:()=>Je(e),title:"Click to manage software updates",children:e.softwareVersion?t.jsxs(t.Fragment,{children:[t.jsxs(b,{variant:"outline",className:"text-xs hover:bg-blue-50 transition-colors",children:["v",e.softwareVersion]}),e.softwareLastUpdated&&t.jsx("span",{className:"text-gray-500",children:new Date(e.softwareLastUpdated).toLocaleDateString()})]}):t.jsx(b,{variant:"secondary",className:"text-xs text-yellow-700 bg-yellow-100 hover:bg-yellow-200 transition-colors",children:"Update Needed"})})}),t.jsx(w,{children:t.jsx(ct,{options:[{value:"details",label:"View Details"},{value:"edit",label:"Edit Car"},{value:"move",label:"Move Car"}],onAction:a=>{a==="details"?Fe(e):a==="edit"?(x(e),L(!0)):a==="move"&&(x(e),g(!0))},id:`actions-${e.id}`,ariaLabel:`Actions for ${e.model} ${e.vinNumber}`})})]},e.id)})})]})})})]}),t.jsx(mt,{isOpen:F,onClose:()=>D(!1),onVinScanned:Pe,targetLocation:"Inventory",onCarMoved:_e,onCarAdded:Te,onTestDrive:(e,s)=>{const a={id:e.id,vinNumber:e.vin_number,model:e.model,year:e.year,color:e.color,price:e.selling_price,status:e.status,category:e.category,batteryPercentage:e.battery_percentage||100,range:e.range_km||0,features:[],arrivalDate:e.arrival_date,pdiCompleted:e.pdi_completed,pdiTechnician:e.pdi_technician,pdiDate:e.pdi_date,pdiNotes:e.notes,testDriveInfo:{isOnTestDrive:e.test_drive_status},customs:e.customs==="not_paid"?"not paid":e.customs==="paid"?"paid":void 0};x(a),he(s),n(!0),D(!1)},onPdiAction:e=>{const s={id:e.id,vinNumber:e.vin_number,model:e.model,year:e.year,color:e.color,price:e.selling_price,status:e.status,category:e.category,batteryPercentage:e.battery_percentage||100,range:e.range_km||0,features:[],arrivalDate:e.arrival_date,pdiCompleted:e.pdi_completed,pdiTechnician:e.pdi_technician,pdiDate:e.pdi_date,pdiNotes:e.notes,testDriveInfo:{isOnTestDrive:e.test_drive_status},customs:e.customs==="not_paid"?"not paid":e.customs==="paid"?"paid":"not paid"};x(s),I(!0),D(!1)}}),t.jsx(ee,{open:V,onOpenChange:k,children:t.jsxs(te,{className:"sm:max-w-[600px]",children:[t.jsx(se,{children:t.jsxs(re,{className:"flex items-center gap-2",children:[t.jsx(xe,{className:"h-5 w-5"}),"Add Car to Inventory"]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(T,{htmlFor:"vinNumber",children:"VIN Number *"}),t.jsx(O,{id:"vinNumber",value:f.vinNumber,onChange:e=>P(s=>({...s,vinNumber:e.target.value})),placeholder:"Enter VIN number",required:!0})]}),t.jsxs("div",{children:[t.jsx(T,{htmlFor:"model",children:"Model *"}),t.jsx(O,{id:"model",value:f.model,onChange:e=>P(s=>({...s,model:e.target.value})),placeholder:"Enter model name",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(T,{htmlFor:"year",children:"Year *"}),t.jsx(O,{id:"year",type:"number",min:"2020",max:"2030",value:f.year,onChange:e=>P(s=>({...s,year:parseInt(e.target.value)})),required:!0})]}),t.jsxs("div",{children:[t.jsx(T,{htmlFor:"color",children:"Color *"}),t.jsx(O,{id:"color",value:f.color,onChange:e=>P(s=>({...s,color:e.target.value})),placeholder:"e.g., Midnight Silver",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(T,{htmlFor:"category",children:"Category *"}),t.jsxs("select",{id:"category",value:f.category,onChange:e=>P(s=>({...s,category:e.target.value})),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",required:!0,children:[t.jsx("option",{value:"EV",children:"EV (Electric Vehicle)"}),t.jsx("option",{value:"REV",children:"REV (Range Extended Vehicle)"}),t.jsx("option",{value:"ICEV",children:"ICEV (Internal Combustion Engine)"})]})]}),t.jsxs("div",{children:[t.jsx(T,{htmlFor:"price",children:"Price (USD) *"}),t.jsx(O,{id:"price",type:"number",min:"0",value:f.price,onChange:e=>P(s=>({...s,price:parseInt(e.target.value)})),placeholder:"e.g., 85000",required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(T,{htmlFor:"status",children:"Status"}),t.jsxs("select",{id:"status",value:f.status,onChange:e=>P(s=>({...s,status:e.target.value})),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",children:[t.jsx("option",{value:"available",children:"Available"}),t.jsx("option",{value:"sold",children:"Sold"}),t.jsx("option",{value:"reserved",children:"Reserved"}),t.jsx("option",{value:"pending",children:"Pending"})]})]}),t.jsxs("div",{children:[t.jsx(T,{htmlFor:"batteryPercentage",children:"Battery %"}),t.jsx(O,{id:"batteryPercentage",type:"number",min:"0",max:"100",value:f.batteryPercentage,onChange:e=>P(s=>({...s,batteryPercentage:parseInt(e.target.value)}))})]})]}),t.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.jsxs("div",{children:[t.jsx(T,{htmlFor:"range",children:"Range (km)"}),t.jsx(O,{id:"range",type:"number",min:"0",value:f.range,onChange:e=>P(s=>({...s,range:parseInt(e.target.value)})),placeholder:"e.g., 520"})]})})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[t.jsx(H,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),t.jsx(H,{onClick:Ee,className:"bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:"Add Car"})]})]})}),d&&t.jsx(ht,{isOpen:q,onClose:()=>{L(!1),x(null)},car:d,onSave:A}),d&&t.jsx(gt,{isOpen:z,onClose:()=>{g(!1),x(null)},car:d,onMoveCar:Ue}),d&&t.jsx(ut,{isOpen:l,onClose:()=>{I(!1),x(null)},car:d,onPdiComplete:Re}),d&&t.jsx(pt,{isOpen:J,onClose:()=>{$(!1),x(null)},car:d,onSave:(e,s)=>{A(e,{pdiCompleted:s,pdiDate:new Date().toISOString()}),$(!1),x(null)}}),d&&t.jsx(vt,{isOpen:o,onClose:()=>{n(!1),x(null)},onSelectTestDriveType:$e,carModel:d.model,carVin:d.vinNumber}),d&&t.jsx(xt,{isOpen:h,onClose:()=>{u(!1),x(null)},car:{...d,currentFloor:d.currentFloor||"Inventory"},onScheduleTestDrive:Ae,isClientTestDrive:Se}),de&&t.jsx(ft,{isOpen:Q,onClose:()=>{le(!1),ce(null)},car:de,onStatusUpdate:He}),me&&t.jsx(yt,{isOpen:we,onClose:()=>{K(!1),W(null)},car:me,onCarUpdate:ze}),t.jsx(wt,{isOpen:je,onClose:()=>{ue(!1),ge(null)},car:_?{vinNumber:_.vinNumber,model:_.model,currentVersion:_.softwareVersion,lastUpdated:_.softwareLastUpdated,lastUpdatedBy:_.softwareUpdateBy,notes:_.softwareUpdateNotes,needsUpdate:!_.softwareVersion,priority:_.softwareVersion?"medium":"critical"}:null,onUpdateComplete:(e,s)=>{var v;const a=(v=S.find(N=>N.vinNumber===e))==null?void 0:v.id;a&&Qe(a,s)}}),t.jsx(St,{isOpen:De,onClose:()=>{Ce(!1),be(null)},car:Ne})]})};export{bt as default};
