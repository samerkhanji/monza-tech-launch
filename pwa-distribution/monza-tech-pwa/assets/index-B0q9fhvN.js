import{R as le,cI as ie,$ as ce,aH as ne,r as n,t as $,j as e,b1 as de,af as R,a as D,aO as oe,ad as xe,b3 as z,b as d,c as o,d as x,f as m,ae as A,Y as me,Z as he,_ as I,c2 as K,a4 as je,aA as O,ag as b,B as w,L as h,b0 as Z,I as f,a5 as L,a6 as k,a7 as V,a8 as M,a9 as a,g as ue,h as pe,i as _,k as g,l as Ne,m as N,p as ve,e as J,aG as Q,U as X,M as ge,aK as ye,az as be,bE as fe,aq as Ae}from"./index-CnqA2hW7.js";import{u as we}from"./useAuditLog-bHzgDI78.js";import{F as Te}from"./filter-4HRUuAFT.js";import{S as Ee}from"./scan-DEOHsTts.js";import{S as Se}from"./square-pen-BxxLPU8h.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=le("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),Ve=()=>{const{userId:j}=ie(),{user:t}=ce(),T=ne(),{getEmployeeAuditSummary:P,filterLogs:U,advancedSearch:G}=we(),[ee,se]=n.useState("overview"),[p,F]=n.useState(""),[u,H]=n.useState({}),[E,W]=n.useState("all"),[r,ae]=n.useState(null),[S,Re]=n.useState([]);n.useEffect(()=>{(t==null?void 0:t.role)==="owner"||(t==null||t.role)},[j,t]),n.useMemo(()=>S?S.filter(s=>{var c,i;return((c=s.action)==null?void 0:c.toLowerCase().includes(p.toLowerCase()))||((i=s.details)==null?void 0:i.toLowerCase().includes(p.toLowerCase()))}):[],[S,p]),n.useEffect(()=>{if(!((t==null?void 0:t.role)!=="owner"&&(t==null?void 0:t.role)!=="garage_manager")&&j){const s=P(j);ae(s),s||($({title:"Employee Not Found",description:"No audit data found for this employee.",variant:"destructive"}),T("/audit-log"))}},[j,P,T]);const C=n.useMemo(()=>{if(!r)return[];let s=r.recentActivities;p&&(s=G(p).filter(i=>i.userId===j)),s=U({...u,userId:j}).filter(i=>i.userId===j);const c=new Date;switch(E){case"today":s=s.filter(l=>new Date(l.timestamp).toDateString()===c.toDateString());break;case"week":const i=new Date(c.getTime()-7*24*60*60*1e3);s=s.filter(l=>new Date(l.timestamp)>=i);break;case"month":const y=new Date(c.getTime()-30*24*60*60*1e3);s=s.filter(l=>new Date(l.timestamp)>=y);break}return s},[r,p,u,E,j,G,U]);if((t==null?void 0:t.role)!=="owner"&&(t==null?void 0:t.role)!=="garage_manager")return e.jsx(de,{to:"/dashboard",replace:!0});const v=(s,c)=>{H(i=>({...i,[s]:c||void 0}))},te=()=>{H({}),F(""),W("all")},B=s=>{switch(s){case"CREATE":return e.jsx(Ae,{className:"h-4 w-4 text-green-600"});case"UPDATE":return e.jsx(Se,{className:"h-4 w-4 text-blue-600"});case"DELETE":return e.jsx(fe,{className:"h-4 w-4 text-red-600"});case"VIEW":return e.jsx(be,{className:"h-4 w-4 text-gray-600"});case"UPLOAD":return e.jsx(ye,{className:"h-4 w-4 text-purple-600"});case"DOWNLOAD":return e.jsx(z,{className:"h-4 w-4 text-indigo-600"});case"SCAN":return e.jsx(Ee,{className:"h-4 w-4 text-orange-600"});case"MOVE":return e.jsx(Ce,{className:"h-4 w-4 text-cyan-600"});case"SEARCH":return e.jsx(Z,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(R,{className:"h-4 w-4 text-gray-600"})}},Y=s=>{switch(s){case"CREATE":return"bg-green-100 text-green-800 border-green-300";case"UPDATE":return"bg-blue-100 text-blue-800 border-blue-300";case"DELETE":return"bg-red-100 text-red-800 border-red-300";case"VIEW":return"bg-gray-100 text-gray-800 border-gray-300";case"UPLOAD":return"bg-purple-100 text-purple-800 border-purple-300";case"DOWNLOAD":return"bg-indigo-100 text-indigo-800 border-indigo-300";case"SCAN":return"bg-orange-100 text-orange-800 border-orange-300";case"MOVE":return"bg-cyan-100 text-cyan-800 border-cyan-300";case"SEARCH":return"bg-yellow-100 text-yellow-800 border-yellow-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},q=s=>({INVENTORY:"bg-yellow-100 text-yellow-800 border-yellow-300",GARAGE_INVENTORY:"bg-yellow-200 text-yellow-900 border-yellow-400",FLOOR_2_INVENTORY:"bg-yellow-50 text-yellow-700 border-yellow-200",SHOWROOM_1:"bg-blue-100 text-blue-800 border-blue-300",SHOWROOM_2:"bg-green-100 text-green-800 border-green-300",GARAGE:"bg-orange-100 text-orange-800 border-orange-300",GARAGE_CAR_INVENTORY:"bg-orange-200 text-orange-900 border-orange-400",PDI:"bg-purple-100 text-purple-800 border-purple-300",FINANCIAL:"bg-emerald-100 text-emerald-800 border-emerald-300",REPAIRS:"bg-red-100 text-red-800 border-red-300",NEW_ARRIVALS:"bg-cyan-100 text-cyan-800 border-cyan-300"})[s]||"bg-gray-100 text-gray-800 border-gray-300",re=()=>{if(!r)return;const s=[["Timestamp","Action","Section","Entity Type","Details","VIN","Part Number","Car Model","Location"],...C.map(l=>[l.timestamp,l.action,l.section,l.entityType,l.details,l.vinNumber||"",l.partNumber||"",l.carModel||"",l.location||""])].map(l=>l.join(",")).join(`
`),c=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(c),y=document.createElement("a");y.href=i,y.download=`${r.userName}_audit_log_${new Date().toISOString().split("T")[0]}.csv`,y.click(),window.URL.revokeObjectURL(i),$({title:"Export Complete",description:`${r.userName}'s audit logs exported successfully.`})};return r?e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(D,{variant:"ghost",onClick:()=>T("/audit-log"),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Back to Audit Log"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:r.userName}),e.jsxs("p",{className:"text-muted-foreground",children:[r.userRole," • ",r.totalActivities," total activities"]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(D,{variant:"outline",onClick:re,children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Export Logs"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:"Total Activities"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.totalActivities}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time activities"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:"Today's Activities"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.todayActivities}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Activities today"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:"Most Active Section"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.mostActiveSection.replace("_"," ")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Primary work area"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm font-medium",children:"Last Activity"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:A.formatDateTime(r.lastActivity).split(" ")[1]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:A.formatDateTime(r.lastActivity).split(" ")[0]})]})]})]}),e.jsxs(me,{value:ee,onValueChange:se,className:"space-y-4",children:[e.jsxs(he,{className:"grid w-full grid-cols-3",children:[e.jsxs(I,{value:"overview",className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Overview"]}),e.jsxs(I,{value:"activities",className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4"}),"Activity Log"]}),e.jsxs(I,{value:"analytics",className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Analytics"]})]}),e.jsx(O,{value:"overview",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Activity Breakdown"}),e.jsx(b,{children:"Actions performed by this employee"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-3",children:r.activityBreakdown.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[B(s.action),e.jsx(w,{className:Y(s.action),children:s.action})]}),e.jsxs("div",{className:"text-sm font-medium",children:[s.count," times"]})]},s.action))})})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Section Activity"}),e.jsx(b,{children:"Areas where this employee is most active"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-3",children:r.sectionBreakdown.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{className:q(s.section),children:s.section.replace("_"," ")}),e.jsxs("div",{className:"text-sm font-medium",children:[s.count," activities"]})]},s.section))})})]})]})}),e.jsx(O,{value:"activities",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Activity Filters"}),e.jsx(b,{children:"Search and filter this employee's activities"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(h,{children:"Advanced Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-2 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(f,{placeholder:"Search VIN, part number, car model, details...",className:"pl-8",value:p,onChange:s=>F(s.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Section"}),e.jsxs(L,{value:u.section||"all",onValueChange:s=>v("section",s==="all"?"":s),children:[e.jsx(k,{children:e.jsx(V,{placeholder:"All Sections"})}),e.jsxs(M,{children:[e.jsx(a,{value:"all",children:"All Sections"}),e.jsx(a,{value:"INVENTORY",children:"Inventory"}),e.jsx(a,{value:"GARAGE_INVENTORY",children:"Garage Inventory"}),e.jsx(a,{value:"FLOOR_2_INVENTORY",children:"Floor 2 Inventory"}),e.jsx(a,{value:"GARAGE_CAR_INVENTORY",children:"Garage Car Inventory"}),e.jsx(a,{value:"SHOWROOM_1",children:"Showroom 1"}),e.jsx(a,{value:"SHOWROOM_2",children:"Showroom 2"}),e.jsx(a,{value:"GARAGE",children:"Garage"}),e.jsx(a,{value:"PDI",children:"PDI"}),e.jsx(a,{value:"FINANCIAL",children:"Financial"}),e.jsx(a,{value:"REPAIRS",children:"Repairs"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Action"}),e.jsxs(L,{value:u.action||"all",onValueChange:s=>v("action",s==="all"?"":s),children:[e.jsx(k,{children:e.jsx(V,{placeholder:"All Actions"})}),e.jsxs(M,{children:[e.jsx(a,{value:"all",children:"All Actions"}),e.jsx(a,{value:"CREATE",children:"Create"}),e.jsx(a,{value:"UPDATE",children:"Update"}),e.jsx(a,{value:"DELETE",children:"Delete"}),e.jsx(a,{value:"VIEW",children:"View"}),e.jsx(a,{value:"SCAN",children:"Scan"}),e.jsx(a,{value:"MOVE",children:"Move"}),e.jsx(a,{value:"SEARCH",children:"Search"}),e.jsx(a,{value:"UPLOAD",children:"Upload"}),e.jsx(a,{value:"DOWNLOAD",children:"Download"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Time Range"}),e.jsxs(L,{value:E,onValueChange:W,children:[e.jsx(k,{children:e.jsx(V,{})}),e.jsxs(M,{children:[e.jsx(a,{value:"today",children:"Today"}),e.jsx(a,{value:"week",children:"This Week"}),e.jsx(a,{value:"month",children:"This Month"}),e.jsx(a,{value:"all",children:"All Time"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:" "}),e.jsxs(D,{variant:"outline",onClick:te,className:"w-full",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),"Clear"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"VIN Number"}),e.jsx(f,{placeholder:"Search by VIN...",value:u.vinNumber||"",onChange:s=>v("vinNumber",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Part Number"}),e.jsx(f,{placeholder:"Search by part number...",value:u.partNumber||"",onChange:s=>v("partNumber",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Car Model"}),e.jsx(f,{placeholder:"Search by car model...",value:u.carModel||"",onChange:s=>v("carModel",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Location"}),e.jsx(f,{placeholder:"Search by location...",value:u.location||"",onChange:s=>v("location",s.target.value)})]})]}),e.jsx("div",{className:"border rounded-lg",children:e.jsxs(ue,{children:[e.jsx(pe,{children:e.jsxs(_,{children:[e.jsx(g,{children:"Time"}),e.jsx(g,{children:"Action"}),e.jsx(g,{children:"Section"}),e.jsx(g,{children:"Entity"}),e.jsx(g,{children:"Details"}),e.jsx(g,{children:"Additional Info"})]})}),e.jsx(Ne,{children:C.length>0?C.slice(0,100).map(s=>e.jsxs(_,{children:[e.jsx(N,{className:"text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{children:A.formatDateTime(s.timestamp).split(" ")[1]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:A.formatDateTime(s.timestamp).split(" ")[0]})]})]})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[B(s.action),e.jsx(w,{className:Y(s.action),children:s.action})]})}),e.jsx(N,{children:e.jsx(w,{className:q(s.section),children:s.section.replace("_"," ")})}),e.jsx(N,{children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[s.entityType==="CAR"&&e.jsx(J,{className:"h-3 w-3"}),s.entityType==="PART"&&e.jsx(Q,{className:"h-3 w-3"}),s.entityType==="VIN"&&e.jsx(X,{className:"h-3 w-3"}),e.jsx("span",{children:s.entityType})]}),s.entityName&&e.jsx("div",{className:"text-xs text-muted-foreground",children:s.entityName})]})}),e.jsxs(N,{className:"max-w-md",children:[e.jsx("p",{className:"text-sm",children:s.details}),s.changes&&s.changes.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[s.changes.length," field(s) changed"]})]}),e.jsx(N,{children:e.jsxs("div",{className:"text-xs space-y-1",children:[s.vinNumber&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),e.jsxs("span",{children:["VIN: ",s.vinNumber]})]}),s.partNumber&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),e.jsxs("span",{children:["Part: ",s.partNumber]})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{children:s.location})]}),s.carModel&&e.jsxs("div",{className:"text-muted-foreground",children:[s.carBrand," ",s.carModel]})]})})]},s.id)):e.jsx(_,{children:e.jsxs(N,{colSpan:6,className:"text-center py-8",children:[e.jsx(X,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"No activities found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your filters or search terms"})]})})})]})})]})]})}),e.jsx(O,{value:"analytics",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Activity Timeline"}),e.jsx(b,{children:"Activity patterns over time"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(K,{className:"h-12 w-12 mx-auto mb-2"}),e.jsx("p",{children:"Activity timeline visualization coming soon"})]})})})]}),e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Performance Metrics"}),e.jsx(b,{children:"Key performance indicators"})]}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Average Daily Activities"}),e.jsx("span",{className:"font-medium",children:(r.totalActivities/30).toFixed(1)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Most Active Day"}),e.jsx("span",{className:"font-medium",children:"Today"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Primary Device"}),e.jsx("span",{className:"font-medium",children:"Desktop"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Efficiency Score"}),e.jsx("span",{className:"font-medium text-green-600",children:"High"})]})]})})]})]})})]})]}):e.jsx("div",{className:"container mx-auto p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"h-16 w-16 text-gray-400 mx-auto mb-4 animate-spin"}),e.jsx("p",{className:"text-gray-500",children:"Loading employee audit data..."})]})})};export{Ve as default};
