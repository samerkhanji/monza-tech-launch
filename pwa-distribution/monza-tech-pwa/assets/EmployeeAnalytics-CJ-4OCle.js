import{j as e,b0 as A,I as M,a5 as R,a6 as N,a7 as T,a8 as y,a9 as x,C as v,k as z,l as P,m as g,n as h,o as D,p as m,r as d,h as C,b3 as F,t as S,$ as E,aH as k,b1 as I,aJ as L}from"./index-D4jk50_k.js";import{R as V,B,C as H,X as O,Y as b,T as K,L as Y,a as f}from"./BarChart-3-pIj2I-.js";const _=({searchTerm:a,onSearchChange:s,specializationFilter:n,onSpecializationChange:i,performanceFilter:o,onPerformanceChange:l,specializations:t})=>e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(A,{className:"absolute left-2 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(M,{placeholder:"Search mechanics...",className:"pl-8",value:a,onChange:r=>s(r.target.value)})]}),e.jsxs(R,{value:n,onValueChange:i,children:[e.jsx(N,{className:"w-48",children:e.jsx(T,{placeholder:"Filter by specialization"})}),e.jsxs(y,{children:[e.jsx(x,{value:"all",children:"All Specializations"}),t.map(r=>e.jsx(x,{value:r,children:r},r))]})]}),e.jsxs(R,{value:o,onValueChange:l,children:[e.jsx(N,{className:"w-48",children:e.jsx(T,{placeholder:"Filter by performance"})}),e.jsxs(y,{children:[e.jsx(x,{value:"all",children:"All Performance"}),e.jsx(x,{value:"high",children:"High (90%+)"}),e.jsx(x,{value:"medium",children:"Medium (80-89%)"}),e.jsx(x,{value:"low",children:"Low (<80%)"})]})]})]}),W=({data:a,period:s})=>{const n=a.map(i=>({name:i.name,"Completed Repairs":i.completedRepairs,"Average Repair Time (days)":i.avgRepairTime,"On-Time Rate (%)":i.onTimeRate}));return e.jsxs(v,{className:"p-4",children:[e.jsxs("h3",{className:"text-lg font-medium mb-4",children:["Repair Metrics by Mechanic - ",s]}),e.jsx("div",{className:"h-[400px] w-full",children:e.jsx(V,{width:"100%",height:"100%",children:e.jsxs(B,{data:n,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"name"}),e.jsx(b,{yAxisId:"left",orientation:"left",stroke:"#8884d8"}),e.jsx(b,{yAxisId:"right",orientation:"right",stroke:"#82ca9d"}),e.jsx(K,{}),e.jsx(Y,{}),e.jsx(f,{yAxisId:"left",dataKey:"Completed Repairs",fill:"#8884d8"}),e.jsx(f,{yAxisId:"left",dataKey:"Average Repair Time (days)",fill:"#82ca9d"}),e.jsx(f,{yAxisId:"right",dataKey:"On-Time Rate (%)",fill:"#ffc658"})]})})})]})},X=({data:a})=>e.jsxs(v,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Detailed Mechanic Performance"}),e.jsxs(z,{children:[e.jsx(P,{children:e.jsxs(g,{children:[e.jsx(h,{children:"Mechanic Name"}),e.jsx(h,{children:"Specialization"}),e.jsx(h,{children:"Completed Repairs"}),e.jsx(h,{children:"Avg. Repair Time"}),e.jsx(h,{children:"On-Time Rate"}),e.jsx(h,{children:"Most Repaired Car"})]})}),e.jsxs(D,{children:[a.map(s=>e.jsxs(g,{children:[e.jsx(m,{className:"font-medium",children:s.name}),e.jsx(m,{children:s.specialization}),e.jsx(m,{children:s.completedRepairs}),e.jsxs(m,{children:[s.avgRepairTime," days"]}),e.jsxs(m,{children:[s.onTimeRate,"%"]}),e.jsx(m,{children:s.mostRepairedCar})]},s.name)),a.length===0&&e.jsx(g,{children:e.jsx(m,{colSpan:6,className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No mechanics match your search criteria."})})})]})]})]}),q=({data:a})=>{var l;const s=a.reduce((t,r)=>t+r.completedRepairs,0),n=a.length>0?(a.reduce((t,r)=>t+r.avgRepairTime,0)/a.length).toFixed(1):0,i=a.length>0?Math.round(a.reduce((t,r)=>t+r.onTimeRate,0)/a.length):0,o=((l=a.sort((t,r)=>r.completedRepairs-t.completedRepairs)[0])==null?void 0:l.name)||"N/A";return e.jsxs(v,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Performance Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Repairs Completed"}),e.jsx("p",{className:"text-2xl font-bold",children:s})]}),e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Repair Time"}),e.jsxs("p",{className:"text-2xl font-bold",children:[n," days"]})]}),e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average On-Time Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[i,"%"]})]}),e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Performer"}),e.jsx("p",{className:"text-2xl font-bold",children:o})]})]})]})},G=a=>{const[s,n]=d.useState(""),[i,o]=d.useState("all"),[l,t]=d.useState("all"),r=d.useMemo(()=>[...new Set(a.map(c=>c.specialization))],[a]),j=d.useMemo(()=>a.filter(c=>{const u=c.name.toLowerCase().includes(s.toLowerCase()),w=i==="all"||c.specialization===i;let p=!0;return l==="high"?p=c.onTimeRate>=90:l==="medium"?p=c.onTimeRate>=80&&c.onTimeRate<90:l==="low"&&(p=c.onTimeRate<80),u&&w&&p}),[a,s,i,l]);return{searchTerm:s,setSearchTerm:n,specializationFilter:i,setSpecializationFilter:o,performanceFilter:l,setPerformanceFilter:t,specializations:r,filteredData:j}},J=({data:a,period:s})=>{const{searchTerm:n,setSearchTerm:i,specializationFilter:o,setSpecializationFilter:l,performanceFilter:t,setPerformanceFilter:r,specializations:j,filteredData:c}=G(a),u=()=>{S({title:"Excel Export",description:"Mechanic Performance report exported to Excel successfully."})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Mechanic Performance Analysis"}),e.jsxs(C,{variant:"outline",size:"sm",onClick:u,children:[e.jsx(F,{className:"mr-1"}),"Export"]})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx(W,{data:c,period:s}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{searchTerm:n,onSearchChange:i,specializationFilter:o,onSpecializationChange:l,performanceFilter:t,onPerformanceChange:r,specializations:j}),e.jsx(X,{data:c})]}),e.jsx(q,{data:c})]})]})},U=()=>{const{user:a}=E(),s=k(),[n,i]=d.useState("month"),[o,l]=d.useState([]);return d.useEffect(()=>{(a==null?void 0:a.role)==="owner"||(a==null||a.role)},[n,a]),d.useEffect(()=>{if((a==null?void 0:a.role)!=="owner"&&(a==null?void 0:a.role)!=="garage_manager")return;(()=>{l([{name:"Ali Hassan",completedRepairs:18,avgRepairTime:2.3,onTimeRate:92,specialization:"Engine",mostRepairedCar:"Voyah Free 2024"},{name:"Walid Nassar",completedRepairs:15,avgRepairTime:1.8,onTimeRate:96,specialization:"Electrical",mostRepairedCar:"Voyah Dream 2024"},{name:"Fadi Abboud",completedRepairs:22,avgRepairTime:2.7,onTimeRate:88,specialization:"Brakes",mostRepairedCar:"MHero 917 2024"},{name:"Tarek Karam",completedRepairs:12,avgRepairTime:3.1,onTimeRate:85,specialization:"Suspension",mostRepairedCar:"Voyah Courage 2025"}])})()},[a]),(a==null?void 0:a.role)!=="owner"&&(a==null?void 0:a.role)!=="garage_manager"?(S({title:"Access Denied",description:"Only owners and garage managers can access employee analytics.",variant:"destructive"}),e.jsx(I,{to:"/dashboard"})):e.jsxs("div",{className:"space-y-8 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Employee Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Track individual employee performance and productivity metrics"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(C,{variant:"outline",onClick:()=>s("/repairs"),className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"View Repairs"]}),e.jsxs("select",{className:"h-10 rounded-md border border-input bg-background px-3 py-2",value:n,onChange:t=>i(t.target.value),children:[e.jsx("option",{value:"week",children:"Last Week"}),e.jsx("option",{value:"month",children:"Last Month"}),e.jsx("option",{value:"quarter",children:"Last Quarter"}),e.jsx("option",{value:"year",children:"Last Year"})]})]})]}),e.jsx("div",{className:"space-y-8",children:e.jsx(J,{data:o,period:n})})]})};export{U as default};
