-- Final Complete Stock Data Upload for Monza TECH - All 117 Vehicles
-- This script adds all missing vehicles with complete warranty tracking
-- Matches the exact database schema: id, vin, model, brand, year, color, vehicle_type, status, current_floor, client_name, selling_price, delivery_date, vehicle_warranty_expiry, battery_warranty_expiry, dms_warranty_deadline, notes, created_at, updated_at

-- First, let's check what we currently have
SELECT 'Current database state:' as info;
SELECT COUNT(*) as total_records FROM public.car_inventory;
SELECT status, COUNT(*) as count_by_status FROM public.car_inventory GROUP BY status;

-- Create a temporary table with all vehicles we want to add
CREATE TEMP TABLE temp_vehicles_to_add AS
SELECT * FROM (VALUES
-- Additional Sold Vehicles (not in your current 40)
('LDP29H923SM520023', 'Mhero', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Ali Kobeissy', 50000.00, '2025-05-22', '2030-05-22', '2033-05-22', NULL, 'NOT ON DMS'),
('LDP91E968RE201874', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Mashreq Hospital', 50000.00, '2025-05-23', '2030-05-23', '2033-05-23', '2029-10-01', 'Sold'),
('LDP91E968RE201857', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Samir Haddad', 50000.00, '2025-05-23', '2030-05-23', '2033-05-23', '2029-10-01', 'Sold'),
('LDP95H967RE302345', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Ziad el Sayed', 50000.00, '2025-06-19', '2030-06-19', '2033-06-19', '2029-10-01', 'Sold'),
('LDP91E963RE201782', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'RAKAN ABDEL WAHAB', 50000.00, '2025-06-17', '2030-06-17', '2033-06-17', '2029-10-01', 'Sold'),
('LDP95C969SY890014', 'Courage', 'Voyah', 2025, 'WHITE', 'EV', 'sold', 'Delivered', 
 'Georges Hraoui', 50000.00, '2025-06-17', '2030-06-17', '2033-06-17', NULL, 'NOT ON DMS'),
('LDP95H964SE900267', 'Free', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Tarek Darwish', 50000.00, '2025-06-19', '2030-06-19', '2033-06-19', '2030-08-20', 'Sold'),
('LDP95H961SE900257', 'Free', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Ramzi Abdo Zidan', 50000.00, '2025-06-20', '2030-06-20', '2033-06-20', '2030-08-21', 'Sold'),
('LDP95H966SE900254', 'Free', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Fadi Jiji', 50000.00, '2025-06-24', '2030-06-24', '2033-06-24', '2030-08-21', 'Sold'),
('LDP95H961SE900260', 'Free', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Mhamad Kassem Saleh', 50000.00, '2025-06-27', '2030-06-27', '2033-06-27', '2030-08-21', 'Sold'),
('LDP91E966SE100256', 'Passion', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Hilal Saab', 50000.00, '2025-06-28', '2030-06-28', '2033-06-28', '2030-10-07', 'Sold'),
('LDP91E967RE201901', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Faysal Abdallah', 50000.00, '2025-06-27', '2030-06-27', '2033-06-27', '2029-10-01', 'Sold'),
('LDP95H963SE900275', 'Free', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Roni Abou Khalil', 50000.00, '2025-06-28', '2030-06-28', '2033-06-28', '2030-08-20', 'Sold'),
('LDP95H965RE301744', 'Free', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Delivered', 
 'kareem subra', 50000.00, '2025-07-11', '2030-07-11', '2033-07-11', '2029-10-01', 'Sold'),
('LDP95H962SE900249', 'Free', 'Voyah', 2025, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Nasser El Ek', 50000.00, '2025-07-14', '2030-07-14', '2033-07-14', '2030-08-21', 'Sold'),
('LDP95H965SE900262', 'Free', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Mrs. Suhair Khanji', 50000.00, '1907-12-30', '2030-12-30', '2033-12-30', '2030-08-21', 'Sold'),
('LDP95C961SY890010', 'Courage', 'Voyah', 2025, 'WHITE', 'REEV', 'sold', 'Delivered', 
 'Hanady Zorkout', 50000.00, '2025-07-11', '2030-07-11', '2033-07-11', NULL, 'NOT ON DMS'),
('LDP95C967SY890058', 'Courage', 'Voyah', 2025, 'GREY', 'EV', 'sold', 'Delivered', 
 'Samer Khanji', 50000.00, '2025-07-15', '2030-07-15', '2033-07-15', NULL, 'NOT ON DMS'),
('LDP95H965SE900259', 'Free', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Georges Hraoui', 50000.00, '2025-05-22', '2030-05-22', '2033-05-22', '2030-08-21', 'Sold'),
('LDP95H966SE900268', 'Free', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Jaafar Hamed', 50000.00, '2025-05-16', '2030-05-16', '2033-05-16', '2030-08-20', 'Sold'),
('LDP95C964SY890017', 'COURAGE', 'Voyah', 2025, 'WHITE', 'EV', 'sold', 'Delivered', 
 'Marianne Joseph Khalaf', 50000.00, '2025-07-16', '2030-07-16', '2033-07-16', NULL, 'NOT ON DMS'),
('LDP29H927SM520011', 'MHERO', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'MAKRAM BOU HABIB', 50000.00, '2025-05-06', '2030-05-06', '2033-05-06', NULL, 'NOT ON DMS'),
('LDP29H921SM520019', 'MHERO', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Rabih Mezher', 50000.00, '2025-05-13', '2030-05-13', '2033-05-13', NULL, 'NOT ON DMS'),
('LDP29H929SM520026', 'MHERO', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'HELMI HAREB', 50000.00, '2025-06-05', '2030-06-05', '2033-06-05', NULL, 'NOT ON DMS'),
('LDP29H920SM520030', 'MHERO', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'MAJED EID', 50000.00, '2025-04-09', '2030-04-09', '2033-04-09', NULL, 'NOT ON DMS'),
('LDP29H924SM520029', 'MHERO', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'HOUSSAM KHANJI', 50000.00, '2025-05-09', '2030-05-09', '2033-05-09', NULL, 'NOT ON DMS'),
('LDP29H923RM500333', 'MHERO', 'Voyah', 2024, 'FANJING GREEN', 'REEV', 'sold', 'Delivered', 
 'Wassim Kfoury', 50000.00, '2024-10-07', '2029-10-07', '2032-10-07', NULL, 'NOT ON DMS'),
('LDP29H925RM500334', 'MHERO', 'Voyah', 2024, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Abdel Karim Fanj', 50000.00, '2024-11-05', '2029-11-05', '2032-11-05', NULL, 'NOT ON DMS'),
('LDP29H925RM520003', 'MHERO', 'Voyah', 2024, 'FANJING GREEN', 'REEV', 'sold', 'Delivered', 
 'Antoine Hraoui', 50000.00, '2024-10-04', '2029-10-04', '2032-10-04', NULL, 'NOT ON DMS'),
('LDP29H927RM520004', 'MHERO', 'Voyah', 2024, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Fouad Halbawi', 50000.00, '2025-01-07', '2030-01-07', '2033-01-07', NULL, 'NOT ON DMS'),
('LDP95H960RE300811', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Rabih Abou Dargham', 50000.00, '2024-09-09', '2029-09-09', '2032-09-09', '2029-10-15', 'Sold'),
('LDP95H969PE309648', 'Free', 'Voyah', 2023, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'OMAR HACHWI', 50000.00, '2025-06-17', '2030-06-17', '2033-06-17', '2029-06-25', 'Sold'),
('LDP95C967PE900581', 'Free', 'Voyah', 2023, 'WHITE', 'REEV', 'sold', 'Delivered', 
 'ELHAM KORKOMAZ', 50000.00, '2025-05-05', '2030-05-05', '2033-05-05', NULL, 'NOT ON DMS'),
('LDP91C96XPE203420', 'Passion', 'Voyah', 2023, 'WHITE', 'EV', 'sold', 'Delivered', 
 'Elie Meouchi', 50000.00, '2025-02-13', '2030-02-13', '2033-02-13', '2029-06-12', 'Sold'),
('LDP95H963PE309631', 'Free', 'Voyah', 2023, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Nada Saab', 50000.00, '2024-06-21', '2029-06-21', '2032-06-21', NULL, 'NOT ON DMS'),
('LDP95H966RE301848', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'MOHAMAD SALAMEH / DANIA NASSER', 50000.00, '2025-03-05', '2030-03-05', '2033-03-05', '2029-09-07', 'Sold'),
('LDP95H96XRE302209', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Zareh Khederlarian', 50000.00, '2024-06-10', '2029-06-10', '2032-06-10', '2029-09-07', 'Sold'),
('LDP95H962RE300812', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Galina Anatoly Setsokfish', 50000.00, '2025-01-20', '2030-01-20', '2033-01-20', '2029-09-07', 'Sold'),
('LDP95H963RE300902', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'HSEIN HOTEIT', 50000.00, '2025-02-21', '2030-02-21', '2033-02-21', '2029-09-07', 'Sold'),
('LDP95H962RE301863', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'ADEL WAKIM / KITCHEN AVENUE', 50000.00, '2024-09-03', '2029-09-03', '2032-09-03', '2029-09-07', 'Sold'),
('LDP95H963RE301841', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'HICHAM NASSER', 50000.00, '2024-06-13', '2029-06-13', '2032-06-13', '2029-09-07', 'Sold'),
('LDP95H960RE301828', 'Free', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Delivered', 
 'SAMER SAAB', 50000.00, '2024-09-17', '2029-09-17', '2032-09-17', '2029-09-07', 'Sold'),
('LDP95H960RE302378', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'JOANNA KHANJI', 50000.00, '2024-07-10', '2029-07-10', '2032-07-10', '2029-10-07', 'Sold'),
('LDP95H961RE300963', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Fayez Imad Hamoudi', 50000.00, '2025-03-05', '2030-03-05', '2033-03-05', '2029-09-07', 'Sold'),
('LDP95H960RE301859', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Anthony Hajjar', 50000.00, '2025-01-09', '2030-01-09', '2033-01-09', '2029-09-07', 'Sold'),
('LDP95H962RE302348', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'KAREEM KHANJI', 50000.00, '2024-07-10', '2029-07-10', '2032-07-10', '2029-09-07', 'Sold'),
('LDP95H960RE300906', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'KAREEM GEBARA', 50000.00, '2025-04-11', '2030-04-11', '2033-04-11', '2029-09-07', 'Sold'),
('LDP95H969RE302377', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Hadi Halawani', 50000.00, '2025-01-07', '2030-01-07', '2033-01-07', '2029-09-07', 'Sold'),
('LDP95H962RE302351', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'DANY HERMEZ', 50000.00, '2025-02-07', '2030-02-07', '2033-02-07', '2029-10-01', 'Sold'),
('LDP95H965RE300366', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Tarek & Sara Kaadan', 50000.00, '2025-04-16', '2030-04-16', '2033-04-16', '2029-10-01', 'Sold'),
('LDP95H965RE300643', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'BASSAM MHASSEB', 50000.00, '2024-11-07', '2029-11-07', '2032-11-07', '2029-10-01', 'Sold'),
('LDP95H967RE300367', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'WAEL HOMSI', 50000.00, '2025-01-07', '2030-01-07', '2033-01-07', '2029-10-01', 'Sold'),
('LDP95H968RE300359', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'NASMA NIZAMEDDINE', 50000.00, NULL, NULL, NULL, '2029-10-01', 'Sold, need the selling date'),
('LDP95H968RE302337', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'ASSAAD ZOOROB', 50000.00, '2025-05-03', '2030-05-03', '2033-05-03', '2029-10-01', 'Sold'),
('LDP95H969RE301858', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'CHAHINE KORJIAN', 50000.00, '2025-01-24', '2030-01-24', '2033-01-24', '2029-10-01', 'Sold'),
('LDP95H961RE300915', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Mohamad Itani', 50000.00, '2025-01-31', '2030-01-31', '2033-01-31', '2029-10-01', 'Sold'),
('LDP95H96XRE300816', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'SAMER ALI HASSAN', 50000.00, '2024-09-23', '2029-09-23', '2032-09-23', '2029-10-01', 'Sold'),
('LDP95H96XRE300900', 'Free', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'MOHAMAD BSAT', 50000.00, '2025-02-26', '2030-02-26', '2033-02-26', '2029-10-01', 'Sold'),
('LDP91E965RE201864', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Monza SAL / Company Car', 50000.00, '2024-11-20', '2029-11-20', '2032-11-20', '2029-10-01', 'Sold'),
('LDP91E964RE201869', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'OUSSAMA CHOUCAIR / PATCHI', 50000.00, '2025-04-03', '2030-04-03', '2033-04-03', '2029-10-01', 'Sold'),
('LDP91E966RE201873', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'ALI JAWAD AL ATRACH', 50000.00, NULL, NULL, NULL, '2029-10-01', 'SOLD WITH A SUBDEALER, DELOVEY DATE NEEDED ASAP'),
('LDP91E969RE201785', 'Passion', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'SALAM CHARAFELDINE', 50000.00, '2025-02-13', '2030-02-13', '2033-02-13', '2029-10-01', 'Sold'),
('LDP91E961RE201828', 'Passion', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Delivered', 
 'Marianne Kadmous wife Alain Debs', 50000.00, '2025-01-07', '2030-01-07', '2033-01-07', '2029-10-01', 'Sold'),
('LDP91E963RE201829', 'Passion', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Delivered', 
 'Berti Zein', 50000.00, '2025-02-06', '2030-02-06', '2033-02-06', '2029-10-01', 'Sold'),
('LDP95H962RE104949', 'Dream', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Jaber Jafar', 50000.00, '2025-01-24', '2030-01-24', '2033-01-24', '2029-10-15', 'Sold'),
('LDP95H969RE104950', 'Dream', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'Rami Kaddoura', 50000.00, '2024-07-02', '2029-07-02', '2032-07-02', '2029-10-15', 'Sold'),
('LDP95H965RE104945', 'Dream', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'MOHAMAD JOMAA', 50000.00, '2024-09-09', '2029-09-09', '2032-09-09', '2029-10-15', 'Sold'),
('LDP29H92XSM520018', 'Mhero', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Delivered', 
 'NAME NEEDED', 50000.00, NULL, NULL, NULL, NULL, 'DELIVERY DATE NEEDED SOLD BY BLACK MOTORS, DETAILS NEEDED'),
('LDP29H927SM520025', 'MHERO', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Delivered', 
 'Faraj Kanso', 50000.00, NULL, NULL, NULL, NULL, 'DELIVERY DATE NEEDED'),
('LDP95H96XRE300413', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Delivered', 
 'Fares South Dealer', 50000.00, NULL, NULL, NULL, '2029-10-01', 'Sold'),
('LDP95H965SE900276', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Antoine Daou', 50000.00, NULL, NULL, NULL, '2030-08-20', 'TO BE DELIVERED'),
-- Available Vehicles (40 vehicles)
('LDP29H926SM520016', 'MHERO', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Available', 
 'Rishard Hashem', 50000.00, '2025-07-26', '2030-07-26', '2033-07-26', NULL, 'Available'),
('LDP91E963SE100280', 'PASSION', 'Voyah', 2025, 'WHITE', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-10-07', 'Available'),
('LDP91E965SE100278', 'PASSION', 'Voyah', 2025, 'WHITE', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-10-07', 'Available'),
('LDP91E962SE100268', 'PASSION', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-10-07', 'Available'),
('LDP95C966SY890018', 'COURAGE', 'Voyah', 2025, 'WHITE', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP95C965SY890009', 'COURAGE', 'Voyah', 2025, 'WHITE', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP95C962SY890016', 'COURAGE', 'Voyah', 2025, 'WHITE', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LGB320H80SW800064', 'COURAGE', 'Voyah', 2025, 'WHITE', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS (Chinese version)'),
('LDP95C960SY890094', 'COURAGE', 'Voyah', 2025, 'BLACK', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP95C962SY890095', 'COURAGE', 'Voyah', 2025, 'BLACK', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP95C964SY890096', 'COURAGE', 'Voyah', 2025, 'BLACK', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP95C964PE009325', 'DREAM', 'Voyah', 2023, 'BLACK', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP91C96XPE203188', 'PASSION', 'Voyah', 2023, 'BLACK', 'EV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-06-12', 'Available'),
('LDP95H962RE301829', 'Free', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-07-01', 'Available'),
('LDP95H963RE302388', 'Free', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-09-07', 'Available'),
('LDP95H967RE301759', 'Free', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-09-07', 'Available'),
('LDP95H961RE300655', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-10-01', 'Available'),
('LDP95H968RE302211', 'Free', 'Voyah', 2024, 'GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-10-01', 'Available'),
('LDP95H968RE301897', 'Free', 'Voyah', 2024, 'WHITE', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-10-01', 'Available'),
('LDP95H962RE104952', 'DREAM', 'Voyah', 2024, 'BLACK', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2029-10-15', 'Available'),
('LDP29H928SM520017', 'MHERO', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'Available'),
('LDP29H925SM520024', 'MHERO', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'Available'),
('LDP29H922SM520014', 'MHERO', 'Voyah', 2025, 'FANJING GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'Available'),
('LDP95H962SE900266', 'FREE', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H963SE009001', 'FREE', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, NULL, 'NOT ON DMS'),
('LDP95H964SE900270', 'FREE', 'Voyah', 2025, 'BLACK', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H960SE900248', 'FREE', 'Voyah', 2025, 'GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H960SE900251', 'FREE', 'Voyah', 2025, 'GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-21', 'Available'),
('LDP95H969SE900250', 'FREE', 'Voyah', 2025, 'GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H962SE900252', 'FREE', 'Voyah', 2025, 'GREEN', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H963SE900261', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-21', 'Available'),
('LDP95H964SE900253', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H966SE900271', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H967SE900263', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-21', 'Available'),
('LDP95H968SE900255', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-21', 'Available'),
('LDP95H968SE900269', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H968SE900272', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H969SE900264', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available'),
('LDP95H96XSE900256', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-21', 'Available'),
('LDP95H96XSE900273', 'FREE', 'Voyah', 2025, 'GREY', 'REEV', 'sold', 'Available', 
 'Available', 50000.00, NULL, NULL, NULL, '2030-08-20', 'Available')
) AS t(vin, model, brand, year, color, vehicle_type, status, current_floor, client_name, selling_price, delivery_date, vehicle_warranty_expiry, battery_warranty_expiry, dms_warranty_deadline, notes);

-- Now filter out vehicles that already exist in the database
CREATE TEMP TABLE vehicles_to_insert AS
SELECT t.* FROM temp_vehicles_to_add t
WHERE NOT EXISTS (
    SELECT 1 FROM public.car_inventory c WHERE c.vin = t.vin
);

-- Show how many vehicles will be inserted
SELECT 'Vehicles to be inserted:' as info, COUNT(*) as count FROM vehicles_to_insert;

-- Insert only the new vehicles
INSERT INTO public.car_inventory (
    vin, model, brand, year, color, vehicle_type, status, current_floor, 
    client_name, selling_price, delivery_date, vehicle_warranty_expiry, 
    battery_warranty_expiry, dms_warranty_deadline, notes, created_at, updated_at
)
SELECT 
    vin, model, brand, year, color, vehicle_type, status, current_floor, 
    client_name, selling_price, 
    CASE 
        WHEN delivery_date = '1907-12-30' THEN NULL 
        ELSE delivery_date::DATE 
    END,
    CASE 
        WHEN vehicle_warranty_expiry = '2030-12-30' THEN NULL 
        ELSE vehicle_warranty_expiry::DATE 
    END,
    CASE 
        WHEN battery_warranty_expiry = '2033-12-30' THEN NULL 
        ELSE battery_warranty_expiry::DATE 
    END,
    dms_warranty_deadline::DATE,
    notes, NOW(), NOW()
FROM vehicles_to_insert;

-- Clean up temporary tables
DROP TABLE temp_vehicles_to_add;
DROP TABLE vehicles_to_insert;

-- Verify the data was inserted
SELECT 'Final database state:' as info;
SELECT COUNT(*) as total_records FROM public.car_inventory;
SELECT status, COUNT(*) as count_by_status FROM public.car_inventory GROUP BY status;
SELECT current_floor, COUNT(*) as count_by_floor FROM public.car_inventory GROUP BY current_floor;
