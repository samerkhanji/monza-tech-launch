<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear All Data - Monza TECH</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .btn:hover {
            background: #ff5252;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }
        .btn-safe {
            background: #4ecdc4;
        }
        .btn-safe:hover {
            background: #26d0ce;
        }
        .warning {
            background: rgba(255,193,7,0.2);
            border: 2px solid #ffc107;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .success {
            background: rgba(40,167,69,0.2);
            border: 2px solid #28a745;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .log {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
            font-size: 14px;
            line-height: 1.4;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßπ Monza TECH Data Cleaner</h1>
        
        <div class="warning">
            <h3>‚ö†Ô∏è Warning</h3>
            <p>This will clear ALL sample and mock data from your browser storage. This action cannot be undone!</p>
            <p>Your authentication and essential settings will be preserved.</p>
        </div>

        <div style="text-align: center;">
            <button class="btn" onclick="clearAllData()">üóëÔ∏è Clear All Sample Data</button>
            <button class="btn btn-safe" onclick="clearMockDataOnly()">üßπ Clear Mock Data Only</button>
            <button class="btn btn-safe" onclick="showCurrentData()">üìä Show Current Data</button>
        </div>

        <div id="stats" class="stats" style="display: none;">
            <div class="stat-item">
                <div class="stat-number" id="totalKeys">0</div>
                <div>Total Keys</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="removedKeys">0</div>
                <div>Removed</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="preservedKeys">0</div>
                <div>Preserved</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="sessionCleared">0</div>
                <div>Session Cleared</div>
            </div>
        </div>

        <div id="result"></div>
        <div id="log" class="log" style="display: none;"></div>
    </div>

    <script>
        // All possible localStorage keys that contain sample/mock data
        const allDataKeys = [
            // Car inventories
            'carInventory', 'carInventoryData', 'realCarData', 'garageInventory', 
            'showroomFloor1', 'showroomFloor1Cars', 'showroomFloor2', 'showroomFloor2Cars',
            'garageCarInventory', 'garageCars', 'inventoryFloor2', 'inventoryFloor2Cars',
            
            // Schedule and repair data
            'garageSchedule', 'garageSchedules', 'garageScheduleHistory', 'repairHistory',
            'repairHistoryData', 'repairHistoryLogs', 'garageWorkflow',
            
            // Inventory and parts
            'inventoryItems', 'inventoryItemsData', 'partsInventory', 'partsManagement',
            'lowStockParts', 'orderedParts', 'orderedPartsData', 'orderedPartsManagement',
            'toolsEquipment',
            
            // Orders and logistics
            'orderedCars', 'orderedCarsData', 'orderedCarsManagement', 'deliveries',
            'shippingETA', 'newCarArrivals',
            
            // CRM and marketing
            'marketingCRM', 'marketingCRMData', 'marketingCRMLeads', 'crmLeads',
            'clientRequests', 'customerData', 'leads',
            
            // Sales and test drives
            'sales', 'testDrives', 'testDrivesData', 'testDriveLogs', 'mileageRecords',
            
            // Employee and user data
            'employees', 'userActivity', 'activities', 'timeTracking',
            
            // Financial data
            'financialData', 'kpiData', 'analyticsData',
            
            // Analytics and reports
            'analytics', 'businessActivityLogs', 'activityLogs', 'processLogs',
            
            // Dashboard data
            'dashboardData', 'dashboardSettings', 'enhancedDashboardData',
            
            // Settings and preferences (non-essential)
            'userPreferences', 'appSettings',
            
            // Network and security
            'networkData', 'securityLogs',
            
            // Backup and sync
            'backupData', 'syncData',
            
            // Tutorial and onboarding
            'monza_tutorial_completed', 'monza_tutorial_button_visible', 'monza_first_time_user',
            
            // Workflow data
            'workflowData',
            
            // Request and messaging data
            'requests', 'messages', 'channels', 'notifications',
            'request_notifications_cache',
            
            // Cache and temporary data
            'cached_data', 'temp_data', 'session_data'
        ];

        // Keys to preserve (authentication and essential settings)
        const preservedKeys = [
            'monza_auth_user',        // Keep authentication
            'monza_user_session',     // Keep session
            'app_language',           // Keep language preference
            'theme_preference'        // Keep theme preference
        ];

        function log(message) {
            const logElement = document.getElementById('log');
            logElement.style.display = 'block';
            logElement.innerHTML += message + '<br>';
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
            document.getElementById('log').style.display = 'none';
        }

        function updateStats(totalKeys, removedKeys, preservedKeys, sessionCleared) {
            document.getElementById('stats').style.display = 'grid';
            document.getElementById('totalKeys').textContent = totalKeys;
            document.getElementById('removedKeys').textContent = removedKeys;
            document.getElementById('preservedKeys').textContent = preservedKeys;
            document.getElementById('sessionCleared').textContent = sessionCleared;
        }

        function clearAllData() {
            if (!confirm('‚ö†Ô∏è Are you sure you want to clear ALL sample data? This cannot be undone!')) {
                return;
            }

            clearLog();
            log('üßπ COMPREHENSIVE DATA CLEARING - Monza TECH');
            log('============================================');

            const initialKeys = Object.keys(localStorage);
            log(`üîç Found ${initialKeys.length} total localStorage keys`);

            let removedCount = 0;
            let preservedCount = 0;

            // Remove all data keys
            allDataKeys.forEach(key => {
                if (localStorage.getItem(key) !== null) {
                    localStorage.removeItem(key);
                    removedCount++;
                    log(`   ‚úÖ Removed: ${key}`);
                }
            });

            // Remove any keys that look like data keys but aren't in our list
            initialKeys.forEach(key => {
                if (!preservedKeys.includes(key) && localStorage.getItem(key) !== null) {
                    // Check if it's likely a data key
                    if (key.includes('data') || key.includes('Data') || 
                        key.includes('inventory') || key.includes('Inventory') ||
                        key.includes('cars') || key.includes('Cars') ||
                        key.includes('garage') || key.includes('Garage') ||
                        key.includes('repair') || key.includes('Repair') ||
                        key.includes('schedule') || key.includes('Schedule') ||
                        key.includes('sample') || key.includes('Sample') ||
                        key.includes('mock') || key.includes('Mock') ||
                        key.includes('test') || key.includes('Test')) {
                        localStorage.removeItem(key);
                        removedCount++;
                        log(`   ‚úÖ Removed (pattern): ${key}`);
                    }
                }
            });

            // Check what's preserved
            preservedKeys.forEach(key => {
                if (localStorage.getItem(key) !== null) {
                    preservedCount++;
                    log(`   üîí Preserved: ${key}`);
                }
            });

            // Clear sessionStorage
            const sessionCount = Object.keys(sessionStorage).length;
            sessionStorage.clear();
            log(`üßπ Cleared ${sessionCount} sessionStorage items`);

            // Update stats
            updateStats(initialKeys.length, removedCount, preservedCount, sessionCount);

            log('');
            log('üìä CLEARING SUMMARY:');
            log('==================');
            log(`‚úÖ Removed: ${removedCount} localStorage items`);
            log(`üîí Preserved: ${preservedCount} essential items`);
            log(`üßπ Cleared: ${sessionCount} sessionStorage items`);
            log(`üìã Remaining: ${Object.keys(localStorage).length} localStorage items`);

            log('');
            log('üéâ Data clearing completed!');
            log('üí° Refresh your browser to see the clean application.');

            document.getElementById('result').innerHTML = `
                <div class="success">
                    <h3>‚úÖ Data Cleared Successfully!</h3>
                    <p>Removed ${removedCount} data items and cleared ${sessionCount} session items.</p>
                    <p>Preserved ${preservedCount} essential items (authentication, etc.)</p>
                    <p><strong>Refresh your browser to see the clean application.</strong></p>
                </div>
            `;
        }

        function clearMockDataOnly() {
            clearLog();
            log('üßπ Clearing mock data only...');

            const mockKeys = [
                'carInventory', 'showroomFloor1Cars', 'showroomFloor2Cars', 'garageCars', 
                'repairHistory', 'testDriveLogs', 'marketingCRMLeads', 'crmLeads'
            ];

            let removedCount = 0;
            mockKeys.forEach(key => {
                if (localStorage.getItem(key) !== null) {
                    localStorage.removeItem(key);
                    removedCount++;
                    log(`   ‚úÖ Removed: ${key}`);
                }
            });

            log(`‚úÖ Cleared ${removedCount} mock data items`);
            
            document.getElementById('result').innerHTML = `
                <div class="success">
                    <h3>‚úÖ Mock Data Cleared!</h3>
                    <p>Removed ${removedCount} mock data items while preserving real data.</p>
                </div>
            `;
        }

        function showCurrentData() {
            clearLog();
            log('üìä Current localStorage contents:');
            log('================================');

            const keys = Object.keys(localStorage);
            if (keys.length === 0) {
                log('üì≠ localStorage is empty');
            } else {
                keys.forEach(key => {
                    const value = localStorage.getItem(key);
                    const preview = value ? value.substring(0, 100) + '...' : 'null';
                    log(`üìù ${key}: ${preview}`);
                });
            }

            log('');
            log('üìä sessionStorage contents:');
            log('===========================');
            const sessionKeys = Object.keys(sessionStorage);
            if (sessionKeys.length === 0) {
                log('üì≠ sessionStorage is empty');
            } else {
                sessionKeys.forEach(key => {
                    const value = sessionStorage.getItem(key);
                    const preview = value ? value.substring(0, 100) + '...' : 'null';
                    log(`üìù ${key}: ${preview}`);
                });
            }

            updateStats(keys.length, 0, keys.length, sessionKeys.length);
        }

        // Show current data on page load
        window.onload = function() {
            const keys = Object.keys(localStorage);
            updateStats(keys.length, 0, keys.length, Object.keys(sessionStorage).length);
        };
    </script>
</body>
</html>
