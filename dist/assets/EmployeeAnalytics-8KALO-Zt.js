import{j as e,S as a,I as s,Y as i,Z as r,_ as l,$ as t,a0 as n,C as c,k as o,t as d,K as m,u as p,N as x,aV as h}from"./index-BmUpYGrm.js";import{r as j}from"./vendor-vN6PtkFd.js";import{R as u,B as g,b as f,X as v,Y as N,T as R,L as y,d as T}from"./charts-XrXYWaKo.js";import{T as C,a as b,b as z,c as w,d as S,e as F}from"./table-BEISn_Te.js";import{D as A}from"./download-CLPHGjzE.js";import"./utils-DhcIvS4g.js";const M=({searchTerm:c,onSearchChange:o,specializationFilter:d,onSpecializationChange:m,performanceFilter:p,onPerformanceChange:x,specializations:h})=>e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(a,{className:"absolute left-2 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(s,{placeholder:"Search mechanics...",className:"pl-8",value:c,onChange:e=>o(e.target.value)})]}),e.jsxs(i,{value:d,onValueChange:m,children:[e.jsx(r,{className:"w-48",children:e.jsx(l,{placeholder:"Filter by specialization"})}),e.jsxs(t,{children:[e.jsx(n,{value:"all",children:"All Specializations"}),h.map(a=>e.jsx(n,{value:a,children:a},a))]})]}),e.jsxs(i,{value:p,onValueChange:x,children:[e.jsx(r,{className:"w-48",children:e.jsx(l,{placeholder:"Filter by performance"})}),e.jsxs(t,{children:[e.jsx(n,{value:"all",children:"All Performance"}),e.jsx(n,{value:"high",children:"High (90%+)"}),e.jsx(n,{value:"medium",children:"Medium (80-89%)"}),e.jsx(n,{value:"low",children:"Low (<80%)"})]})]})]}),k=({data:a,period:s})=>{const i=a.map(e=>({name:e.name,"Completed Repairs":e.completedRepairs,"Average Repair Time (days)":e.avgRepairTime,"On-Time Rate (%)":e.onTimeRate}));return e.jsxs(c,{className:"p-4",children:[e.jsxs("h3",{className:"text-lg font-medium mb-4",children:["Repair Metrics by Mechanic - ",s]}),e.jsx("div",{className:"h-[400px] w-full",children:e.jsx(u,{width:"100%",height:"100%",children:e.jsxs(g,{data:i,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(v,{dataKey:"name"}),e.jsx(N,{yAxisId:"left",orientation:"left",stroke:"#8884d8"}),e.jsx(N,{yAxisId:"right",orientation:"right",stroke:"#82ca9d"}),e.jsx(R,{}),e.jsx(y,{}),e.jsx(T,{yAxisId:"left",dataKey:"Completed Repairs",fill:"#8884d8"}),e.jsx(T,{yAxisId:"left",dataKey:"Average Repair Time (days)",fill:"#82ca9d"}),e.jsx(T,{yAxisId:"right",dataKey:"On-Time Rate (%)",fill:"#ffc658"})]})})})]})},E=({data:a})=>e.jsxs(c,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Detailed Mechanic Performance"}),e.jsxs(C,{children:[e.jsx(b,{children:e.jsxs(z,{children:[e.jsx(w,{children:"Mechanic Name"}),e.jsx(w,{children:"Specialization"}),e.jsx(w,{children:"Completed Repairs"}),e.jsx(w,{children:"Avg. Repair Time"}),e.jsx(w,{children:"On-Time Rate"}),e.jsx(w,{children:"Most Repaired Car"})]})}),e.jsxs(S,{children:[a.map(a=>e.jsxs(z,{children:[e.jsx(F,{className:"font-medium",children:a.name}),e.jsx(F,{children:a.specialization}),e.jsx(F,{children:a.completedRepairs}),e.jsxs(F,{children:[a.avgRepairTime," days"]}),e.jsxs(F,{children:[a.onTimeRate,"%"]}),e.jsx(F,{children:a.mostRepairedCar})]},a.name)),0===a.length&&e.jsx(z,{children:e.jsx(F,{colSpan:6,className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No mechanics match your search criteria."})})})]})]})]}),L=({data:a})=>{var s;const i=a.reduce((e,a)=>e+a.completedRepairs,0),r=a.length>0?(a.reduce((e,a)=>e+a.avgRepairTime,0)/a.length).toFixed(1):0,l=a.length>0?Math.round(a.reduce((e,a)=>e+a.onTimeRate,0)/a.length):0,t=(null==(s=a.sort((e,a)=>a.completedRepairs-e.completedRepairs)[0])?void 0:s.name)||"N/A";return e.jsxs(c,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Performance Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Repairs Completed"}),e.jsx("p",{className:"text-2xl font-bold",children:i})]}),e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Repair Time"}),e.jsxs("p",{className:"text-2xl font-bold",children:[r," days"]})]}),e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average On-Time Rate"}),e.jsxs("p",{className:"text-2xl font-bold",children:[l,"%"]})]}),e.jsxs("div",{className:"border rounded-md p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Top Performer"}),e.jsx("p",{className:"text-2xl font-bold",children:t})]})]})]})},P=({data:a,period:s})=>{const{searchTerm:i,setSearchTerm:r,specializationFilter:l,setSpecializationFilter:t,performanceFilter:n,setPerformanceFilter:c,specializations:m,filteredData:p}=(e=>{const[a,s]=j.useState(""),[i,r]=j.useState("all"),[l,t]=j.useState("all"),n=j.useMemo(()=>[...new Set(e.map(e=>e.specialization))],[e]),c=j.useMemo(()=>e.filter(e=>{const s=e.name.toLowerCase().includes(a.toLowerCase()),r="all"===i||e.specialization===i;let t=!0;return"high"===l?t=e.onTimeRate>=90:"medium"===l?t=e.onTimeRate>=80&&e.onTimeRate<90:"low"===l&&(t=e.onTimeRate<80),s&&r&&t}),[e,a,i,l]);return{searchTerm:a,setSearchTerm:s,specializationFilter:i,setSpecializationFilter:r,performanceFilter:l,setPerformanceFilter:t,specializations:n,filteredData:c}})(a);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Mechanic Performance Analysis"}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{d({title:"Excel Export",description:"Mechanic Performance report exported to Excel successfully."})},children:[e.jsx(A,{className:"mr-1"}),"Export"]})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsx(k,{data:p,period:s}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{searchTerm:i,onSearchChange:r,specializationFilter:l,onSpecializationChange:t,performanceFilter:n,onPerformanceChange:c,specializations:m}),e.jsx(E,{data:p})]}),e.jsx(L,{data:p})]})]})},O=()=>{var a,s;const{user:i}=m(),r=p(),[l,t]=j.useState("month"),[n,c]=j.useState([]);return j.useEffect(()=>{var e,a;"OWNER"===(null==(e=null==i?void 0:i.role)?void 0:e.toUpperCase())||null==(a=null==i?void 0:i.role)||a.toLowerCase()},[l,i]),j.useEffect(()=>{var e,a;if("OWNER"!==(null==(e=null==i?void 0:i.role)?void 0:e.toUpperCase())&&"garage_manager"!==(null==(a=null==i?void 0:i.role)?void 0:a.toLowerCase()))return;c([{name:"Ali Hassan",completedRepairs:18,avgRepairTime:2.3,onTimeRate:92,specialization:"Engine",mostRepairedCar:"Voyah Free 2024"},{name:"Walid Nassar",completedRepairs:15,avgRepairTime:1.8,onTimeRate:96,specialization:"Electrical",mostRepairedCar:"Voyah Dream 2024"},{name:"Fadi Abboud",completedRepairs:22,avgRepairTime:2.7,onTimeRate:88,specialization:"Brakes",mostRepairedCar:"MHero 917 2024"},{name:"Tarek Karam",completedRepairs:12,avgRepairTime:3.1,onTimeRate:85,specialization:"Suspension",mostRepairedCar:"Voyah Courage 2025"}])},[i]),"OWNER"!==(null==(a=null==i?void 0:i.role)?void 0:a.toUpperCase())&&"garage_manager"!==(null==(s=null==i?void 0:i.role)?void 0:s.toLowerCase())?(d({title:"Access Denied",description:"Only owners and garage managers can access employee analytics.",variant:"destructive"}),e.jsx(x,{to:"/dashboard"})):e.jsxs("div",{className:"space-y-8 p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Employee Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Track individual employee performance and productivity metrics"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o,{variant:"outline",onClick:()=>r("/repairs"),className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),"View Repairs"]}),e.jsxs("select",{id:"periodFilter",name:"periodFilter",className:"h-10 rounded-md border border-input bg-background px-3 py-2",value:l,onChange:e=>t(e.target.value),children:[e.jsx("option",{value:"week",children:"Last Week"}),e.jsx("option",{value:"month",children:"Last Month"}),e.jsx("option",{value:"quarter",children:"Last Quarter"}),e.jsx("option",{value:"year",children:"Last Year"})]})]})]}),e.jsx("div",{className:"space-y-8",children:e.jsx(P,{data:n,period:l})})]})};export{O as default};
