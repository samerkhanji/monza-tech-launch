var e=Object.defineProperty,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(s,a,n)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[a]=n,t=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&l(e,o,t[o]);if(s)for(var o of s(t))n.call(t,o)&&l(e,o,t[o]);return e};import{j as o,C as r,a as c,L as i,Y as d,Z as u,_ as p,$ as m,a0 as h,I as x,k as j,ak as v,H as g,y as f,z as N,E as y,F as C,D as b}from"./index-BmUpYGrm.js";import{r as _}from"./vendor-vN6PtkFd.js";import{C as S}from"./camera-CKQtJJJ8.js";function w({status:e}){const s="paid"===e;return o.jsx("div",{className:"h-8 w-48 rounded-full bg-muted/60 flex items-center px-1",children:o.jsx("div",{className:"h-6 rounded-full flex items-center justify-center px-3 text-sm "+(s?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"),style:{width:s?"100%":"45%"},children:s?"âœ“ Paid":"Not Paid"})})}function P({value:e,onChange:s,onSave:a,saving:n}){var l,f,N,y,C,b,P,k,A,O,B,D;const L=_.useRef(null),F=_.useRef(null),R=t({status:"not paid",shippingStatus:"not paid",conditionOnArrival:"New",carStatus:"available",currentLocation:null!=(l=e.currentLocation)?l:"showroom_floor_1"},e);return o.jsxs("div",{className:"space-y-8",children:[o.jsxs("section",{children:[o.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full border"}),"Customs Payment"]}),o.jsx(r,{className:"mt-4",children:o.jsx(c,{className:"pt-6",children:o.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Status"}),o.jsxs(d,{value:R.status,onValueChange:e=>s({status:e}),children:[o.jsx(u,{children:o.jsx(p,{placeholder:"Select"})}),o.jsxs(m,{children:[o.jsx(h,{value:"paid",children:"paid"}),o.jsx(h,{value:"not paid",children:"not paid"})]})]}),o.jsx("div",{className:"mt-3",children:o.jsx(w,{status:R.status})})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Customs Cost"}),o.jsx(x,{inputMode:"numeric",value:null!=(f=R.customsCost)?f:"",onChange:e=>s({customsCost:e.target.value}),placeholder:"N/A"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Shipping Cost"}),o.jsx(x,{inputMode:"numeric",value:null!=(N=R.shippingCost)?N:"",onChange:e=>s({shippingCost:e.target.value}),placeholder:"N/A"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Processed By"}),o.jsx(x,{value:null!=(y=R.processedBy)?y:"",onChange:e=>s({processedBy:e.target.value}),placeholder:"N/A"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Payment Date"}),o.jsx(x,{type:"date",value:null!=(C=R.paymentDate)?C:"",onChange:e=>s({paymentDate:e.target.value})})]}),o.jsxs("div",{className:"col-span-12 md:col-span-4",children:[o.jsx(i,{children:"Upload Proof of Payment"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs(j,{type:"button",variant:"outline",onClick:()=>{var e;return null==(e=L.current)?void 0:e.click()},children:[o.jsx(v,{className:"mr-2 h-4 w-4"})," Upload File"]}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"JPG, PNG, PDF (Max 10MB)"})]}),o.jsx("input",{ref:L,type:"file",accept:".jpg,.jpeg,.png,.pdf",className:"hidden",onChange:e=>{var a,n;return s({proofFile:null!=(n=null==(a=e.target.files)?void 0:a[0])?n:null})}})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{className:"invisible block",children:"Take Photo"}),o.jsxs(j,{type:"button",variant:"outline",onClick:()=>{var e;return null==(e=F.current)?void 0:e.click()},children:[o.jsx(S,{className:"mr-2 h-4 w-4"})," Take Photo"]}),o.jsx("input",{ref:F,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:e=>{var a,n;return s({photoFile:null!=(n=null==(a=e.target.files)?void 0:a[0])?n:null})}})]})]})})})]}),o.jsxs("section",{children:[o.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[o.jsx("span",{className:"inline-flex h-5 w-5 items-center justify-center rounded-full border"}),"Location & Inventory"]}),o.jsx(r,{className:"mt-4",children:o.jsxs(c,{className:"pt-6",children:[o.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Current Location"}),o.jsx(x,{value:null!=(b=R.currentLocation)?b:"",onChange:e=>s({currentLocation:e.target.value}),placeholder:"showroom_floor_1"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Floor / Bay Number"}),o.jsx(x,{value:null!=(P=R.floorBay)?P:"",onChange:e=>s({floorBay:e.target.value}),placeholder:"N/A"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Car Status"}),o.jsx(x,{value:null!=(k=R.carStatus)?k:"",onChange:e=>s({carStatus:e.target.value}),placeholder:"available"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-3",children:[o.jsx(i,{children:"Condition on Arrival"}),o.jsx(x,{value:null!=(A=R.conditionOnArrival)?A:"",onChange:e=>s({conditionOnArrival:e.target.value}),placeholder:"New"})]}),o.jsxs("div",{className:"col-span-12 md:col-span-4",children:[o.jsx(i,{children:"Shipping Status"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(w,{status:null!=(O=R.shippingStatus)?O:"not paid"}),o.jsxs(d,{value:R.shippingStatus,onValueChange:e=>s({shippingStatus:e}),children:[o.jsx(u,{className:"w-[160px]",children:o.jsx(p,{placeholder:"Select"})}),o.jsxs(m,{children:[o.jsx(h,{value:"paid",children:"Paid"}),o.jsx(h,{value:"not paid",children:"Not Paid"})]})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-12 gap-4 mt-6",children:[o.jsxs("div",{className:"col-span-12 md:col-span-6",children:[o.jsx(i,{children:"Document Reference"}),o.jsx(x,{value:null!=(B=R.documentRef)?B:"",onChange:e=>s({documentRef:e.target.value}),placeholder:"Enter document reference number"})]}),o.jsxs("div",{className:"col-span-12",children:[o.jsx(i,{children:"Notes"}),o.jsx(g,{rows:4,value:null!=(D=R.notes)?D:"",onChange:e=>s({notes:e.target.value}),placeholder:"Any additional notes about customs processing..."})]})]})]})})]})]})}const k=({open:e,onOpenChange:s,car:a,onCustomsUpdate:n})=>{var l,r,c,i;const[d,u]=_.useState(!1),[p,m]=_.useState({status:a.customs_status||a.customs||"not paid",customsCost:(null==(l=a.customs_cost)?void 0:l.toString())||(null==(r=a.customsAmount)?void 0:r.toString())||"",shippingCost:(null==(c=a.shipping_cost)?void 0:c.toString())||(null==(i=a.shippingCost)?void 0:i.toString())||"",processedBy:a.processed_by||a.customsProcessedBy||"",paymentDate:a.payment_date||a.customsDate||"",documentRef:a.customs_doc_ref||a.customsDocumentation||"",notes:a.customs_notes||a.customsNotes||"",currentLocation:a.current_location||a.currentFloor||"",floorBay:a.floor_bay||"",carStatus:a.status||"",conditionOnArrival:a.condition_on_arrival||"New",shippingStatus:a.shipping_status||"not paid"}),h=()=>{return e=void 0,l=null,t=function*(){u(!0);const e=e=>""===e||"N/A"===e||Number.isNaN(Number(e))?null:Number(e),l={customs_status:p.status,customs_cost:e(p.customsCost||""),shipping_cost:e(p.shippingCost||""),processed_by:p.processedBy||null,payment_date:p.paymentDate||null,customs_doc_ref:p.documentRef||null,customs_notes:p.notes||null,current_location:p.currentLocation||null,floor_bay:p.floorBay||null,status:p.carStatus||null,condition_on_arrival:p.conditionOnArrival||null,shipping_status:p.shippingStatus};try{yield n(a.id,l),s(!1)}catch(t){}finally{u(!1)}},new Promise((s,a)=>{var n=e=>{try{r(t.next(e))}catch(s){a(s)}},o=e=>{try{r(t.throw(e))}catch(s){a(s)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,o);r((t=t.apply(e,l)).next())});var e,l,t};return o.jsx(f,{open:e,onOpenChange:s,children:o.jsxs(N,{className:"max-w-5xl max-h-[90vh] flex flex-col",children:[o.jsx(y,{className:"flex-shrink-0 border-b border-gray-200 pb-4",children:o.jsxs(C,{className:"flex items-center gap-2",children:[o.jsx(b,{className:"h-5 w-5"}),"Customs Management - ",a.model]})}),o.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-6 customs-dialog-content",children:o.jsx(P,{value:p,onChange:e=>m(s=>t(t({},s),e)),onSave:h,saving:d})}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t flex-shrink-0 px-6 pb-4",children:[o.jsx(j,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),o.jsx(j,{onClick:h,disabled:d,children:d?"Saving...":"Update Customs Status"})]})]})})};export{k as C};
