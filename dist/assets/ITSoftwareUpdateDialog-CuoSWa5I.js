var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,l=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&i(e,a,s[a]);if(t)for(var a of t(s))n.call(s,a)&&i(e,a,s[a]);return e},d=(e,t)=>s(e,a(t)),o=(e,s)=>{var a={};for(var i in e)r.call(e,i)&&s.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&t)for(var i of t(e))s.indexOf(i)<0&&n.call(e,i)&&(a[i]=e[i]);return a},c=(e,s,a)=>new Promise((t,r)=>{var n=e=>{try{l(a.next(e))}catch(s){r(s)}},i=e=>{try{l(a.throw(e))}catch(s){r(s)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);l((a=a.apply(e,s)).next())});import{a8 as m,j as x,e as u,n as h,X as p,d as g,au as v,av as j,aw as y,ax as b,ay as N,az as f,aA as w,aB as C,aC as S,aD as D,aE as P,aF as k,aG as T,aH as E,aI as I,i as U,O as R,L as A,I as L,k as O,J as M,am as F,p as _,q as $,r as V,v as z,y as B,z as H,ah as K,C as W,g as J,h as G,A as Y,a as q,c as X,m as Q,ak as Z,a6 as ee,ar as se,H as ae,o as te,t as re,l as ne,E as ie,F as le,a7 as de,a3 as oe}from"./index-BmUpYGrm.js";import{r as ce}from"./vendor-vN6PtkFd.js";import{P as me}from"./pen-line--cRXdmmD.js";import{F as xe}from"./file-text-bXPYLusF.js";import{S as ue}from"./share-2-zYou0fbF.js";import{C as he}from"./cpu-N9C-mmK2.js";import{B as pe}from"./battery-zPCpHw5W.js";import{F as ge}from"./fuel-DD7FDLWK.js";import{X as ve}from"./x-circle-HKM8FhbF.js";import{C as je}from"./camera-CKQtJJJ8.js";import{D as ye}from"./download-CLPHGjzE.js";import{T as be}from"./truck-KpDOpNzC.js";import{S as Ne}from"./smartphone-Cgftoe1I.js";
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=m("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]),we=m("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Ce=({warrantyStatus:e="active",warrantyDaysRemaining:s=0,warrantyMonthsRemaining:a=0,showDetails:t=!0,size:r="md"})=>{const n=(()=>{switch(e){case"active":return{variant:"default",color:"bg-green-100 text-green-800 border-green-300",icon:h,label:"Active",description:t?`${a}m ${s}d remaining`:"Active"};case"expiring_soon":return{variant:"destructive",color:"bg-orange-100 text-orange-800 border-orange-300",icon:g,label:"Expiring Soon",description:t?`${s} days left`:"Expiring Soon"};case"expired":return{variant:"secondary",color:"bg-red-100 text-red-800 border-red-300",icon:p,label:"Expired",description:"Warranty Expired"};default:return{variant:"outline",color:"bg-gray-100 text-gray-800 border-gray-300",icon:h,label:"Unknown",description:"Status Unknown"}}})(),i=n.icon,l={sm:"text-xs px-2 py-1",md:"text-sm px-3 py-1",lg:"text-base px-4 py-2"};return t?x.jsxs("div",{className:"flex flex-col gap-1",children:[x.jsxs(u,{variant:n.variant,className:`inline-flex items-center gap-1 ${n.color} ${l[r]}`,children:[x.jsx(i,{className:"w-3 h-3"}),n.label]}),t&&x.jsx("span",{className:"text-xs text-gray-600",children:n.description})]}):x.jsxs(u,{variant:n.variant,className:`inline-flex items-center gap-1 ${n.color} ${l[r]}`,children:[x.jsx(i,{className:"w-3 h-3"}),n.label]})};
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var[Se,De]=v("Tooltip",[j]),Pe=j(),ke="TooltipProvider",Te=700,Ee="tooltip.open",[Ie,Ue]=Se(ke),Re=e=>{const{__scopeTooltip:s,delayDuration:a=Te,skipDelayDuration:t=300,disableHoverableContent:r=!1,children:n}=e,i=ce.useRef(!0),l=ce.useRef(!1),d=ce.useRef(0);return ce.useEffect(()=>{const e=d.current;return()=>window.clearTimeout(e)},[]),x.jsx(Ie,{scope:s,isOpenDelayedRef:i,delayDuration:a,onOpen:ce.useCallback(()=>{window.clearTimeout(d.current),i.current=!1},[]),onClose:ce.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.current=!0,t)},[t]),isPointerInTransitRef:l,onPointerInTransitChange:ce.useCallback(e=>{l.current=e},[]),disableHoverableContent:r,children:n})};Re.displayName=ke;var Ae="Tooltip",[Le,Oe]=Se(Ae),Me=e=>{const{__scopeTooltip:s,children:a,open:t,defaultOpen:r,onOpenChange:n,disableHoverableContent:i,delayDuration:o}=e,c=Ue(Ae,e.__scopeTooltip),m=Pe(s),[u,h]=ce.useState(null),p=y(),g=ce.useRef(0),v=null!=i?i:c.disableHoverableContent,j=null!=o?o:c.delayDuration,f=ce.useRef(!1),[w,C]=b({prop:t,defaultProp:null!=r&&r,onChange:e=>{e?(c.onOpen(),document.dispatchEvent(new CustomEvent(Ee))):c.onClose(),null==n||n(e)},caller:Ae}),S=ce.useMemo(()=>w?f.current?"delayed-open":"instant-open":"closed",[w]),D=ce.useCallback(()=>{window.clearTimeout(g.current),g.current=0,f.current=!1,C(!0)},[C]),P=ce.useCallback(()=>{window.clearTimeout(g.current),g.current=0,C(!1)},[C]),k=ce.useCallback(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{f.current=!0,C(!0),g.current=0},j)},[j,C]);return ce.useEffect(()=>()=>{g.current&&(window.clearTimeout(g.current),g.current=0)},[]),x.jsx(N,d(l({},m),{children:x.jsx(Le,{scope:s,contentId:p,open:w,stateAttribute:S,trigger:u,onTriggerChange:h,onTriggerEnter:ce.useCallback(()=>{c.isOpenDelayedRef.current?k():D()},[c.isOpenDelayedRef,k,D]),onTriggerLeave:ce.useCallback(()=>{v?P():(window.clearTimeout(g.current),g.current=0)},[P,v]),onOpen:D,onClose:P,disableHoverableContent:v,children:a})}))};Me.displayName=Ae;var Fe="TooltipTrigger",_e=ce.forwardRef((e,s)=>{const a=e,{__scopeTooltip:t}=a,r=o(a,["__scopeTooltip"]),n=Oe(Fe,t),i=Ue(Fe,t),c=Pe(t),m=ce.useRef(null),u=f(s,m,n.onTriggerChange),h=ce.useRef(!1),p=ce.useRef(!1),g=ce.useCallback(()=>h.current=!1,[]);return ce.useEffect(()=>()=>document.removeEventListener("pointerup",g),[g]),x.jsx(w,d(l({asChild:!0},c),{children:x.jsx(C.button,d(l({"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute},r),{ref:u,onPointerMove:S(e.onPointerMove,e=>{"touch"!==e.pointerType&&(p.current||i.isPointerInTransitRef.current||(n.onTriggerEnter(),p.current=!0))}),onPointerLeave:S(e.onPointerLeave,()=>{n.onTriggerLeave(),p.current=!1}),onPointerDown:S(e.onPointerDown,()=>{n.open&&n.onClose(),h.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:S(e.onFocus,()=>{h.current||n.onOpen()}),onBlur:S(e.onBlur,n.onClose),onClick:S(e.onClick,n.onClose)}))}))});_e.displayName=Fe;var[$e,Ve]=Se("TooltipPortal",{forceMount:void 0}),ze="TooltipContent",Be=ce.forwardRef((e,s)=>{const a=Ve(ze,e.__scopeTooltip),t=e,{forceMount:r=a.forceMount,side:n="top"}=t,i=o(t,["forceMount","side"]),c=Oe(ze,e.__scopeTooltip);return x.jsx(D,{present:r||c.open,children:c.disableHoverableContent?x.jsx(Ge,d(l({side:n},i),{ref:s})):x.jsx(He,d(l({side:n},i),{ref:s}))})}),He=ce.forwardRef((e,s)=>{const a=Oe(ze,e.__scopeTooltip),t=Ue(ze,e.__scopeTooltip),r=ce.useRef(null),n=f(s,r),[i,o]=ce.useState(null),{trigger:c,onClose:m}=a,u=r.current,{onPointerInTransitChange:h}=t,p=ce.useCallback(()=>{o(null),h(!1)},[h]),g=ce.useCallback((e,s)=>{const a=e.currentTarget,t={x:e.clientX,y:e.clientY},r=function(e,s,a=5){const t=[];switch(s){case"top":t.push({x:e.x-a,y:e.y+a},{x:e.x+a,y:e.y+a});break;case"bottom":t.push({x:e.x-a,y:e.y-a},{x:e.x+a,y:e.y-a});break;case"left":t.push({x:e.x+a,y:e.y-a},{x:e.x+a,y:e.y+a});break;case"right":t.push({x:e.x-a,y:e.y-a},{x:e.x-a,y:e.y+a})}return t}(t,function(e,s){const a=Math.abs(s.top-e.y),t=Math.abs(s.bottom-e.y),r=Math.abs(s.right-e.x),n=Math.abs(s.left-e.x);switch(Math.min(a,t,r,n)){case n:return"left";case r:return"right";case a:return"top";case t:return"bottom";default:throw new Error("unreachable")}}(t,a.getBoundingClientRect())),n=function(e){const s=e.slice();return s.sort((e,s)=>e.x<s.x?-1:e.x>s.x?1:e.y<s.y?-1:e.y>s.y?1:0),function(e){if(e.length<=1)return e.slice();const s=[];for(let t=0;t<e.length;t++){const a=e[t];for(;s.length>=2;){const e=s[s.length-1],t=s[s.length-2];if(!((e.x-t.x)*(a.y-t.y)>=(e.y-t.y)*(a.x-t.x)))break;s.pop()}s.push(a)}s.pop();const a=[];for(let t=e.length-1;t>=0;t--){const s=e[t];for(;a.length>=2;){const e=a[a.length-1],t=a[a.length-2];if(!((e.x-t.x)*(s.y-t.y)>=(e.y-t.y)*(s.x-t.x)))break;a.pop()}a.push(s)}return a.pop(),1===s.length&&1===a.length&&s[0].x===a[0].x&&s[0].y===a[0].y?s:s.concat(a)}(s)}([...r,...function(e){const{top:s,right:a,bottom:t,left:r}=e;return[{x:r,y:s},{x:a,y:s},{x:a,y:t},{x:r,y:t}]}(s.getBoundingClientRect())]);o(n),h(!0)},[h]);return ce.useEffect(()=>()=>p(),[p]),ce.useEffect(()=>{if(c&&u){const e=e=>g(e,u),s=e=>g(e,c);return c.addEventListener("pointerleave",e),u.addEventListener("pointerleave",s),()=>{c.removeEventListener("pointerleave",e),u.removeEventListener("pointerleave",s)}}},[c,u,g,p]),ce.useEffect(()=>{if(i){const e=e=>{const s=e.target,a={x:e.clientX,y:e.clientY},t=(null==c?void 0:c.contains(s))||(null==u?void 0:u.contains(s)),r=!function(e,s){const{x:a,y:t}=e;let r=!1;for(let n=0,i=s.length-1;n<s.length;i=n++){const e=s[n],l=s[i],d=e.x,o=e.y,c=l.x,m=l.y;o>t!=m>t&&a<(c-d)*(t-o)/(m-o)+d&&(r=!r)}return r}(a,i);t?p():r&&(p(),m())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[c,u,i,m,p]),x.jsx(Ge,d(l({},e),{ref:n}))}),[Ke,We]=Se(Ae,{isInside:!1}),Je=T("TooltipContent"),Ge=ce.forwardRef((e,s)=>{const a=e,{__scopeTooltip:t,children:r,"aria-label":n,onEscapeKeyDown:i,onPointerDownOutside:c}=a,m=o(a,["__scopeTooltip","children","aria-label","onEscapeKeyDown","onPointerDownOutside"]),u=Oe(ze,t),h=Pe(t),{onClose:p}=u;return ce.useEffect(()=>(document.addEventListener(Ee,p),()=>document.removeEventListener(Ee,p)),[p]),ce.useEffect(()=>{if(u.trigger){const e=e=>{const s=e.target;(null==s?void 0:s.contains(u.trigger))&&p()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[u.trigger,p]),x.jsx(P,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:e=>e.preventDefault(),onDismiss:p,children:x.jsxs(k,d(l(l({"data-state":u.stateAttribute},h),m),{ref:s,style:l(l({},m.style),{"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}),children:[x.jsx(Je,{children:r}),x.jsx(Ke,{scope:t,isInside:!0,children:x.jsx(E,{id:u.contentId,role:"tooltip",children:n||r})})]}))})});Be.displayName=ze;var Ye="TooltipArrow";ce.forwardRef((e,s)=>{const a=e,{__scopeTooltip:t}=a,r=o(a,["__scopeTooltip"]),n=Pe(t);return We(Ye,t).isInside?null:x.jsx(I,d(l(l({},n),r),{ref:s}))}).displayName=Ye;var qe=Be;const Xe=Re,Qe=Me,Ze=_e,es=ce.forwardRef((e,s)=>{var a=e,{className:t,sideOffset:r=4}=a,n=o(a,["className","sideOffset"]);return x.jsx(qe,l({ref:s,sideOffset:r,className:U("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t)},n))});es.displayName=qe.displayName;const ss=({warrantyStartDate:e,warrantyEndDate:s,warrantyMonthsRemaining:a=0,warrantyDaysRemaining:t=0,warrantyStatus:r="active",compact:n=!1,editable:i=!0,onSave:l,carId:d})=>{const[o,c]=ce.useState(!1),[m,u]=ce.useState(e||""),[h,v]=ce.useState(s||""),j=()=>{l&&h&&l({warrantyStartDate:m,warrantyEndDate:h}),c(!1)},y=()=>{u(e||""),v(s||""),c(!1)},b=()=>{i&&c(!0)},N=e=>{try{return new Date(e).toLocaleDateString()}catch(s){return e}},f=(()=>{if(!s)return{status:"no_data",color:"gray",text:"No warranty data"};try{const e=new Date,a=new Date(s),t=Math.ceil((a.getTime()-e.getTime())/864e5);return t<0?{status:"expired",color:"red",text:"Warranty Expired"}:t<=30?{status:"expiring_soon",color:"orange",text:"Expiring Soon"}:{status:"active",color:"green",text:"Warranty Active"}}catch(e){return{status:"unknown",color:"gray",text:"Invalid Date"}}})();return s||o?o?x.jsx("div",{className:"p-2",children:x.jsxs("div",{className:"space-y-2 p-3 border rounded-lg bg-blue-50 border-blue-200",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsxs("div",{children:[x.jsx(A,{htmlFor:"start-date",className:"text-xs font-medium",children:"Start Date"}),x.jsx(L,{id:"start-date",type:"text",placeholder:"2025-01-01",value:m,onChange:e=>u(e.target.value),className:"h-7 text-xs"})]}),x.jsxs("div",{children:[x.jsx(A,{htmlFor:"end-date",className:"text-xs font-medium",children:"End Date *"}),x.jsx(L,{id:"end-date",type:"text",placeholder:"2030-12-31",value:h,onChange:e=>v(e.target.value),className:"h-7 text-xs",required:!0})]})]}),x.jsxs("div",{className:"flex gap-1",children:[x.jsxs(O,{size:"sm",onClick:j,className:"h-6 px-2 text-xs",disabled:!h,children:[x.jsx(M,{className:"w-3 h-3 mr-1"}),"Save"]}),x.jsxs(O,{size:"sm",variant:"outline",onClick:y,className:"h-6 px-2 text-xs",children:[x.jsx(p,{className:"w-3 h-3 mr-1"}),"Cancel"]})]}),x.jsx("div",{className:"text-xs text-gray-500",children:"Format: YYYY-MM-DD"})]})}):n?x.jsx("div",{className:"p-2",children:x.jsx(Xe,{children:x.jsxs(Qe,{children:[x.jsx(Ze,{asChild:!0,children:x.jsxs("div",{className:""+(i?"cursor-pointer hover:opacity-80":""),onClick:e=>{e.stopPropagation(),i&&b()},children:[x.jsx(Ce,{warrantyStatus:r,warrantyDaysRemaining:t,warrantyMonthsRemaining:a,showDetails:!1,size:"sm"}),i&&x.jsx(me,{className:"w-3 h-3 text-gray-400 ml-1 inline"})]})}),x.jsx(es,{className:"max-w-xs",children:x.jsxs("div",{className:"space-y-2",children:[x.jsx("div",{className:"flex items-center gap-2",children:x.jsxs("span",{className:"text-sm",children:["Expires: ",N(s)]})}),x.jsx("div",{className:"flex items-center gap-2",children:x.jsxs("span",{className:"text-sm",children:[t," days (",a," months) remaining"]})}),e&&x.jsxs("div",{className:"text-xs text-gray-600",children:["Started: ",N(e)]}),i&&x.jsx("div",{className:"text-xs text-blue-600 font-medium border-t pt-2",children:"Click to edit warranty dates"})]})})]})})}):x.jsx("div",{className:"p-2",children:x.jsx("div",{className:""+(i?"cursor-pointer hover:bg-blue-50 hover:border-blue-200 p-2 rounded border border-transparent transition-all duration-200":"p-2 rounded border border-gray-200"),onClick:e=>{e.stopPropagation(),i&&b()},title:i?"Click to edit warranty dates":"Warranty information",children:x.jsxs("div",{className:"space-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(F,{className:`w-4 h-4 text-${f.color}-500`}),x.jsx("span",{className:`text-sm font-medium text-${f.color}-700`,children:f.text}),i&&x.jsx(me,{className:"w-3 h-3 text-gray-400 hover:text-gray-600"})]}),x.jsxs("div",{className:"space-y-1 text-xs",children:[x.jsx("div",{className:"flex items-center gap-1",children:x.jsxs("span",{className:"text-gray-700",children:["Expires: ",x.jsx("span",{className:"font-medium",children:N(s)})]})}),e&&x.jsx("div",{className:"flex items-center gap-1",children:x.jsxs("span",{className:"text-gray-700",children:["Started: ",x.jsx("span",{className:"font-medium",children:N(e)})]})}),t>0&&x.jsxs("div",{className:"flex items-center gap-1",children:[x.jsx(g,{className:"w-3 h-3 text-orange-500"}),x.jsxs("span",{className:"text-orange-700",children:[t," days remaining"]})]})]})]})})}):x.jsx("div",{className:"p-2",children:x.jsx("div",{className:""+(i?"cursor-pointer hover:bg-blue-50 hover:border-blue-200 p-2 rounded border border-dashed border-gray-300 transition-all duration-200":"p-2 rounded border border-gray-200 bg-gray-50"),onClick:e=>{e.stopPropagation(),i&&b()},title:i?"Click to add warranty information":"No warranty data available",children:x.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[x.jsx(R,{className:"w-4 h-4 text-blue-500"}),x.jsx("span",{className:"text-sm text-blue-600 font-medium",children:i?"Add Warranty Dates":"No Warranty"})]})})})};const as=new class{constructor(){var e;i(this,"symbol"!=typeof(e="storageKey")?e+"":e,"monza_kilometers_updates")}getKilometersDriven(e){try{const s=this.getStoredUpdates().find(s=>s.carId===e);return(null==s?void 0:s.kilometersDriven)||0}catch(s){return 0}}updateKilometersDriven(e,s,a,t){return new Promise((r,n)=>{try{const n=this.getStoredUpdates(),i=n.findIndex(s=>s.carId===e),l={carId:e,vinNumber:s,model:a,kilometersDriven:t,updatedAt:(new Date).toISOString(),updatedBy:"current_user"};i>=0?n[i]=l:n.push(l),localStorage.setItem(this.storageKey,JSON.stringify(n)),r()}catch(i){n(i)}})}getStoredUpdates(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return[]}}clearStoredUpdates(){localStorage.removeItem(this.storageKey)}getKilometersHistory(e){return this.getStoredUpdates().filter(s=>s.carId===e)}getAllCarsWithKilometers(){return this.getStoredUpdates().map(e=>({carId:e.carId,vinNumber:e.vinNumber,model:e.model,kilometersDriven:e.kilometersDriven}))}},ts=({status:e})=>x.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs border ${{in_stock:"bg-emerald-50 text-emerald-700 border-emerald-200",reserved:"bg-amber-50 text-amber-700 border-amber-200",sold:"bg-slate-800 text-white border-slate-800",service:"bg-sky-50 text-sky-700 border-sky-200"}[e]}`,children:String(e).replace("_"," ")}),rs=({className:e="",children:s})=>x.jsx("div",{className:`rounded-2xl border bg-white shadow-sm ${e}`,children:s}),ns=({title:e,value:s})=>x.jsxs(rs,{className:"p-4",children:[x.jsx("div",{className:"text-xs text-neutral-500 mb-1",children:e}),x.jsx("div",{className:"text-base font-medium break-all",children:null!=s?s:"—"})]}),is=({percent:e})=>{const s=Math.max(0,Math.min(100,Number.isFinite(e)?e:0));return x.jsxs(rs,{className:"p-4 flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("div",{className:"text-xs text-neutral-500 mb-1",children:"Battery"}),x.jsxs("div",{className:"text-base font-medium",children:[s,"%"]})]}),x.jsx("div",{className:"w-12 h-12 rounded-full border relative",children:x.jsx("div",{className:"absolute inset-0 rounded-full",style:{background:`conic-gradient(#111 ${s}%, transparent 0)`,mask:"radial-gradient(circle 9px, transparent 8px, black 9px)",WebkitMask:"radial-gradient(circle 9px, transparent 8px, black 9px)"}})})]})},ls=({km:e})=>{const s=Number.isFinite(e)?e:0,a=Math.max(0,Math.min(1,s/800));return x.jsxs(rs,{className:"p-4",children:[x.jsx("div",{className:"text-xs text-neutral-500 mb-1",children:"Range left"}),x.jsxs("div",{className:"text-base font-medium mb-2",children:[s.toLocaleString()," km"]}),x.jsx("div",{className:"h-2 rounded-full bg-neutral-200 relative overflow-hidden",children:x.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-neutral-900",style:{width:100*a+"%"}})})]})},ds=({label:e})=>x.jsxs(rs,{className:"p-4",children:[x.jsx("div",{className:"text-xs text-neutral-500 mb-1",children:"Location"}),x.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-50 text-blue-700 border border-blue-200",children:e||"—"})]}),os=({label:e,value:s})=>x.jsxs("div",{className:"min-w-0",children:[x.jsx("div",{className:"text-xs text-neutral-500 mb-1",children:e}),x.jsx("div",{className:"text-sm font-medium truncate",children:null!=s?s:"—"})]}),cs=()=>x.jsx("div",{className:"col-span-full border-t my-1"});function ms({car:e,onEdit:s,onSchedule:a,onPrint:t,onShare:r}){var n,i,l;const d=["Cars",`${(null==e?void 0:e.brand)||""} ${(null==e?void 0:e.model)||""} ${(null==e?void 0:e.year)||""}`.trim()],o=(null==e?void 0:e.vinNumber)||(null==e?void 0:e.vin)||"—",c=(null==e?void 0:e.licensePlate)||(null==e?void 0:e.clientLicensePlate)||"—",m=null!=(n=null==e?void 0:e.batteryPercentage)?n:0,h=null!=(i=null==e?void 0:e.range)?i:0,p=as.getKilometersDriven(null==e?void 0:e.id)||(null==e?void 0:e.kmDriven)||(null==e?void 0:e.mileage)||0,g=(null==e?void 0:e.currentFloor)||(null==e?void 0:e.currentLocation)||"N/A",v=(null==e?void 0:e.status)||"in_stock";return x.jsxs("div",{className:"p-6 space-y-6 bg-neutral-50 min-h-screen",children:[x.jsx("style",{children:'\n\t\t\t\t:where(.car-details-root) input[type="date"]::-webkit-calendar-picker-indicator,\n\t\t\t\t:where(.car-details-root) input[type="datetime-local"]::-webkit-calendar-picker-indicator,\n\t\t\t\t:where(.car-details-root) input::-webkit-calendar-picker-indicator { display: none !important; opacity: 0 !important; visibility: hidden !important; -webkit-appearance: none !important; }\n\t\t\t\t:where(.car-details-root) input[type="date"],\n\t\t\t\t:where(.car-details-root) input[type="datetime-local"] { background-image: none !important; }\n\t\t\t'}),x.jsxs("div",{className:"car-details-root space-y-6",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("nav",{className:"text-sm text-neutral-500 truncate",children:d.map((e,s)=>x.jsxs("span",{className:"whitespace-nowrap",children:[s>0&&x.jsx("span",{className:"mx-2",children:"/"}),e]},s))}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(ts,{status:v}),x.jsx("button",{className:"btn-muted",onClick:s,children:"Edit"}),x.jsx("button",{className:"btn-muted",onClick:a,children:"Schedule"}),x.jsx("button",{className:"btn-muted",onClick:t,children:"Print"}),x.jsx("button",{className:"btn-muted",onClick:r,children:"Share"})]})]}),x.jsxs(_,{defaultValue:"overview",className:"w-full",children:[x.jsxs($,{className:"grid w-full grid-cols-2",children:[x.jsx(V,{value:"overview",children:"Overview"}),x.jsx(V,{value:"history",children:"Car History"})]}),x.jsx(z,{value:"overview",className:"space-y-6",children:x.jsxs(rs,{className:"p-6",children:[x.jsxs("section",{className:"grid grid-cols-12 gap-4 auto-rows-[1fr]",children:[x.jsx("div",{className:"rounded-2xl border bg-white shadow-sm col-span-12 lg:col-span-7 h-[380px] flex items-center justify-center",children:x.jsx("span",{className:"text-sm text-neutral-500",children:"Gallery (add images)"})}),x.jsxs("div",{className:"col-span-12 lg:col-span-5 grid gap-4 grid-cols-2 auto-rows-[minmax(120px,1fr)]",children:[x.jsx(ns,{title:"VIN",value:o}),x.jsx(ns,{title:"Plate",value:c}),x.jsx(is,{percent:m}),x.jsx(ls,{km:h}),x.jsx(ns,{title:"Odometer",value:`${p} km`}),x.jsx(ds,{label:g})]})]}),x.jsx("div",{className:"my-4 border-t"}),x.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[x.jsx("span",{children:"🚗"})," Vehicle & Sale Details"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-x-8 gap-y-5",children:[x.jsx(os,{label:"Customer Name",value:(null==e?void 0:e.clientName)||"Unassigned"}),x.jsx(os,{label:"Customer Phone / Email",value:(null==e?void 0:e.clientPhone)||"N/A"}),x.jsx(os,{label:"Sale Status",value:"sold"===v?"Sold":"reserved"===v?"Reserved":"Available"}),x.jsx(os,{label:"Date Sold",value:(null==e?void 0:e.clientPurchaseDate)?new Date(e.clientPurchaseDate).toLocaleDateString():"N/A"}),x.jsx(os,{label:"Salesperson",value:(null==e?void 0:e.salesperson)||"N/A"}),x.jsx("div",{}),x.jsx(cs,{}),x.jsx(os,{label:"VIN Number",value:o}),x.jsx(os,{label:"Number Plate",value:c}),x.jsx(os,{label:"Category",value:(null==e?void 0:e.category)||"N/A"}),x.jsx(os,{label:"Stock / Internal Code",value:(null==e?void 0:e.internalCode)||(null==e?void 0:e.carCode)||"N/A"})]})]})}),x.jsx(z,{value:"history",className:"space-y-6",children:x.jsxs(rs,{className:"p-6",children:[x.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[x.jsx("span",{children:"📋"})," Car History - ",null==e?void 0:e.model," (",null==e?void 0:e.vinNumber,")"]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Vehicle Information"}),x.jsxs("div",{className:"space-y-2 text-sm",children:[x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"VIN:"})," ",null==e?void 0:e.vinNumber]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Brand:"})," ",(null==e?void 0:e.brand)||"N/A"]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Color:"})," ",null==e?void 0:e.color]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Model:"})," ",null==e?void 0:e.model]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Year:"})," ",null==e?void 0:e.year]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Status:"}),x.jsx(u,{className:"ml-2 "+("sold"===v?"bg-blue-100 text-blue-800":"reserved"===v?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"sold"===v?"Sold":"reserved"===v?"Reserved":"Available"})]})]})]}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Current Status"}),x.jsxs("div",{className:"space-y-2 text-sm",children:[x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Price:"})," ",x.jsxs("span",{className:"text-green-600 font-medium",children:["$",(null==(l=null==e?void 0:e.sellingPrice)?void 0:l.toLocaleString())||"N/A"]})]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Battery:"})," ",m,"%"]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium",children:"Range:"})," ",h," km"]})]})]})]}),x.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[x.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[x.jsx("span",{className:"text-lg",children:"✔"}),x.jsx("span",{className:"font-medium",children:"SUCCESS! Car clicking is working correctly!"})]}),x.jsx("p",{className:"text-green-700 text-sm mt-1",children:"This is a simplified version of the car history dialog. The full version with tabs will be available once this basic functionality is confirmed."})]})]})]})})]})]})]})}const xs=({isOpen:e,onClose:s,car:a,onCarUpdate:t})=>{var r,n,i,o;const[m,g]=ce.useState(!1),[v,j]=ce.useState({}),[y,b]=ce.useState(!1),N=ce.useRef(null),f=ce.useRef(null);if(!a)return null;const w=e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e):"N/A",C=e=>e?new Date(e).toLocaleDateString():"N/A",S=e=>{switch(e){case"in_stock":return"bg-green-100 text-green-800 border-green-200";case"sold":return"bg-red-100 text-red-800 border-red-200";case"reserved":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},D=e=>{switch(e){case"paid":return"bg-green-100 text-green-800 border-green-200";case"not paid":return"bg-red-100 text-red-800 border-red-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"exempted":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},P=()=>{j(l({},a)),g(!0)},k=(e,s)=>{j(a=>d(l({},a),{[e]:s}))},T=e=>c(void 0,null,function*(){var s;const r=null==(s=e.target.files)?void 0:s[0];if(!r)return;if(r.size>10485760)return void re({title:"File Too Large",description:"Please select a file smaller than 10MB.",variant:"destructive"});if(["image/jpeg","image/jpg","image/png","application/pdf"].includes(r.type)){b(!0);try{const e=URL.createObjectURL(r),s={id:`proof_${Date.now()}`,fileName:r.name,fileUrl:e,uploadDate:(new Date).toISOString(),fileSize:r.size,fileType:r.type},n=[...a.customsProof||[],s];t(a.id,{customsProof:n,lastUpdated:(new Date).toISOString()})}catch(n){re({title:"Upload Failed",description:"Failed to upload proof. Please try again.",variant:"destructive"})}finally{b(!1),N.current&&(N.current.value=""),f.current&&(f.current.value="")}}else re({title:"Invalid File Type",description:"Please upload an image (JPG, PNG) or PDF file.",variant:"destructive"})}),E=m?v.customs:a.customs,I=a.customsProof||[];return x.jsx(B,{open:e,onOpenChange:s,children:x.jsxs(H,{className:"bg-white p-0",style:{maxWidth:"95vw",width:"95vw",height:"90vh",maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[x.jsx("div",{className:"p-4 border-b bg-white flex-shrink-0",children:x.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[x.jsx("span",{className:"cursor-pointer hover:underline",children:"Cars"}),x.jsx("span",{children:"/"}),x.jsxs("span",{className:"text-gray-900 font-medium",children:[a.brand||""," ",a.model," ",a.year]})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(u,{className:`px-3 ${S(a.status)}`,children:a.status.replace("_"," ")}),m?x.jsxs("div",{className:"flex gap-2",children:[x.jsxs(O,{onClick:()=>{"paid"!==v.customs||a.customsProof&&0!==a.customsProof.length?(t(a.id,d(l({},v),{lastUpdated:(new Date).toISOString()})),g(!1),j({})):re({title:"Proof Required",description:"Please upload proof of customs payment before marking as paid.",variant:"destructive"})},size:"sm",className:"bg-green-600 hover:bg-green-700",children:[x.jsx(K,{className:"h-4 w-4 mr-2"}),"Save"]}),x.jsxs(O,{onClick:()=>{g(!1),j({})},size:"sm",variant:"outline",children:[x.jsx(p,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):x.jsxs(x.Fragment,{children:[x.jsxs(O,{onClick:P,size:"sm",variant:"outline",children:[x.jsx(xe,{className:"h-4 w-4 mr-2"}),"Edit"]}),x.jsx(O,{size:"sm",variant:"outline",children:"Schedule"}),x.jsxs(O,{size:"sm",variant:"outline",onClick:()=>window.print(),children:[x.jsx(we,{className:"h-4 w-4 mr-2"}),"Print"]}),x.jsxs(O,{size:"sm",variant:"outline",children:[x.jsx(ue,{className:"h-4 w-4 mr-2"}),"Share"]})]})]})]})}),x.jsxs("div",{className:"force-yellow-scrollbar flex-1 overflow-y-auto p-0",style:{backgroundColor:"#f8f9fa"},children:[x.jsx(ms,{car:a,onEdit:P,onSchedule:()=>{},onPrint:()=>window.print(),onShare:()=>{}}),x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(Y,{className:"h-4 w-4"}),"Status & Pricing"]})}),x.jsx(q,{className:"space-y-4 p-4",children:x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx(A,{children:"Status"}),x.jsx(u,{className:`w-full justify-center ${S(a.status)}`,children:a.status.replace("_"," ").toUpperCase()})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Selling Price"}),m?x.jsx(L,{type:"number",step:"0.01",value:v.sellingPrice||"",onChange:e=>k("sellingPrice",parseFloat(e.target.value)||void 0),placeholder:"Enter price"}):x.jsx("div",{className:"p-2 bg-gray-50 rounded font-medium",children:w(a.sellingPrice)})]}),x.jsxs("div",{className:"lg:col-span-2",children:[x.jsx(A,{children:"Warranty Life"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:x.jsx(ss,{warrantyStartDate:a.warrantyStartDate,warrantyEndDate:a.warrantyEndDate,warrantyMonthsRemaining:a.warrantyMonthsRemaining,warrantyDaysRemaining:a.warrantyDaysRemaining,warrantyStatus:a.warrantyStatus,compact:!0})})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Arrival Date"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:C(a.arrivalDate)})]}),x.jsxs("div",{children:[x.jsx(A,{children:"PDI Status"}),x.jsx(u,{className:"w-full justify-center "+(a.pdiCompleted?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"),children:a.pdiCompleted?"Complete":"Pending"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Test Drive"}),x.jsx(u,{className:"w-full justify-center bg-blue-50 text-blue-800 border-blue-200",children:a.testDriveInfo&&a.testDriveInfo.isOnTestDrive?"In Progress":"Available"})]})]})})]}),x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(he,{className:"h-4 w-4"}),"Technical & Condition Details"]})}),x.jsx(q,{className:"space-y-4 p-4",children:x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx(A,{children:"Battery"}),x.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[x.jsx(pe,{className:"h-4 w-4"}),null!=(r=a.batteryPercentage)?r:0,"%"]})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Battery Health"}),x.jsx(u,{className:"w-full justify-center bg-gray-50 text-gray-800 border-gray-200",children:null!=(n=a.batteryHealth)?n:"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Range Capacity"}),x.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[x.jsx(ge,{className:"h-4 w-4"}),null!=(i=a.range)?i:0," km"]})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Km Driven"}),x.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[x.jsx(X,{className:"h-4 w-4"}),as.getKilometersDriven(a.id)||a.kmDriven||a.mileage||0," km"]})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Estimated Range Left"}),x.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[null!=(o=a.estimatedRangeLeft)?o:"N/A"," km"]})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Charging Status"}),x.jsx(u,{className:"w-full justify-center bg-blue-50 text-blue-800 border-blue-200",children:a.chargingStatus||"Idle"})]}),x.jsxs("div",{className:"md:col-span-2",children:[x.jsx(A,{children:"Engine / Motor Type"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.engineType||a.motorType||"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Software Model"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.softwareVersion||"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Software Updated"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.softwareLastUpdated?new Date(a.softwareLastUpdated).toLocaleString():"N/A"})]})]})})]}),x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(xe,{className:"h-4 w-4"}),"Customs Payment"]})}),x.jsxs(q,{className:"space-y-4 p-4",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 p-3 bg-gray-50 rounded",children:[x.jsxs("div",{children:[x.jsx(A,{children:"Status"}),x.jsx("div",{className:"p-2 bg-white rounded border",children:a.customs||"Not Paid"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Customs Cost"}),x.jsx("div",{className:"p-2 bg-white rounded border",children:null!=a.customsCost?`$${a.customsCost}`:"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Shipping Cost"}),x.jsx("div",{className:"p-2 bg-white rounded border",children:null!=a.shippingCost?`$${a.shippingCost}`:"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Processed By"}),x.jsx("div",{className:"p-2 bg-white rounded border",children:a.customsProcessedBy||"N/A"})]})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[x.jsxs("div",{children:[x.jsx(A,{children:"Customs Status"}),m?x.jsxs("select",{value:v.customs||a.customs||"not paid",onChange:e=>{k("customs",e.target.value)},className:"w-full h-11 px-3 border-2 border-gray-300 rounded-md focus:border-monza-yellow focus:ring-2 focus:ring-monza-yellow/20 bg-white cursor-pointer text-gray-900",children:[x.jsx("option",{value:"not paid",children:"🔴 Not Paid"}),x.jsx("option",{value:"paid",children:"🟢 Paid"}),x.jsx("option",{value:"pending",children:"🟡 Pending"}),x.jsx("option",{value:"exempted",children:"🔵 Exempted"})]}):x.jsx(u,{className:`w-full justify-center ${D(a.customs)}`,children:"paid"===E?x.jsxs(x.Fragment,{children:[x.jsx(Q,{className:"mr-1 h-4 w-4"})," Paid"]}):"not paid"===E?x.jsxs(x.Fragment,{children:[x.jsx(ve,{className:"mr-1 h-4 w-4"})," Not Paid"]}):x.jsxs(x.Fragment,{children:[x.jsx(h,{className:"mr-1 h-4 w-4"})," ",E||"Not Paid"]})})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Customs Cost"}),m?x.jsxs("div",{className:"relative",children:[x.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),x.jsx(L,{type:"number",step:"0.01",value:v.customsCost||"",onChange:e=>k("customsCost",parseFloat(e.target.value)||void 0),placeholder:"0.00",className:"pl-8"})]}):x.jsx("div",{className:"p-2 bg-gray-50 rounded font-medium",children:w(a.customsCost)})]}),x.jsxs("div",{className:"md:col-span-2",children:[x.jsx(A,{children:"Upload Proof of Payment"}),x.jsxs("div",{className:"flex gap-2 mt-1",children:[x.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:e=>{var s;e.preventDefault(),e.stopPropagation(),null==(s=N.current)||s.click()},disabled:y,className:"flex-1 hover:bg-blue-50 hover:border-blue-300 transition-colors",children:[x.jsx(Z,{className:"h-4 w-4 mr-2"}),y?"Uploading...":"Upload File"]}),x.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:e=>{var s;e.preventDefault(),e.stopPropagation(),null==(s=f.current)||s.click()},disabled:y,className:"flex-1 hover:bg-green-50 hover:border-green-300 transition-colors",children:[x.jsx(je,{className:"h-4 w-4 mr-2"}),"Take Photo"]})]}),x.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Supported formats: JPG, PNG, PDF (Max 10MB)"})]})]}),I.length>0&&x.jsxs("div",{children:[x.jsx(A,{children:"Uploaded Proof Files"}),x.jsx("div",{className:"mt-2 space-y-2",children:I.map(e=>{return x.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx(xe,{className:"h-4 w-4 text-gray-500"}),x.jsxs("div",{children:[x.jsx("div",{className:"text-sm font-medium",children:e.fileName}),x.jsxs("div",{className:"text-xs text-gray-500",children:[(s=e.fileSize,s<1024?s+" B":s<1048576?Math.round(s/1024)+" KB":Math.round(s/1048576)+" MB")," • ",C(e.uploadDate)]})]})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(O,{size:"sm",variant:"outline",onClick:()=>window.open(e.fileUrl,"_blank"),children:x.jsx(ee,{className:"h-4 w-4"})}),x.jsx(O,{size:"sm",variant:"outline",onClick:()=>{const s=document.createElement("a");s.href=e.fileUrl,s.download=e.fileName,s.click()},children:x.jsx(ye,{className:"h-4 w-4"})}),x.jsx(O,{size:"sm",variant:"outline",onClick:()=>(e=>{const s=(a.customsProof||[]).filter(s=>s.id!==e);t(a.id,{customsProof:s,lastUpdated:(new Date).toISOString()})})(e.id),className:"text-red-600 hover:text-red-700",children:x.jsx(se,{className:"h-4 w-4"})})]})]},e.id);var s})})]})]})]}),x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(be,{className:"h-4 w-4"}),"Location & Inventory"]})}),x.jsxs(q,{className:"space-y-4 p-4",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx(A,{children:"Current Location"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.currentFloor||a.currentLocation||"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Floor / Bay Number"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.bayNumber||a.floorNumber||"N/A"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Arrival Date"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:C(a.arrivalDate)})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Condition on Arrival"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.arrivalCondition||"New"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Car Status"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.status.replace("_"," ")})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Shipping Status"}),m?x.jsxs("select",{value:v.shippingStatus||a.shippingStatus||"not paid",onChange:e=>{k("shippingStatus",e.target.value)},className:"w-full h-11 px-3 border-2 border-gray-300 rounded-md focus:border-monza-yellow focus:ring-2 focus:ring-monza-yellow/20 bg-white cursor-pointer text-gray-900",children:[x.jsx("option",{value:"not paid",children:"🔴 Not Paid"}),x.jsx("option",{value:"paid",children:"🟢 Paid"}),x.jsx("option",{value:"pending",children:"🟡 Pending"})]}):x.jsx(u,{className:`w-full justify-center ${D(a.shippingStatus)}`,children:"paid"===a.shippingStatus?x.jsxs(x.Fragment,{children:[x.jsx(Q,{className:"mr-1 h-4 w-4"})," Paid"]}):"not paid"===a.shippingStatus?x.jsxs(x.Fragment,{children:[x.jsx(ve,{className:"mr-1 h-4 w-4"})," Not Paid"]}):x.jsxs(x.Fragment,{children:[x.jsx(h,{className:"mr-1 h-4 w-4"})," ",a.shippingStatus||"Not Paid"]})})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Shipping Cost"}),m?x.jsxs("div",{className:"relative",children:[x.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),x.jsx(L,{type:"number",step:"0.01",value:v.shippingCost||"",onChange:e=>k("shippingCost",parseFloat(e.target.value)||void 0),placeholder:"0.00",className:"pl-8",title:"Enter shipping cost for assistants to record"})]}):x.jsx("div",{className:"p-2 bg-gray-50 rounded font-medium",children:w(a.shippingCost)})]})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Shipping Notes"}),m?x.jsx(ae,{value:v.shippingNotes||"",onChange:e=>k("shippingNotes",e.target.value),placeholder:"Enter shipping details, tracking info, etc...",rows:2,className:"resize-none"}):x.jsx("div",{className:"p-2 bg-gray-50 rounded min-h-[60px] text-sm",children:a.shippingNotes||"No shipping notes available"})]})]})]}),a.clientName&&x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(te,{className:"h-4 w-4"}),"Client Information"]})}),x.jsxs(q,{className:"space-y-3 p-4",children:[x.jsxs("div",{children:[x.jsx(A,{children:"Client Name"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded font-medium",children:a.clientName})]}),a.clientPhone&&x.jsxs("div",{children:[x.jsx(A,{children:"Phone Number"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:(e=>{if(!e)return"N/A";const s=(""+e).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return s?`${s[1]}-${s[2]}-${s[3]}`:e})(a.clientPhone)})]}),a.clientLicensePlate&&x.jsxs("div",{children:[x.jsx(A,{children:"License Plate"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.clientLicensePlate})]})]})]}),x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(Y,{className:"h-4 w-4"}),"Service & History"]})}),x.jsx(q,{className:"space-y-3 p-4",children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx(A,{children:"PDI Status"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.pdiCompleted?"Completed":"Pending"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Next Scheduled Service"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:a.nextServiceDate?C(a.nextServiceDate):"N/A"})]}),x.jsxs("div",{className:"md:col-span-2",children:[x.jsx(A,{children:"Warranty Details"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded",children:x.jsx(ss,{warrantyStartDate:a.warrantyStartDate,warrantyEndDate:a.warrantyEndDate,warrantyMonthsRemaining:a.warrantyMonthsRemaining,warrantyDaysRemaining:a.warrantyDaysRemaining,warrantyStatus:a.warrantyStatus,compact:!0})})]}),x.jsxs("div",{className:"md:col-span-2",children:[x.jsx(A,{children:"Repair / Service History"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded text-sm min-h-[60px]",children:Array.isArray(a.serviceHistory)&&a.serviceHistory.length>0?x.jsx("ul",{className:"list-disc ml-5",children:a.serviceHistory.map((e,s)=>x.jsxs("li",{children:[C(e.date)," — ",e.note||e.description||"Service"]},s))}):"No records"})]})]})})]}),x.jsxs(W,{className:"p-0 border-0 shadow-none rounded-none",children:[x.jsx(J,{className:"bg-white border-0 p-4",children:x.jsxs(G,{className:"flex items-center gap-2",children:[x.jsx(Y,{className:"h-4 w-4"}),"Notes & Attachments"]})}),x.jsxs(q,{className:"space-y-3 p-4",children:[a.batteryPercentage&&x.jsxs("div",{children:[x.jsx(A,{children:"Battery Percentage"}),x.jsxs("div",{className:"p-2 bg-gray-50 rounded",children:[a.batteryPercentage,"%"]})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Internal Notes (staff only)"}),m?x.jsx(ae,{value:v.notes||"",onChange:e=>k("notes",e.target.value),placeholder:"Enter notes...",rows:3}):x.jsx("div",{className:"p-2 bg-gray-50 rounded min-h-[80px]",children:a.notes||"No notes available"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Customer Notes / Requests"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded min-h-[60px] text-sm",children:a.customerNotes||"None"})]}),x.jsxs("div",{children:[x.jsx(A,{children:"Photos & Documents"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded text-sm",children:(a.customsProof||[]).length>0?`${a.customsProof.length} file(s) uploaded`:"No attachments"})]}),a.lastUpdated&&x.jsxs("div",{children:[x.jsx(A,{children:"Last Updated"}),x.jsx("div",{className:"p-2 bg-gray-50 rounded text-sm",children:new Date(a.lastUpdated).toLocaleString()})]})]})]})]}),x.jsx("input",{ref:N,type:"file",accept:"image/*,.pdf",onChange:T,className:"hidden"}),x.jsx("input",{ref:f,type:"file",accept:"image/*",capture:"environment",onChange:T,className:"hidden"})]})})},us=({isOpen:e,onClose:s,car:a,onUpdateComplete:t})=>{const{toast:r}=ne(),[n,i]=ce.useState("update"),[o,m]=ce.useState(!1),[h,p]=ce.useState(0),[v,j]=ce.useState({newVersion:"",updateType:"System Update",updateNotes:"",estimatedDuration:"30",itTechnician:"IT Technician"}),[y]=ce.useState([{id:"1",carVin:(null==a?void 0:a.vinNumber)||"",carModel:(null==a?void 0:a.model)||"",previousVersion:"2.1.0",newVersion:"2.2.0",updateDate:"2024-01-15",updatedBy:"John Smith (IT)",updateType:"infotainment",updateNotes:"Enhanced UI performance and bug fixes",updateDuration:25,rollbackAvailable:!0},{id:"2",carVin:(null==a?void 0:a.vinNumber)||"",carModel:(null==a?void 0:a.model)||"",previousVersion:"2.0.5",newVersion:"2.1.0",updateDate:"2024-01-08",updatedBy:"Sarah Johnson (IT)",updateType:"navigation",updateNotes:"Updated maps and routing algorithms",updateDuration:45,rollbackAvailable:!1}]),b=e=>{switch(e){case"infotainment":return x.jsx(Ne,{className:"h-4 w-4"});case"navigation":case"system":default:return x.jsx(de,{className:"h-4 w-4"});case"battery":return x.jsx(oe,{className:"h-4 w-4"});case"autonomous":return x.jsx(fe,{className:"h-4 w-4"});case"security":return x.jsx(Q,{className:"h-4 w-4"})}},N=e=>{switch(e){case"infotainment":return"bg-blue-100 text-blue-800 border-blue-200";case"navigation":return"bg-green-100 text-green-800 border-green-200";case"battery":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"autonomous":return"bg-purple-100 text-purple-800 border-purple-200";case"system":default:return"bg-gray-100 text-gray-800 border-gray-200";case"security":return"bg-red-100 text-red-800 border-red-200"}};return ce.useEffect(()=>{e&&j({newVersion:"",updateType:"System Update",updateNotes:"",estimatedDuration:"30",itTechnician:"IT Technician"})},[e]),a?((()=>{if(!(null==a?void 0:a.lastUpdated))return{status:"critical",message:"Never updated",daysOld:999};const e=(e=>{const s=new Date(e),a=new Date,t=Math.abs(a.getTime()-s.getTime());return Math.ceil(t/864e5)})(a.lastUpdated)})(),x.jsx(B,{open:e,onOpenChange:s,children:x.jsxs(H,{className:"max-w-5xl w-[95vw] max-h-[90vh] overflow-y-auto px-6 py-5",children:[x.jsx(ie,{children:x.jsxs(le,{className:"flex items-center gap-2",children:[x.jsx(de,{className:"h-6 w-6 text-blue-600"}),"IT Software Management - ",a.model,x.jsx(u,{variant:"outline",className:"font-mono text-sm",children:(null==a?void 0:a.vinNumber)?a.vinNumber.slice(-6):"------"})]})}),x.jsxs(_,{value:n,onValueChange:i,className:"w-full",children:[x.jsxs($,{className:"grid w-full grid-cols-2",children:[x.jsxs(V,{value:"update",className:"flex items-center gap-2",children:[x.jsx(ye,{className:"h-4 w-4"}),"Update Software"]}),x.jsxs(V,{value:"history",className:"flex items-center gap-2",children:[x.jsx(xe,{className:"h-4 w-4"}),"Update History"]})]}),x.jsx(z,{value:"update",className:"space-y-6",children:x.jsxs(W,{className:"rounded-none border border-gray-200",children:[x.jsx(J,{className:"px-4 py-3",children:x.jsxs(G,{className:"text-lg flex items-center gap-2",children:[x.jsx(ye,{className:"h-5 w-5"}),"Perform Software Update"]})}),x.jsxs(q,{className:"space-y-4 px-4 pb-4",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsx(A,{htmlFor:"newVersion",children:"New Software Version *"}),x.jsx(L,{id:"newVersion",value:v.newVersion,onChange:e=>j(s=>d(l({},s),{newVersion:e.target.value})),placeholder:"e.g., 3.1.2"})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(A,{htmlFor:"updateType",children:"Update Type"}),x.jsx(L,{id:"updateType",value:v.updateType,onChange:e=>{j(s=>d(l({},s),{updateType:e.target.value}))},placeholder:"e.g., System Update, Infotainment, Navigation, etc.",className:"w-full"})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(A,{htmlFor:"estimatedDuration",children:"Estimated Duration (minutes)"}),x.jsx(L,{id:"estimatedDuration",type:"number",value:v.estimatedDuration,onChange:e=>j(s=>d(l({},s),{estimatedDuration:e.target.value}))})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(A,{htmlFor:"itTechnician",children:"IT Technician"}),x.jsx(L,{id:"itTechnician",value:v.itTechnician,onChange:e=>j(s=>d(l({},s),{itTechnician:e.target.value})),placeholder:"Technician name"})]})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(A,{htmlFor:"updateNotes",children:"Update Notes"}),x.jsx(ae,{id:"updateNotes",value:v.updateNotes,onChange:e=>j(s=>d(l({},s),{updateNotes:e.target.value})),placeholder:"Describe the update, changes, or improvements...",rows:3})]}),x.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-none p-4",children:[x.jsxs("div",{className:"flex items-center gap-2 text-yellow-800 font-semibold mb-2",children:[x.jsx(g,{className:"h-5 w-5"}),"Pre-Update Checklist"]}),x.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[x.jsx("li",{children:"✓ Vehicle is connected to stable power source"}),x.jsx("li",{children:"✓ WiFi connection is stable and tested"}),x.jsx("li",{children:"✓ No scheduled test drives during update window"}),x.jsx("li",{children:"✓ IT technician is available for monitoring"}),x.jsx("li",{children:"✓ Backup of current configuration completed"})]})]}),x.jsxs("div",{className:"flex gap-3 pt-2",children:[x.jsxs(O,{onClick:()=>c(void 0,null,function*(){if(!v.newVersion.trim())return void r({title:"Missing Information",description:"Please enter the new software version",variant:"destructive"});m(!0),p(0),r({title:"Software Update Started",description:`Updating ${null==a?void 0:a.model} to version ${v.newVersion}...`});const e=setInterval(()=>{p(n=>n>=100?(clearInterval(e),setTimeout(()=>{const e={softwareVersion:v.newVersion,softwareLastUpdated:(new Date).toISOString(),softwareUpdateBy:v.itTechnician,softwareUpdateNotes:v.updateNotes};t((null==a?void 0:a.vinNumber)||"",e),r({title:"Software Update Complete!",description:`${null==a?void 0:a.model} updated to version ${v.newVersion}`}),m(!1),p(0),i("update"),s()},1e3),100):n+15*Math.random()+5)},500)}),className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:o||!v.newVersion.trim(),children:[x.jsx(ye,{className:"h-4 w-4 mr-2"}),"Start Software Update"]}),x.jsx(O,{variant:"outline",onClick:s,children:"Cancel"})]})]})]})}),x.jsx(z,{value:"history",className:"space-y-6",children:x.jsxs(W,{children:[x.jsx(J,{children:x.jsxs(G,{className:"text-lg flex items-center gap-2",children:[x.jsx(xe,{className:"h-5 w-5"}),"Update History"]})}),x.jsx(q,{children:x.jsxs("div",{className:"space-y-4",children:[y.map(e=>x.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs(u,{className:N(e.updateType),children:[b(e.updateType),x.jsx("span",{className:"ml-1",children:e.updateType})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"font-semibold",children:[e.previousVersion," → ",e.newVersion]}),x.jsxs("div",{className:"text-sm text-gray-600",children:[e.updateDuration," minutes"]})]})]}),x.jsxs("div",{className:"text-right",children:[x.jsx("div",{className:"text-sm font-medium",children:new Date(e.updateDate).toLocaleDateString()}),x.jsx("div",{className:"text-xs text-gray-500",children:e.updatedBy})]})]}),e.updateNotes&&x.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-3",children:x.jsx("div",{className:"text-sm text-gray-700",children:e.updateNotes})}),e.rollbackAvailable&&x.jsx("div",{className:"mt-3",children:x.jsx(u,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:"Rollback Available"})})]},e.id)),0===y.length&&x.jsxs("div",{className:"text-center py-8 text-gray-500",children:[x.jsx(xe,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),x.jsx("p",{children:"No update history available"}),x.jsx("p",{className:"text-sm",children:"Updates will appear here after completion"})]})]})})]})})]})]})})):null};export{xs as E,us as I,as as k};
