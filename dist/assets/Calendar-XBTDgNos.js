var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,d=(e,s)=>{for(var a in s||(s={}))l.call(s,a)&&n(e,a,s[a]);if(t)for(var a of t(s))r.call(s,a)&&n(e,a,s[a]);return e};import{be as i,j as o,y as c,z as m,E as x,F as h,n as u,a9 as p,I as j,Y as g,Z as b,_ as v,$ as f,a0 as N,U as y,ab as w,k as C,t as E,O as P,C as D,e as T}from"./index-BmUpYGrm.js";import{r as k}from"./vendor-vN6PtkFd.js";import{C as O}from"./calendar-DQ6SJzpq.js";import{u as S,F as A,a as z,b as M,c as F,d as $,e as V}from"./form-D18p6wVs.js";import{t as I,o as Y,s as H,a as _,d as q}from"./zod-Cunv6AlR.js";import{C as R}from"./checkbox-CbEst83x.js";import{D as U}from"./datetime-input-Dxp48WV8.js";import{f as K}from"./utils-DhcIvS4g.js";import{D as W}from"./download-CLPHGjzE.js";import"./charts-XrXYWaKo.js";import"./chevron-left-D5y0IByA.js";const Z=[{id:"khalil",name:"Khalil"},{id:"mark",name:"Mark"},{id:"tamara",name:"Tamara"},{id:"ahmad",name:"Ahmad"},{id:"sara",name:"Sara"},{id:"omar",name:"Omar"}],B=[{value:"meeting",label:"Customer Meeting"},{value:"repair",label:"Car Repair"},{value:"test_drive",label:"Test Drive"},{value:"maintenance",label:"Maintenance"},{value:"delivery",label:"Car Delivery"}],G=Y({title:H().min(2,"Event title is required"),date:q({required_error:"Please select a date"}),time:H().min(1,"Please select a time"),type:H().min(1,"Please select an event type"),employees:_(H()).min(1,"Please select at least one employee"),carCode:H().optional()}),J=({open:e,onOpenChange:t,onEventAdded:l})=>{const[r,n]=k.useState([]),{addNotification:P}=i(),D=S({resolver:I(G),defaultValues:{title:"",time:"",type:"",employees:[],carCode:""}});return o.jsx(c,{open:e,onOpenChange:t,children:o.jsxs(m,{className:"sm:max-w-[500px]",children:[o.jsxs(x,{children:[o.jsxs(h,{className:"flex items-center gap-2",children:[o.jsx(u,{className:"h-5 w-5"}),"Add New Event"]}),o.jsx(p,{children:"Schedule a new event and assign team members"})]}),o.jsx(A,(T=d({},D),O={children:o.jsxs("form",{onSubmit:D.handleSubmit(e=>{const s={id:Date.now().toString(),title:e.title,date:new Date(e.date.getFullYear(),e.date.getMonth(),e.date.getDate(),parseInt(e.time.split(":")[0]),parseInt(e.time.split(":")[1])),assignedTo:e.employees.join(", "),carCode:e.carCode,status:"scheduled",type:e.type,employees:e.employees};l(s),e.employees.forEach(a=>{const t=Z.find(e=>e.id===a);t&&P({title:"New Event Assignment",description:`You have been assigned to "${e.title}" on ${K(e.date,"PPP")} at ${e.time}`,link:"/calendar",assignedTo:t.name,eventId:s.id})}),E({title:"Event Created",description:`${e.title} has been scheduled for ${K(e.date,"PPP")} at ${e.time}. Notifications sent to assigned employees.`}),D.reset(),n([]),t(!1)}),className:"space-y-4",children:[o.jsx(z,{control:D.control,name:"title",render:({field:e})=>o.jsxs(M,{children:[o.jsx(F,{children:"Event Title"}),o.jsx($,{children:o.jsx(j,d({id:"eventTitle",placeholder:"Enter event title"},e))}),o.jsx(V,{})]})}),o.jsx(z,{control:D.control,name:"date",render:({field:e})=>o.jsxs(M,{children:[o.jsx(U,{label:"Event Date & Time",value:e.value,onChange:e.onChange,required:!0,showTime:!0}),o.jsx(V,{})]})}),o.jsx(z,{control:D.control,name:"type",render:({field:e})=>o.jsxs(M,{children:[o.jsx(F,{children:"Event Type"}),o.jsxs(g,{onValueChange:e.onChange,defaultValue:e.value,children:[o.jsx($,{children:o.jsx(b,{children:o.jsx(v,{placeholder:"Select event type"})})}),o.jsx(f,{children:B.map(e=>o.jsx(N,{value:e.value,children:e.label},e.value))})]}),o.jsx(V,{})]})}),o.jsx(z,{control:D.control,name:"employees",render:()=>o.jsxs(M,{children:[o.jsxs(F,{className:"flex items-center gap-2",children:[o.jsx(y,{className:"h-4 w-4"}),"Assign Employees"]}),o.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto",children:Z.map(e=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(R,{id:e.id,checked:r.includes(e.id),onCheckedChange:s=>((e,s)=>{const a=s?[...r,e]:r.filter(s=>s!==e);n(a),D.setValue("employees",a)})(e.id,s)}),o.jsx("label",{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name})]},e.id))}),o.jsx(V,{})]})}),o.jsx(z,{control:D.control,name:"carCode",render:({field:e})=>o.jsxs(M,{children:[o.jsx(F,{children:"Car Code (Optional)"}),o.jsx($,{children:o.jsx(j,d({id:"eventReference",placeholder:"e.g., VF24-001"},e))}),o.jsx(V,{})]})}),o.jsxs(w,{children:[o.jsx(C,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancel"}),o.jsx(C,{type:"submit",children:"Create Event"})]})]})},s(T,a(O))))]})});var T,O},L=[{id:"1",title:"Customer Meeting - Ahmed",date:new Date(2025,4,21,10,0),assignedTo:"Khalil",status:"scheduled",type:"meeting"},{id:"2",title:"Voyah Free Repair",date:new Date(2025,4,20,13,30),assignedTo:"Mark",carCode:"VF24-001",status:"done",type:"repair"},{id:"3",title:"Test Drive - MHero 917",date:new Date(2025,4,22,15,0),assignedTo:"Tamara",carCode:"MH24-008",status:"scheduled",type:"test_drive"}],Q=()=>{const[e,s]=k.useState(new Date),[a,t]=k.useState(L),[l,r]=k.useState(!1),n=new Date,d=a.filter(e=>e.date>n&&"scheduled"===e.status).sort((e,s)=>e.date.getTime()-s.date.getTime())[0],i=e?a.filter(s=>s.date.getDate()===e.getDate()&&s.date.getMonth()===e.getMonth()&&s.date.getFullYear()===e.getFullYear()):[],c=a.filter(e=>"scheduled"===e.status).map(e=>e.date);return o.jsxs("div",{className:"container p-4 mx-auto max-w-7xl",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4",children:[o.jsx("h1",{className:"text-2xl font-bold",children:"Team Calendar"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs(C,{variant:"outline",onClick:()=>{E({title:"Calendar Exported",description:"Calendar data exported to Excel successfully."})},className:"h-9 text-sm",children:[o.jsx(W,{className:"mr-1 h-4 w-4"}),"Export"]}),o.jsxs(C,{variant:"default",onClick:()=>{r(!0)},className:"h-9 text-sm",children:[o.jsx(P,{className:"mr-1 h-4 w-4"}),"Add Event"]})]})]}),d&&o.jsx(D,{className:"p-4 mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:o.jsx(u,{className:"h-5 w-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-900",children:"Next Upcoming Event"}),o.jsx("p",{className:"text-blue-700 font-medium",children:d.title}),o.jsxs("p",{className:"text-sm text-blue-600",children:[K(d.date,"PPPP")," at ",K(d.date,"h:mm a")]}),o.jsxs("p",{className:"text-sm text-blue-600",children:["Assigned to: ",d.assignedTo]})]})]}),o.jsx(C,{variant:"outline",size:"sm",onClick:()=>{d&&s(d.date)},className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:"View Details"})]})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4",children:[o.jsx("div",{className:"lg:col-span-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-monza-grey/10 shadow-sm p-2",children:[o.jsx(O,{mode:"single",selected:e,onSelect:s,className:"rounded-md mx-auto pointer-events-auto",modifiers:{hasEvent:c,nextEvent:d?[d.date]:[]},modifiersStyles:{hasEvent:{backgroundColor:"#fef3c7",color:"#92400e",fontWeight:"bold"},nextEvent:{backgroundColor:"#dbeafe",color:"#1e40af",fontWeight:"bold",border:"2px solid #3b82f6"}}}),o.jsxs("div",{className:"mt-2 text-center",children:[o.jsx("p",{className:"text-xs text-muted-foreground",children:e?K(e,"PPPP"):"No date selected"}),o.jsxs("div",{className:"flex justify-center gap-4 mt-2 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-3 h-3 bg-yellow-200 rounded border"}),o.jsx("span",{children:"Has Events"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-200 rounded border-2 border-blue-500"}),o.jsx("span",{children:"Next Event"})]})]})]})]})}),o.jsx(D,{className:"p-3 lg:col-span-8 shadow-sm rounded-lg border border-monza-grey/10",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h2",{className:"text-lg font-semibold border-b pb-2 border-monza-grey/10",children:["Events for ",e?K(e,"PPPP"):"Selected Date"]}),i.length>0?o.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[500px] pr-1",children:i.map(e=>o.jsx(D,{className:`p-2 shadow-sm border-l-4 rounded-md ${"done"===e.status?"border-l-green-500":"canceled"===e.status?"border-l-red-500":"border-l-monza-yellow"} ${e.id===(null==d?void 0:d.id)?"ring-2 ring-blue-300 bg-blue-50":""}`,children:o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("h3",{className:"font-medium text-sm flex items-center gap-2",children:[e.title,e.id===(null==d?void 0:d.id)&&o.jsx(T,{variant:"outline",className:"text-xs bg-blue-100 text-blue-700 border-blue-300",children:"Next Event"})]}),o.jsx(T,{className:"text-xs font-normal px-1.5 py-0.5 "+("done"===e.status?"bg-green-100 text-green-800 hover:bg-green-200":"canceled"===e.status?"bg-red-100 text-red-800 hover:bg-red-200":"bg-monza-yellow/20 text-monza-black hover:bg-monza-yellow/30"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-1 text-xs",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(u,{className:"h-3 w-3 text-muted-foreground mr-1"}),o.jsx("span",{children:K(e.date,"h:mm a")})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"text-muted-foreground mr-1",children:"Assigned:"}),o.jsx("span",{className:"font-medium",children:e.assignedTo})]}),e.carCode&&o.jsx("div",{className:"flex items-center justify-start sm:justify-end",children:o.jsx(T,{variant:"outline",className:"font-normal text-xs h-5",children:e.carCode})})]})]})},e.id))}):o.jsx("div",{className:"flex items-center justify-center py-10 text-muted-foreground bg-gray-50 rounded-md",children:o.jsxs("div",{className:"text-center",children:[o.jsx(u,{className:"mx-auto h-6 w-6 text-muted-foreground/60 mb-1"}),o.jsx("p",{className:"text-sm",children:"No events scheduled for this date."})]})})]})})]}),o.jsx(J,{open:l,onOpenChange:r,onEventAdded:e=>{t(s=>[...s,e])}})]})};export{Q as default};
