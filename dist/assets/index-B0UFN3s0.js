import{j as e,k as s,S as a,I as t,n as r,P as i,b as n,o as l,V as c,ap as d,ac as o,e as m,t as x}from"./index-BmUpYGrm.js";import{r as h}from"./vendor-vN6PtkFd.js";import{T as j,f as u,a as p,b as f,c as g,d as N,e as v}from"./table-BEISn_Te.js";import{D as w}from"./download-CLPHGjzE.js";import{P as y}from"./phone-CUmdYfuI.js";import{f as _}from"./utils-DhcIvS4g.js";import"./charts-XrXYWaKo.js";const b=()=>{const[b,C]=h.useState([]),[L,S]=h.useState(!1),[D,P]=h.useState("");h.useEffect(()=>{k()},[]);const k=()=>{return e=void 0,s=null,a=function*(){try{S(!0),C([])}catch(e){C([])}finally{S(!1)}},new Promise((t,r)=>{var i=e=>{try{l(a.next(e))}catch(s){r(s)}},n=e=>{try{l(a.throw(e))}catch(s){r(s)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,n);l((a=a.apply(e,s)).next())});var e,s,a},E=b.filter(e=>{if(!D)return!0;const s=D.toLowerCase();return e.part_name.toLowerCase().includes(s)||e.part_number.toLowerCase().includes(s)||e.car_vin.toLowerCase().includes(s)||e.client_name.toLowerCase().includes(s)||e.technician.toLowerCase().includes(s)||e.car_model&&e.car_model.toLowerCase().includes(s)||e.repair_type&&e.repair_type.toLowerCase().includes(s)}),T=e=>{if(!e)return"N/A";try{return _(new Date(e),"MMM d, yyyy")}catch(s){return e}},A=s=>{if(!s)return e.jsx(m,{variant:"outline",children:"N/A"});const a={garage:"bg-blue-100 text-blue-800",showroom:"bg-green-100 text-green-800","floor 1":"bg-purple-100 text-purple-800","floor 2":"bg-orange-100 text-orange-800"}[s.toLowerCase()]||"bg-gray-100 text-gray-800";return e.jsx(m,{variant:"outline",className:a,children:s})};return e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Parts Usage History"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Complete tracking of parts usage with client and car details"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(s,{variant:"outline",onClick:()=>{x({title:"Export Feature",description:"Excel export functionality will be implemented soon."})},children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Export to Excel"]})})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(a,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(t,{placeholder:"Search parts, VIN, client, technician...",className:"pl-9",value:D,onChange:e=>P(e.target.value)})]})}),e.jsx("div",{className:"bg-white rounded-lg border shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(j,{children:[e.jsx(u,{children:E.length>0?`Showing ${E.length} parts usage records`:"No parts usage records found. Add sample data to see how it works."}),e.jsx(p,{children:e.jsxs(f,{children:[e.jsx(g,{className:"min-w-[140px]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{className:"h-4 w-4"}),"Usage Date & Time"]})}),e.jsx(g,{className:"min-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(i,{className:"h-4 w-4"}),"Part Details"]})}),e.jsx(g,{children:"Quantity Used"}),e.jsx(g,{className:"min-w-[180px]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{className:"h-4 w-4"}),"Car Information"]})}),e.jsx(g,{className:"min-w-[150px]",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-4 w-4"}),"Client Details"]})}),e.jsx(g,{children:"Technician"}),e.jsx(g,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{className:"h-4 w-4"}),"Location"]})}),e.jsx(g,{children:"Cost Information"}),e.jsx(g,{children:"Arrival Date"})]})}),e.jsx(N,{children:L?e.jsx(f,{children:e.jsx(v,{colSpan:9,className:"text-center py-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(d,{className:"h-6 w-6 text-muted-foreground mr-2 animate-spin"}),"Loading parts usage history..."]})})}):E.length>0?E.map(s=>e.jsxs(f,{children:[e.jsx(v,{children:e.jsx("div",{className:"text-sm font-medium",children:o.formatDateTime(s.usage_date)})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:s.part_name}),e.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:s.part_number}),s.repair_type&&e.jsx(m,{variant:"outline",className:"text-xs",children:s.repair_type})]})}),e.jsx(v,{children:e.jsx(m,{variant:"secondary",className:"font-semibold",children:s.quantity})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(n,{className:"h-3 w-3"}),e.jsx("span",{className:"font-mono text-xs",children:s.car_vin})]}),s.car_model&&e.jsx("div",{className:"text-sm text-muted-foreground",children:s.car_model}),s.client_license_plate&&e.jsx(m,{variant:"outline",className:"text-xs",children:s.client_license_plate})]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:s.client_name}),s.client_phone&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[e.jsx(y,{className:"h-3 w-3"}),e.jsx("span",{children:s.client_phone})]})]})}),e.jsx(v,{children:e.jsx(m,{variant:"outline",children:s.technician})}),e.jsx(v,{children:A(s.location_used)}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-1",children:[s.cost_per_unit&&e.jsxs("div",{className:"text-sm",children:["$",s.cost_per_unit.toFixed(2),"/unit"]}),s.total_cost&&e.jsxs("div",{className:"font-medium text-green-600",children:["$",s.total_cost.toFixed(2)]})]})}),e.jsx(v,{children:e.jsx("div",{className:"text-sm text-muted-foreground",children:T(s.arrival_date)})})]},s.id)):e.jsx(f,{children:e.jsx(v,{colSpan:9,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(d,{className:"h-12 w-12 text-muted-foreground"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium text-lg",children:"No Parts Usage History Found"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-md",children:"This table will show detailed records of parts usage including usage date & time, part details, quantities, car information, client details, technician info, location, cost information, and arrival dates."})]})]})})})})]})})}),E.length>0&&e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",E.length," of ",b.length," records"]})]})};export{b as default};
