var e=(e,t,n)=>new Promise((r,a)=>{var o=e=>{try{i(n.next(e))}catch(t){a(t)}},c=e=>{try{i(n.throw(e))}catch(t){a(t)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,c);i((n=n.apply(e,t)).next())});import{s as t}from"./index-dUlNy-FG.js";import{e as n}from"./enhancedMonzaBotService-CP3UVEVb.js";const r=n=>e(void 0,null,function*(){try{const e=yield t.createWorker("eng",1,{logger:e=>{}});yield e.setParameters({tessedit_char_whitelist:"ABCDEFGHJKLMNPQRSTUVWXYZ0123456789",tessedit_pageseg_mode:"6",tessedit_ocr_engine_mode:"1"});const{data:{text:r}}=yield e.recognize(n);yield e.terminate();const o=r.replace(/[^A-HJ-NPR-Z0-9]/g,""),c=/[A-HJ-NPR-Z0-9]{17}/g,i=o.match(c);return i&&i.length>0?i[0]:o.length>=10?o:yield a(n)}catch(e){try{return yield a(n)}catch(r){throw new Error("Failed to extract text from image using both local and AI OCR")}}}),a=t=>e(void 0,null,function*(){try{const e=yield n.processEnhancedMessage("Extract and return ONLY the VIN number from this image. The VIN should be exactly 17 characters long and contain only letters A-Z (excluding I, O, Q) and numbers 0-9. Return only the VIN number, nothing else. If you cannot find a complete 17-character VIN, return any vehicle identification numbers you can see.",{source:"vin_extraction",imageData:t,currentRoute:"/scan-vin"});return e.textResponse.replace(/[^A-HJ-NPR-Z0-9]/g,"").substring(0,17)}catch(e){throw new Error("Failed to extract text from image using AI OCR")}});export{r as e};
