var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,t=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,d=(e,s)=>{for(var a in s||(s={}))l.call(s,a)&&t(e,a,s[a]);if(r)for(var a of r(s))n.call(s,a)&&t(e,a,s[a]);return e},i=(e,r)=>s(e,a(r)),c=(e,s,a)=>new Promise((r,l)=>{var n=e=>{try{d(a.next(e))}catch(s){l(s)}},t=e=>{try{d(a.throw(e))}catch(s){l(s)}},d=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,t);d((a=a.apply(e,s)).next())});import{K as o,j as h,U as m,y as x,as as j,k as p,z as u,E as g,F as y,a9 as v,L as N,I as C,Y as b,Z as f,_ as w,$ as E,a0 as P,H as F,C as R,g as k,h as A,R as O,a as S,V as U}from"./index-BmUpYGrm.js";import{r as _}from"./vendor-vN6PtkFd.js";import{u as M}from"./userAPI-BDd2QYRO.js";import{u as D}from"./index-DNyRc51V.js";import{M as H}from"./mail-BiNlmlXL.js";import{P as V}from"./phone-CUmdYfuI.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";const z=()=>{var e;const{user:s}=o(),[a,r]=_.useState([]),[l,n]=_.useState(!0),[t,z]=_.useState(!1),[G,I]=_.useState(!1),[L,$]=_.useState(null),[K,T]=_.useState({name:"",email:"",password:"",role:"assistant",phoneNumber:"",department:"",emergencyContactName:"",emergencyContactPhone:"",address:"",notes:""});_.useEffect(()=>{W()},[]);const W=()=>c(void 0,null,function*(){try{n(!0);const e=yield M.getAll();r(e)}catch(e){D.error("Failed to load users")}finally{n(!1)}}),Y=()=>{T({name:"",email:"",password:"",role:"assistant",phoneNumber:"",department:"",emergencyContactName:"",emergencyContactPhone:"",address:"",notes:""})};return"OWNER"!==(null==(e=null==s?void 0:s.role)?void 0:e.toUpperCase())?h.jsx("div",{className:"p-6",children:h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),h.jsx("p",{className:"text-gray-600",children:"Only owners can access user management."})]})}):h.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[h.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[h.jsx(m,{className:"h-6 w-6"}),"User Management"]}),h.jsx("p",{className:"text-gray-600 mt-1",children:"Manage system users and their permissions"})]}),h.jsxs(x,{open:t,onOpenChange:z,children:[h.jsx(j,{asChild:!0,children:h.jsx(p,{onClick:Y,children:"Add User"})}),h.jsxs(u,{className:"max-w-2xl",children:[h.jsxs(g,{children:[h.jsx(y,{children:"Create New User"}),h.jsx(v,{children:"Add a new user to the system with specific role and permissions."})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"name",children:"Name"}),h.jsx(C,{id:"name",value:K.name,onChange:e=>T(i(d({},K),{name:e.target.value})),placeholder:"Enter full name"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"email",children:"Email"}),h.jsx(C,{id:"email",type:"email",value:K.email,onChange:e=>T(i(d({},K),{email:e.target.value})),placeholder:"Enter email address"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"password",children:"Password"}),h.jsx(C,{id:"password",type:"password",value:K.password,onChange:e=>T(i(d({},K),{password:e.target.value})),placeholder:"Enter password"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"role",children:"Role"}),h.jsxs(b,{value:K.role,onValueChange:e=>T(i(d({},K),{role:e})),children:[h.jsx(f,{id:"role",children:h.jsx(w,{})}),h.jsxs(E,{children:[h.jsx(P,{value:"owner",children:"Owner"}),h.jsx(P,{value:"garage_manager",children:"Garage Manager"}),h.jsx(P,{value:"assistant",children:"Assistant"}),h.jsx(P,{value:"sales",children:"Sales"})]})]})]}),"sales"===K.role&&h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"hybridRole",children:"Hybrid Role"}),h.jsxs(b,{value:K.hybridRole||"",onValueChange:e=>T(i(d({},K),{hybridRole:e||void 0})),children:[h.jsx(f,{id:"hybridRole",children:h.jsx(w,{placeholder:"Select hybrid role"})}),h.jsxs(E,{children:[h.jsx(P,{value:"sales_garage_marketing",children:"Sales + Garage + Marketing"}),h.jsx(P,{value:"sales_assistant_marketing",children:"Sales + Assistant + Marketing"})]})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"phone",children:"Phone Number"}),h.jsx(C,{id:"phone",value:K.phoneNumber,onChange:e=>T(i(d({},K),{phoneNumber:e.target.value})),placeholder:"Enter phone number"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"department",children:"Department"}),h.jsx(C,{id:"department",value:K.department,onChange:e=>T(i(d({},K),{department:e.target.value})),placeholder:"Enter department"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"emergencyName",children:"Emergency Contact Name"}),h.jsx(C,{id:"emergencyName",value:K.emergencyContactName,onChange:e=>T(i(d({},K),{emergencyContactName:e.target.value})),placeholder:"Emergency contact name"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"emergencyPhone",children:"Emergency Contact Phone"}),h.jsx(C,{id:"emergencyPhone",value:K.emergencyContactPhone,onChange:e=>T(i(d({},K),{emergencyContactPhone:e.target.value})),placeholder:"Emergency contact phone"})]}),h.jsxs("div",{className:"col-span-2 space-y-2",children:[h.jsx(N,{htmlFor:"address",children:"Address"}),h.jsx(C,{id:"address",value:K.address,onChange:e=>T(i(d({},K),{address:e.target.value})),placeholder:"Enter address"})]}),h.jsxs("div",{className:"col-span-2 space-y-2",children:[h.jsx(N,{htmlFor:"notes",children:"Notes"}),h.jsx(F,{id:"notes",value:K.notes,onChange:e=>T(i(d({},K),{notes:e.target.value})),placeholder:"Additional notes...",rows:3})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[h.jsx(p,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),h.jsx(p,{onClick:()=>c(void 0,null,function*(){try{yield M.create(K),D.success("User created successfully"),z(!1),Y(),W()}catch(e){D.error("Failed to create user")}}),children:"Create User"})]})]})]})]}),l?h.jsx("div",{className:"text-center",children:"Loading users..."}):h.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:a.map(e=>h.jsxs(R,{className:"hover:shadow-md transition-shadow",children:[h.jsxs(k,{children:[h.jsxs(A,{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-sm font-medium text-white",children:e.name.charAt(0)})}),e.name]}),h.jsxs(O,{className:"capitalize",children:[e.role," ",e.hybridRole&&`â€¢ ${e.hybridRole.replace(/_/g," ")}`]})]}),h.jsxs(S,{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[h.jsx(H,{className:"h-4 w-4 text-gray-400"}),h.jsx("span",{className:"text-gray-600",children:e.email})]}),e.phoneNumber&&h.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[h.jsx(V,{className:"h-4 w-4 text-gray-400"}),h.jsx("span",{className:"text-gray-600",children:e.phoneNumber})]}),e.address&&h.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[h.jsx(U,{className:"h-4 w-4 text-gray-400"}),h.jsx("span",{className:"text-gray-600",children:e.address})]}),h.jsxs("div",{className:"pt-3 border-t border-gray-200 flex justify-end gap-2",children:[h.jsx(p,{variant:"outline",size:"sm",onClick:()=>{return $(s=e),T({name:s.name,email:s.email,password:"",role:s.role,hybridRole:s.hybridRole,phoneNumber:s.phoneNumber||"",department:s.department||"",emergencyContactName:s.emergencyContactName||"",emergencyContactPhone:s.emergencyContactPhone||"",address:s.address||"",notes:s.notes||""}),void I(!0);var s},children:"Edit"}),h.jsx(p,{variant:"outline",size:"sm",onClick:()=>{return s=e.id,c(void 0,null,function*(){if(confirm("Are you sure you want to delete this user?"))try{yield M.delete(s),D.success("User deleted successfully"),W()}catch(e){D.error("Failed to delete user")}});var s},className:"text-red-600 hover:text-red-700",children:"Delete"})]})]})]},e.id))}),h.jsx(x,{open:G,onOpenChange:I,children:h.jsxs(u,{className:"max-w-2xl",children:[h.jsxs(g,{children:[h.jsx(y,{children:"Edit User"}),h.jsx(v,{children:"Update user information and permissions."})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editName",children:"Name"}),h.jsx(C,{id:"editName",value:K.name,onChange:e=>T(i(d({},K),{name:e.target.value})),placeholder:"Enter full name"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editEmail",children:"Email"}),h.jsx(C,{id:"editEmail",type:"email",value:K.email,onChange:e=>T(i(d({},K),{email:e.target.value})),placeholder:"Enter email address"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editPassword",children:"New Password (optional)"}),h.jsx(C,{id:"editPassword",type:"password",value:K.password,onChange:e=>T(i(d({},K),{password:e.target.value})),placeholder:"Leave empty to keep current password"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editRole",children:"Role"}),h.jsxs(b,{value:K.role,onValueChange:e=>T(i(d({},K),{role:e})),children:[h.jsx(f,{id:"editRole",children:h.jsx(w,{})}),h.jsxs(E,{children:[h.jsx(P,{value:"owner",children:"Owner"}),h.jsx(P,{value:"garage_manager",children:"Garage Manager"}),h.jsx(P,{value:"assistant",children:"Assistant"}),h.jsx(P,{value:"sales",children:"Sales"})]})]})]}),"sales"===K.role&&h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editHybridRole",children:"Hybrid Role"}),h.jsxs(b,{value:K.hybridRole||"",onValueChange:e=>T(i(d({},K),{hybridRole:e||void 0})),children:[h.jsx(f,{id:"editHybridRole",children:h.jsx(w,{placeholder:"Select hybrid role"})}),h.jsxs(E,{children:[h.jsx(P,{value:"sales_garage_marketing",children:"Sales + Garage + Marketing"}),h.jsx(P,{value:"sales_assistant_marketing",children:"Sales + Assistant + Marketing"})]})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editPhone",children:"Phone Number"}),h.jsx(C,{id:"editPhone",value:K.phoneNumber,onChange:e=>T(i(d({},K),{phoneNumber:e.target.value})),placeholder:"Enter phone number"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editDepartment",children:"Department"}),h.jsx(C,{id:"editDepartment",value:K.department,onChange:e=>T(i(d({},K),{department:e.target.value})),placeholder:"Enter department"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editEmergencyName",children:"Emergency Contact Name"}),h.jsx(C,{id:"editEmergencyName",value:K.emergencyContactName,onChange:e=>T(i(d({},K),{emergencyContactName:e.target.value})),placeholder:"Emergency contact name"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(N,{htmlFor:"editEmergencyPhone",children:"Emergency Contact Phone"}),h.jsx(C,{id:"editEmergencyPhone",value:K.emergencyContactPhone,onChange:e=>T(i(d({},K),{emergencyContactPhone:e.target.value})),placeholder:"Emergency contact phone"})]}),h.jsxs("div",{className:"col-span-2 space-y-2",children:[h.jsx(N,{htmlFor:"editAddress",children:"Address"}),h.jsx(C,{id:"editAddress",value:K.address,onChange:e=>T(i(d({},K),{address:e.target.value})),placeholder:"Enter address"})]}),h.jsxs("div",{className:"col-span-2 space-y-2",children:[h.jsx(N,{htmlFor:"editNotes",children:"Notes"}),h.jsx(F,{id:"editNotes",value:K.notes,onChange:e=>T(i(d({},K),{notes:e.target.value})),placeholder:"Additional notes...",rows:3})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[h.jsx(p,{variant:"outline",onClick:()=>I(!1),children:"Cancel"}),h.jsx(p,{onClick:()=>c(void 0,null,function*(){if(L)try{yield M.update(L.id,K),D.success("User updated successfully"),I(!1),Y(),$(null),W()}catch(e){D.error("Failed to update user")}}),children:"Update User"})]})]})})]})};export{z as default};
