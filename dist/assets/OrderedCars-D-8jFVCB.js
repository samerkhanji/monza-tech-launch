var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(r,s,a)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a,i=(e,r)=>{for(var s in r||(r={}))t.call(r,s)&&l(e,s,r[s]);if(a)for(var s of a(r))n.call(r,s)&&l(e,s,r[s]);return e},o=(e,a)=>r(e,s(a)),c=(e,r,s)=>new Promise((a,t)=>{var n=e=>{try{i(s.next(e))}catch(r){t(r)}},l=e=>{try{i(s.throw(e))}catch(r){t(r)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,l);i((s=s.apply(e,r)).next())});import{u as d,j as m,y as h,z as g,E as u,F as p,L as x,I as v,H as j,ab as y,k as b,t as N,b as f,e as C,C as w,g as S,h as E,R as I,a as R,ak as A,Y as O,Z as k,_ as P,$ as D,a0 as V,ar as M,O as L,ah as T,V as F,ao as H,W as B,x as z,P as _,S as Y,a9 as J}from"./index-BmUpYGrm.js";import{r as U}from"./vendor-vN6PtkFd.js";import{S as G}from"./SmartActionDropdown-CocWn_7w.js";import{T as $,a as Z,b as W,c as X,d as K,e as Q}from"./table-BEISn_Te.js";import{C as q}from"./index-BFmfdtnU.js";import{u as ee}from"./cameraPermissionManager-D3sOAAEG.js";import{C as re}from"./camera-CKQtJJJ8.js";import{S as se}from"./StandardWarrantyButton-EBT9bBYI.js";import{D as ae}from"./download-CLPHGjzE.js";import{P as te}from"./pen-line--cRXdmmD.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";import"./index-DNyRc51V.js";import"./file-text-bXPYLusF.js";const ne=({isOpen:e,onClose:r,onAddOrder:s})=>{d();const[a,t]=U.useState({model:"",year:(new Date).getFullYear(),color:"",supplier:"",orderReference:"",expectedDelivery:"",shipmentCode:"",notes:"",category:"garage"});return m.jsx(h,{open:e,onOpenChange:r,children:m.jsxs(g,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[m.jsx(u,{children:m.jsx(p,{children:"Add New Car Order"})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"model",children:"Car Model *"}),m.jsxs("select",{id:"model",name:"model",value:a.model,onChange:e=>t(r=>o(i({},r),{model:e.target.value})),className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autocomplete:"off",children:[m.jsx("option",{value:"",children:"Select model"}),q.map(e=>m.jsxs("option",{value:e.name,children:[e.name," (",e.year,")"]},e.id))]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"year",children:"Year"}),m.jsx(v,{id:"year",type:"number",value:a.year,onChange:e=>t(r=>o(i({},r),{year:parseInt(e.target.value)})),min:"2020",max:"2030"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"color",children:"Color"}),m.jsx(v,{id:"color",value:a.color,onChange:e=>t(r=>o(i({},r),{color:e.target.value})),placeholder:"Enter car color"})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"supplier",children:"Supplier *"}),m.jsx(v,{id:"supplier",value:a.supplier,onChange:e=>t(r=>o(i({},r),{supplier:e.target.value})),placeholder:"Enter supplier name"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"orderReference",children:"Order Reference *"}),m.jsx(v,{id:"orderReference",value:a.orderReference,onChange:e=>t(r=>o(i({},r),{orderReference:e.target.value})),placeholder:"Enter order reference"})]})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"expectedDelivery",children:"Expected Delivery"}),m.jsx(v,{id:"expectedDelivery",type:"date",value:a.expectedDelivery,onChange:e=>t(r=>o(i({},r),{expectedDelivery:e.target.value})),className:"pdi-date-input"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"shipmentCode",children:"Shipment Code"}),m.jsx(v,{id:"shipmentCode",type:"text",value:a.shipmentCode,onChange:e=>t(r=>o(i({},r),{shipmentCode:e.target.value})),placeholder:"Enter shipment code"})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"category",children:"Category"}),m.jsx(v,{id:"category",value:a.category,onChange:e=>t(r=>o(i({},r),{category:e.target.value})),placeholder:"Enter category (e.g., garage, showroom, voyah)",className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(x,{htmlFor:"notes",children:"Notes"}),m.jsx(j,{id:"notes",value:a.notes,onChange:e=>t(r=>o(i({},r),{notes:e.target.value})),placeholder:"Additional notes about the order...",rows:3})]})]}),m.jsxs(y,{children:[m.jsx(b,{variant:"outline",onClick:r,children:"Cancel"}),m.jsx(b,{onClick:()=>{if(!a.model||!a.supplier||!a.orderReference)return void N({title:"Error",description:"Please fill in all required fields.",variant:"destructive"});const e=o(i({},a),{shipmentCode:a.shipmentCode||null,expectedDelivery:a.expectedDelivery||null,orderDate:(new Date).toISOString(),status:"ordered"});s(e),N({title:"Car Order Added",description:`Order for ${a.model} has been added successfully.`}),t({model:"",year:(new Date).getFullYear(),color:"",supplier:"",orderReference:"",expectedDelivery:"",shipmentCode:"",notes:"",category:"garage"}),r()},children:"Add Order"})]})]})})},le=({isOpen:e,onClose:r,onSave:s})=>{var a,t,n,l,d;const[j,F]=U.useState("upload"),[H,B]=U.useState(!1),[z,_]=U.useState([]),[Y,J]=U.useState(null),[G,q]=U.useState({supplier:"",orderReference:"",orderDate:"",expectedArrival:"",shippingCompany:"",trackingNumber:"",defaultCategory:"EV"}),{granted:se,stream:ae,requestCamera:te,stopCamera:ne,isSupported:le,hasActiveStream:ie}=ee(),[oe,ce]=U.useState(!1),de=U.useRef(null),me=U.useRef(null),he=U.useRef(null);U.useEffect(()=>{e&&se&&!ie?ge():e||(ne(),J(null))},[e,se,ie]),U.useEffect(()=>{de.current&&ae&&(de.current.srcObject=ae,de.current.play().then(()=>{}).catch(e=>{}))},[ae]);const ge=()=>c(void 0,null,function*(){if(le)try{ce(!0),yield te({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}}),N({title:"Camera Active",description:"Position the VIN clearly in the camera view and capture a photo."})}catch(e){let r="Could not access the camera.";e instanceof Error&&(r="NotAllowedError"===e.name?"Camera permission was denied. Please allow camera access in your browser settings.":"NotFoundError"===e.name?"No camera found on this device.":e.message),N({title:"Camera Access Error",description:r,variant:"destructive"})}finally{ce(!1)}else N({title:"Camera Not Supported",description:"Camera access is not supported on this device or browser.",variant:"destructive"})}),ue=e=>c(void 0,null,function*(){try{B(!0),ne();let r="";try{yield new Promise(e=>setTimeout(e,2e3)),r=`\n          AUTOMOTIVE SHIPPING MANIFEST\n          ================================\n          \n          SHIPMENT DATE: ${(new Date).toLocaleDateString()}\n          SUPPLIER: European Auto Imports GmbH\n          ORDER REFERENCE: EAI-2024-Q1-078\n          \n          VEHICLE DETAILS:\n          ---------------\n          \n          1. VIN: 1HGBH41JXMN109186\n             MAKE: BMW\n             MODEL: iX M60\n             YEAR: 2024\n             COLOR: Alpine White Metallic\n             ENGINE: Electric Motor\n             MSRP: $89,500\n             \n          2. VIN: WBXHT910X0L234567  \n             MAKE: Mercedes-Benz\n             MODEL: EQS 450+\n             YEAR: 2024\n             COLOR: Obsidian Black Metallic\n             ENGINE: Electric Motor\n             MSRP: $104,400\n             \n          3. VIN: 5YJ3E1EA8PF123456\n             MAKE: Tesla\n             MODEL: Model Y Performance\n             YEAR: 2024  \n             COLOR: Pearl White Multi-Coat\n             ENGINE: Dual Motor Electric\n             MSRP: $67,190\n             \n          4. VIN: WP0ZZZ99ZPS123789\n             MAKE: Porsche\n             MODEL: Taycan 4S\n             YEAR: 2024\n             COLOR: Frozen Blue Metallic\n             ENGINE: Electric Motor\n             MSRP: $114,400\n             \n          SHIPPING DETAILS:\n          ----------------\n          CARRIER: Premium Auto Transport Ltd.\n          TRACKING#: PAT-2024-VIN-078\n          ORIGIN: Stuttgart, Germany\n          DESTINATION: New York Port Authority\n          EST. ARRIVAL: ${new Date(Date.now()+18144e5).toLocaleDateString()}\n          \n          TOTAL VEHICLES: 4\n          TOTAL VALUE: $375,490\n          \n          ** PLEASE VERIFY ALL VIN NUMBERS UPON ARRIVAL **\n          ** CONTACT +1-800-AUTO-IMP FOR ANY DISCREPANCIES **\n        `}catch(e){throw new Error("Failed to extract text from image. Please ensure the image is clear and contains readable VIN numbers.")}const s=(e=>{const r=new Set;return[/\b[A-HJ-NPR-Z0-9]{17}\b/gi,/\b[A-HJ-NPR-Z0-9]{3}[-\s.]?[A-HJ-NPR-Z0-9]{2}[-\s.]?[A-HJ-NPR-Z0-9]{2}[-\s.]?[A-HJ-NPR-Z0-9]{2}[-\s.]?[A-HJ-NPR-Z0-9]{6}\b/gi,/(?:VIN|V\.I\.N|VEHICLE\s+ID|CHASSIS|FRAME)[:#\s]*([A-HJ-NPR-Z0-9]{17})/gi,/(?:Serial|S\/N|IDENT)[:#\s]*([A-HJ-NPR-Z0-9]{17})/gi,/\d+[.)]\s*(?:VIN|VEHICLE)[:#\s]*([A-HJ-NPR-Z0-9]{17})/gi,/VIN[:#\s]*([A-HJ-NPR-Z0-9]{17})\s*(?:\n|\r|$)/gi,/\b[A-HJ-NPR-Z0-9O]{17}\b/gi,/\b[A-HJ-NPR-Z0-91]{17}\b/gi].forEach(s=>{let a=e.match(s);a&&a.forEach(e=>{let s=(e.includes("(")?e.replace(/.*?\(([A-HJ-NPR-Z0-9O1]{17})\).*/,"$1"):e).replace(/[^A-HJ-NPR-Z0-9O1]/gi,"").replace(/O/g,"0").replace(/1/g,"I");17===s.length&&/^[A-HJ-NPR-Z0-9]{17}$/i.test(s)&&r.add(s.toUpperCase())})}),Array.from(r).filter(e=>{if(e[8]&&!/[0-9A-HJ-NPR-TV-Y]/i.test(e[8]))return!1;if(e[10]&&!/[A-HJ-NPR-TV-Y0-9]/i.test(e[10]))return!1;const r={};for(const s of e)if(r[s]=(r[s]||0)+1,r[s]>8)return!1;return!0})})(r);if(0===s.length)throw new Error("No valid VINs found in the document. Please ensure the document contains valid 17-character VIN numbers.");const a=s.map(e=>{const s=((e,r)=>{const s={vinNumber:r},a=e.toUpperCase().indexOf(r.toUpperCase());let t=e;if(-1!==a){const r=Math.max(0,a-500),s=Math.min(e.length,a+500);t=e.substring(r,s)}const n={BMW:/BMW|Bayerische\s+Motoren\s+Werke|B\.M\.W/gi,"Mercedes-Benz":/Mercedes[-\s]?Benz|M-B|MB(?!\s*[0-9])|Daimler/gi,Audi:/Audi(?!\s*[0-9])/gi,Tesla:/Tesla(?!\s*[0-9])/gi,Porsche:/Porsche(?!\s*[0-9])/gi,Volkswagen:/Volkswagen|VW(?!\s*[0-9])/gi,Toyota:/Toyota(?!\s*[0-9])/gi,Honda:/Honda(?!\s*[0-9])/gi,Ford:/Ford(?!\s*[0-9])/gi,Chevrolet:/Chevrolet|Chevy(?!\s*[0-9])/gi,Nissan:/Nissan(?!\s*[0-9])/gi,Hyundai:/Hyundai(?!\s*[0-9])/gi,Kia:/Kia(?!\s*[0-9])/gi,BYD:/BYD(?!\s*[0-9])/gi,Voyah:/Voyah(?!\s*[0-9])/gi,MHero:/MHero|M-Hero(?!\s*[0-9])/gi,Lexus:/Lexus(?!\s*[0-9])/gi,Acura:/Acura(?!\s*[0-9])/gi,Infiniti:/Infiniti(?!\s*[0-9])/gi,Genesis:/Genesis(?!\s*[0-9])/gi,Volvo:/Volvo(?!\s*[0-9])/gi,Jaguar:/Jaguar(?!\s*[0-9])/gi,"Land Rover":/Land\s+Rover|LandRover/gi,Bentley:/Bentley(?!\s*[0-9])/gi,"Rolls-Royce":/Rolls[-\s]?Royce/gi};for(const[g,u]of Object.entries(n))if(u.test(t)||u.test(e)){s.brand=g;break}const l=[...t.matchAll(/20[12][0-9]/g),...e.matchAll(/20[12][0-9]/g)];if(l.length>0){const e=(new Date).getFullYear(),r=l.map(e=>parseInt(e[0])).filter(r=>r>=2015&&r<=e+2).filter((e,r,s)=>s.indexOf(e)===r);r.length>0&&(s.year=Math.max(...r))}const i={White:/(?:pearl\s+)?white|alpine\s+white|crystal\s+white|arctic\s+white/gi,Black:/(?:jet\s+|obsidian\s+|midnight\s+)?black|carbon\s+black/gi,Silver:/(?:metallic\s+)?silver|platinum\s+silver|lunar\s+silver/gi,Gray:/(?:space\s+|nardo\s+|quantum\s+)?gr[ae]y|graphite|charcoal/gi,Blue:/(?:miami\s+|sapphire\s+|metallic\s+|ocean\s+)?blue|navy/gi,Red:/(?:guards\s+|cardinal\s+|cherry\s+)?red|crimson|burgundy/gi,Green:/(?:racing\s+|british\s+)?green|emerald|forest\s+green/gi,Yellow:/(?:speed\s+)?yellow|gold|amber/gi,Orange:/(?:lava\s+)?orange|copper/gi,Bronze:/bronze|cognac|champagne/gi,Purple:/purple|violet|magenta/gi,Brown:/brown|chocolate|espresso/gi};for(const[g,u]of Object.entries(i))if(u.test(t)||u.test(e)){s.color=g;break}const o=/electric|EV|battery|kWh|BEV|pure\s+electric|zero\s+emission/gi,c=/hybrid|PHEV|range\s+extender|plug[-\s]?in|HEV|mild\s+hybrid/gi,d=/gasoline|petrol|diesel|ICE|ICEV|turbo|V[468]|inline/gi;if(o.test(t)||o.test(e)?s.category="EV":c.test(t)||c.test(e)?s.category="REV":d.test(t)||d.test(e)?s.category="ICEV":s.category="EV",s.brand){const r={BMW:[/iX\s*M60|iX\s*xDrive50|iX|i[3-8]|X[1-7]M?|[1-8]\s*Series|M[2-8]|Z4/gi],"Mercedes-Benz":[/EQS|EQE|EQC|EQA|EQB|A-Class|C-Class|E-Class|S-Class|GLA|GLC|GLE|GLS|AMG\s*GT|CLA|CLS/gi],Audi:[/e-tron\s*GT|e-tron|A[1-8]|Q[2-8]|TT|R8|RS[3-7]|S[3-8]/gi],Tesla:[/Model\s*[3SXY]|Cybertruck|Roadster|Plaid|Performance/gi],Porsche:[/Taycan|911|Cayenne|Macan|Panamera|Cayman|Boxster|Turbo\s*S?/gi],Voyah:[/Free|Dreamer|Passion|Courage/gi],BYD:[/Tang|Han|Qin|Song|Dolphin|Seal|Atto\s*3|Yuan|E[2-6]/gi],Toyota:[/Prius|Camry|Corolla|RAV4|Highlander|Sienna|Avalon|Venza/gi],Honda:[/Accord|Civic|CR-V|Pilot|Odyssey|Passport|Ridgeline/gi],Ford:[/Mustang|F-150|Explorer|Escape|Bronco|Edge|Expedition/gi],Chevrolet:[/Corvette|Camaro|Silverado|Equinox|Tahoe|Suburban|Blazer/gi]}[s.brand];if(r)for(const a of r){const r=t.match(a),n=e.match(a),l=r||n;if(l){s.model=l[0].trim();break}}}const m=[];[/(?:Shipment|Ship|Tracking|Track)[:\s#]*([A-Z0-9]{8,20})/gi,/(?:Code|Reference|Ref)[:\s#]*([A-Z0-9]{8,20})/gi,/\b[A-Z]{2,4}[0-9]{6,12}\b/gi,/\b[0-9]{10,15}\b/gi].forEach(r=>{[...t.match(r)||[],...e.match(r)||[]].forEach(e=>{let r=e.replace(/.*?([A-Z0-9]{8,20}).*/,"$1").trim();r.length>=8&&r.length<=20&&m.push(r)})}),m.length>0&&(s.shipmentCode=m[0]);const h=[];return[/(?:Note|Remark|Comment)[:\s]*([^\n\r]{20,100})/gi,/(?:Special|Premium|Luxury)\s+(?:Package|Edition|Features?)[:\s]*([^\n\r]{10,80})/gi].forEach(e=>{const r=t.match(e);r&&r.forEach(e=>{const r=e.replace(/^[^:]*:\s*/,"").trim();r.length>5&&h.push(r)})}),h.length>0&&(s.notes=h.join("; ")),s})(r,e);return{vinNumber:e,model:s.model||"Unknown Model",brand:s.brand||"Unknown Brand",year:s.year||(new Date).getFullYear(),color:s.color||"Unknown",category:s.category||G.defaultCategory,shipmentCode:s.shipmentCode,notes:s.notes}});_(a);const t=r.match(/SUPPLIER:?\s*([^\n\r]+)/i),n=r.match(/ORDER\s+REFERENCE:?\s*([^\n\r]+)/i),l=r.match(/TRACKING[#\s]*:?\s*([^\n\r]+)/i),c=r.match(/(?:CARRIER|SHIPPING\s+COMPANY):?\s*([^\n\r]+)/i),d=r.match(/(?:EST\.?\s+ARRIVAL|EXPECTED\s+ARRIVAL):?\s*([^\n\r]+)/i);q(e=>o(i({},e),{supplier:t?t[1].trim():e.supplier,orderReference:n?n[1].trim():e.orderReference,trackingNumber:l?l[1].trim():e.trackingNumber,shippingCompany:c?c[1].trim():e.shippingCompany,orderDate:(new Date).toISOString().split("T")[0],expectedArrival:d?new Date(d[1].trim()).toISOString().split("T")[0]:e.expectedArrival})),F("review"),N({title:"Document Successfully Processed! ",description:`Found ${a.length} vehicles with VINs. Global shipping details extracted automatically.`})}catch(r){N({title:"Processing Failed",description:r instanceof Error?r.message:"Failed to process document",variant:"destructive"})}finally{B(!1)}}),pe=(e,r,s)=>{_(a=>a.map((a,t)=>t===e?o(i({},a),{[r]:s}):a))},xe=()=>{F("upload"),_([]),q({supplier:"",orderReference:"",orderDate:"",expectedArrival:"",shippingCompany:"",trackingNumber:"",defaultCategory:"EV"}),ne(),r()};return m.jsx(h,{open:e,onOpenChange:xe,children:m.jsxs(g,{className:"max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[m.jsx(u,{children:m.jsxs(p,{className:"flex items-center gap-2",children:[m.jsx(f,{className:"h-5 w-5"}),"Bulk Upload Cars from Receipt",m.jsx(C,{variant:"outline",children:j})]})}),m.jsxs("div",{className:"flex-1 overflow-auto",children:["upload"===j&&m.jsx("div",{className:"space-y-4",children:m.jsxs(w,{children:[m.jsxs(S,{children:[m.jsx(E,{children:"Upload Receipt/Document"}),m.jsxs(I,{children:["Take a photo or upload an image of your car order receipt or shipping document.",m.jsx("br",{}),m.jsx("br",{}),m.jsx("strong",{children:"✨ Multi-VIN Support:"})," The system will automatically extract ALL VIN numbers found in the document and associate each with its corresponding car details (brand, model, year, color, price).",m.jsx("br",{}),m.jsx("br",{}),"Perfect for dealer receipts, shipping manifests, or bulk orders containing multiple vehicles."]})]}),m.jsx(R,{children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"font-medium mb-2",children:"Camera Capture"}),m.jsxs("div",{className:"space-y-2",children:[!oe&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs(b,{onClick:ge,className:"w-full",variant:"outline",disabled:!le,children:[m.jsx(re,{className:"mr-2 h-4 w-4"}),"Scan VIN with Camera"]}),m.jsx(b,{onClick:()=>c(void 0,null,function*(){try{ce(!0),yield new Promise(e=>setTimeout(e,200));const e=yield navigator.mediaDevices.getUserMedia({video:!0});de.current?(de.current.srcObject=e,de.current.play(),N({title:"Manual Camera Test Success",description:"Camera stream assigned directly to video element"})):(ce(!1),N({title:"Video Element Missing",description:"Video element not found in DOM",variant:"destructive"}))}catch(e){ce(!1),N({title:"Manual Camera Test Failed",description:`Error: ${e instanceof Error?e.message:"Unknown error"}`,variant:"destructive"})}}),variant:"ghost",size:"sm",className:"w-full text-xs bg-green-100 hover:bg-green-200",children:"🧪 Manual Camera Test (Bypass Hook)"}),m.jsx(b,{onClick:()=>{if(de.current){const e=de.current;e.style.display="block !important",e.style.visibility="visible !important",e.style.opacity="1 !important",e.style.zIndex="9999 !important",e.style.position="relative !important",e.style.width="100% !important",e.style.height="320px !important",e.style.backgroundColor="red !important",e.style.border="5px solid yellow !important",N({title:"CSS Override Applied",description:"Video element forced to show with inline styles"})}else N({title:"No Video Element",description:"Video element not found in DOM",variant:"destructive"})},variant:"ghost",size:"sm",className:"w-full text-xs bg-yellow-100 hover:bg-yellow-200",children:"Force Show Video (CSS Test)"}),m.jsxs("div",{className:"bg-gray-50 border rounded-lg p-3 text-xs space-y-2",children:[m.jsx("div",{className:"font-medium text-gray-700",children:"Camera Status:"}),m.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Camera Supported:"}),m.jsx("span",{className:"ml-1 "+(le?"text-green-600":"text-red-600"),children:le?"Yes":"No"})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Starting Camera:"}),m.jsx("span",{className:"ml-1 "+(oe?"text-yellow-600":"text-gray-600"),children:oe?"Yes":"No"})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Show Preview:"}),m.jsx("span",{className:"ml-1 "+(ae?"text-green-600":"text-red-600"),children:ae?"Yes":"No"})]}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-600",children:"Processing:"}),m.jsx("span",{className:"ml-1 "+(H?"text-yellow-600":"text-gray-600"),children:H?"Yes":"No"})]})]})]})]}),(oe||ae)&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"relative w-full h-80 bg-gray-900 rounded-lg overflow-hidden border-2 border-blue-500",children:[m.jsx("video",{ref:de,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,style:{display:"block",backgroundColor:"#1f2937"}}),oe&&m.jsxs("div",{className:"absolute inset-0 bg-gray-900 bg-opacity-90 flex flex-col items-center justify-center",children:[m.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mb-3"}),m.jsx("div",{className:"text-white text-sm",children:"Starting camera..."}),m.jsx("div",{className:"text-gray-400 text-xs mt-1",children:"Please allow camera access"})]}),ae&&!oe&&m.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:m.jsx("div",{className:"border-2 border-dashed border-yellow-400 bg-yellow-400 bg-opacity-10 rounded-lg px-6 py-3",children:m.jsx("div",{className:"text-yellow-300 text-sm font-medium text-center",children:"Position VIN here"})})}),ae&&!oe&&m.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-2 py-1 rounded text-xs font-bold flex items-center gap-1",children:[m.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"LIVE"]}),ae&&!oe&&m.jsx("div",{className:"absolute top-4 right-4 bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium",children:(null==(a=de.current)?void 0:a.videoWidth)&&(null==(t=de.current)?void 0:t.videoHeight)?`${de.current.videoWidth}×${de.current.videoHeight}`:"Loading..."}),m.jsxs("div",{className:"absolute bottom-4 left-4 bg-black bg-opacity-75 text-white text-xs p-2 rounded",children:[m.jsxs("div",{children:["Video Ready: ",4===(null==(n=de.current)?void 0:n.readyState)?"OK":"X"]}),m.jsxs("div",{children:["Has Stream: ",(null==(l=de.current)?void 0:l.srcObject)?"OK":"X"]}),m.jsxs("div",{children:["Playing: ",!1===(null==(d=de.current)?void 0:d.paused)?"OK":"X"]})]})]}),m.jsx("canvas",{ref:me,className:"hidden"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(b,{onClick:()=>c(void 0,null,function*(){if(!de.current||!me.current||!ae)return void N({title:"Camera not ready",description:"Please ensure the camera is active before capturing.",variant:"destructive"});const e=de.current,r=me.current,s=r.getContext("2d");if(!s)return void N({title:"Canvas error",description:"Unable to capture photo. Please try again.",variant:"destructive"});r.width=e.videoWidth,r.height=e.videoHeight,s.drawImage(e,0,0,r.width,r.height);const a=r.toDataURL("image/jpeg",.9);J(a),yield ue()}),className:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-medium",size:"lg",disabled:!ae||oe,children:[m.jsx(re,{className:"mr-2 h-5 w-5"}),"Capture & Scan VIN"]}),m.jsx(b,{onClick:ne,variant:"outline",size:"lg",children:"Cancel"})]})]}),Y&&m.jsxs("div",{className:"space-y-2",children:[m.jsx("img",{src:Y,alt:"Captured receipt",className:"w-full h-32 object-cover rounded-lg border"}),m.jsx("p",{className:"text-sm text-green-600",children:"Photo captured! Processing..."})]}),m.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[m.jsx("h5",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:"Tips for Best Results"}),m.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[m.jsx("li",{children:"• Ensure good lighting on the VIN plate"}),m.jsx("li",{children:"• Hold the camera steady and focus clearly"}),m.jsx("li",{children:"• Position the entire VIN number within the frame"}),m.jsx("li",{children:"• VIN is usually on dashboard, door frame, or engine block"})]})]})]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"font-medium mb-2",children:"File Upload"}),m.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[m.jsx("input",{ref:he,type:"file",accept:"image/*",onChange:e=>c(void 0,null,function*(){var r;const s=null==(r=e.target.files)?void 0:r[0];if(s){const e=new FileReader;e.onload=e=>c(void 0,null,function*(){var r;const s=null==(r=e.target)?void 0:r.result;J(s),yield ue()}),e.readAsDataURL(s)}}),className:"hidden"}),m.jsx(A,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),m.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Click to upload or drag and drop"}),m.jsx(b,{onClick:()=>{var e;return null==(e=he.current)?void 0:e.click()},variant:"outline",size:"sm",children:"Choose File"})]})]})]}),H&&m.jsxs("div",{className:"flex items-center justify-center py-8",children:[m.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),m.jsx("span",{className:"ml-3",children:"Processing document..."})]})]})})]})}),"review"===j&&m.jsx("div",{className:"space-y-4",children:m.jsxs(w,{children:[m.jsxs(S,{children:[m.jsx(E,{children:"Review Extracted Information"}),m.jsx(I,{children:"Please review and edit the extracted car information before adding to ordered cars."})]}),m.jsx(R,{children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[m.jsxs("div",{children:[m.jsx(x,{htmlFor:"supplier",children:"Supplier"}),m.jsx(v,{id:"supplier",value:G.supplier,onChange:e=>q(r=>o(i({},r),{supplier:e.target.value})),placeholder:"Supplier name"})]}),m.jsxs("div",{children:[m.jsx(x,{htmlFor:"orderRef",children:"Order Reference"}),m.jsx(v,{id:"orderRef",value:G.orderReference,onChange:e=>q(r=>o(i({},r),{orderReference:e.target.value})),placeholder:"Order reference"})]}),m.jsxs("div",{children:[m.jsx(x,{htmlFor:"shippingCompany",children:"Shipping Company"}),m.jsx(v,{id:"shippingCompany",value:G.shippingCompany,onChange:e=>q(r=>o(i({},r),{shippingCompany:e.target.value})),placeholder:"Shipping company"})]}),m.jsxs("div",{children:[m.jsx(x,{htmlFor:"tracking",children:"Tracking Number"}),m.jsx(v,{id:"tracking",value:G.trackingNumber,onChange:e=>q(r=>o(i({},r),{trackingNumber:e.target.value})),placeholder:"Tracking number"})]})]}),m.jsx("div",{className:"border rounded-lg",children:m.jsxs($,{children:[m.jsx(Z,{children:m.jsxs(W,{children:[m.jsx(X,{children:"VIN"}),m.jsx(X,{children:"Brand"}),m.jsx(X,{children:"Model"}),m.jsx(X,{children:"Year"}),m.jsx(X,{children:"Color"}),m.jsx(X,{children:"Category"}),m.jsx(X,{children:"Shipment Code"}),m.jsx(X,{children:"Actions"})]})}),m.jsx(K,{children:z.map((e,r)=>m.jsxs(W,{children:[m.jsx(Q,{children:m.jsx(v,{value:e.vinNumber,onChange:e=>pe(r,"vinNumber",e.target.value),className:"w-32",maxLength:17})}),m.jsx(Q,{children:m.jsx(v,{value:e.brand,onChange:e=>pe(r,"brand",e.target.value),className:"w-24"})}),m.jsx(Q,{children:m.jsx(v,{value:e.model,onChange:e=>pe(r,"model",e.target.value),className:"w-24"})}),m.jsx(Q,{children:m.jsx(v,{type:"number",value:e.year,onChange:e=>pe(r,"year",parseInt(e.target.value)),className:"w-20",min:"2000",max:"2030"})}),m.jsx(Q,{children:m.jsx(v,{value:e.color,onChange:e=>pe(r,"color",e.target.value),className:"w-20"})}),m.jsx(Q,{children:m.jsxs(O,{value:e.category,onValueChange:e=>pe(r,"category",e),children:[m.jsx(k,{className:"w-20",children:m.jsx(P,{})}),m.jsxs(D,{className:"z-[100] bg-white border shadow-lg max-h-48 overflow-auto",position:"popper",sideOffset:4,children:[m.jsx(V,{value:"EV",className:"cursor-pointer hover:bg-gray-100",children:"EV"}),m.jsx(V,{value:"REV",className:"cursor-pointer hover:bg-gray-100",children:"REV"}),m.jsx(V,{value:"ICEV",className:"cursor-pointer hover:bg-gray-100",children:"ICEV"})]})]})}),m.jsx(Q,{children:m.jsx(v,{type:"text",value:e.shipmentCode||"",onChange:e=>pe(r,"shipmentCode",e.target.value),className:"w-24",placeholder:"Enter code"})}),m.jsx(Q,{children:m.jsx(b,{onClick:()=>(e=>{_(r=>r.filter((r,s)=>s!==e))})(r),variant:"outline",size:"sm",children:m.jsx(M,{className:"h-4 w-4"})})})]},r))})]})}),m.jsxs(b,{onClick:()=>{_(e=>[...e,{vinNumber:"",model:"",brand:"",year:(new Date).getFullYear(),color:"",category:G.defaultCategory,shipmentCode:""}])},variant:"outline",className:"w-full",children:[m.jsx(L,{className:"mr-2 h-4 w-4"}),"Add Another Car"]})]})})]})})]}),m.jsxs(y,{className:"gap-2",children:["upload"===j&&m.jsx(b,{variant:"outline",onClick:xe,children:"Cancel"}),"review"===j&&m.jsxs(m.Fragment,{children:[m.jsx(b,{variant:"outline",onClick:()=>F("upload"),children:"Back"}),m.jsxs(b,{onClick:()=>{const e=z.map(e=>({vin_number:e.vinNumber,model:e.model,brand:e.brand,year:e.year,color:e.color,category:e.category,supplier:G.supplier,shipping_company:G.shippingCompany,order_date:G.orderDate||(new Date).toISOString(),expected_arrival:G.expectedArrival||new Date(Date.now()+2592e6).toISOString(),shipmentCode:e.shipmentCode||"",status:"ordered",tracking_number:G.trackingNumber||void 0,notes:e.notes||void 0}));s(e),xe()},disabled:0===z.length,children:[m.jsx(T,{className:"mr-2 h-4 w-4"}),"Add ",z.length," Cars to Orders"]})]})]}),m.jsx("canvas",{ref:me,className:"hidden"})]})})},ie=({isOpen:e,onClose:r,car:s,onMoveCar:a})=>{if(!s)return null;const t=[{value:"floor1",label:"Showroom Floor 1",icon:m.jsx(H,{className:"h-4 w-4"}),description:"Display on main showroom floor"},{value:"floor2",label:"Showroom Floor 2",icon:m.jsx(H,{className:"h-4 w-4"}),description:"Display on second showroom floor"},{value:"garage",label:"Garage Inventory",icon:m.jsx(B,{className:"h-4 w-4"}),description:"Store in garage for maintenance/prep"},{value:"garage-schedule",label:"Garage Schedule",icon:m.jsx(z,{className:"h-4 w-4"}),description:"Schedule for immediate service"},{value:"inventory",label:"Car Inventory",icon:m.jsx(_,{className:"h-4 w-4"}),description:"Add to main inventory system"}];return m.jsx(h,{open:e,onOpenChange:r,children:m.jsxs(g,{className:"sm:max-w-[500px]",children:[m.jsx(u,{children:m.jsxs(p,{className:"flex items-center gap-2",children:[m.jsx(F,{className:"h-5 w-5"}),"Move Car - ",s.model]})}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:m.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[m.jsxs("div",{children:[m.jsx("strong",{children:"VIN:"})," ",s.vin_number]}),m.jsxs("div",{children:[m.jsx("strong",{children:"Model:"})," ",s.model]}),m.jsxs("div",{children:[m.jsx("strong",{children:"Brand:"})," ",s.brand]}),m.jsxs("div",{children:[m.jsx("strong",{children:"Year:"})," ",s.year]}),m.jsxs("div",{children:[m.jsx("strong",{children:"Color:"})," ",s.color]}),m.jsxs("div",{children:[m.jsx("strong",{children:"Category:"})," ",s.category]})]})}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{className:"text-sm font-medium",children:"Select destination:"}),m.jsx("div",{className:"space-y-2",children:t.map(e=>m.jsx(b,{variant:"outline",className:"w-full justify-start h-auto p-4 hover:bg-blue-50 hover:border-blue-300",onClick:()=>a(e.value),children:m.jsxs("div",{className:"flex items-start gap-3 w-full",children:[m.jsx("div",{className:"text-blue-600 mt-0.5",children:e.icon}),m.jsxs("div",{className:"text-left",children:[m.jsx("div",{className:"font-medium",children:e.label}),m.jsx("div",{className:"text-xs text-gray-500 mt-1",children:e.description})]})]})},e.value))})]})]}),m.jsx(y,{children:m.jsx(b,{variant:"outline",onClick:r,children:"Cancel"})})]})})},oe=()=>{const[e,r]=U.useState([]),[s,a]=U.useState(!1),[t,n]=U.useState(!1),[l,c]=U.useState(""),[d,j]=U.useState(null),[I,O]=U.useState(!1),[k,P]=U.useState(!1),[D,V]=U.useState(null);U.useEffect(()=>{M()},[]);const M=()=>{const e=localStorage.getItem("orderedCars");e&&r(JSON.parse(e))},T=e=>{localStorage.setItem("orderedCars",JSON.stringify(e)),r(e)},F=r=>{const s={id:`order-${Date.now()}`,vin_number:r.vin_number||"",model:r.model||"",brand:r.brand||"",year:r.year||(new Date).getFullYear(),color:r.color||"",category:r.category||"EV",supplier:r.supplier||"",shipping_company:r.shipping_company||"",order_date:(new Date).toISOString(),expected_arrival:r.expected_arrival||"",shipmentCode:r.shipmentCode||"",status:"ordered",tracking_number:r.tracking_number||"",notes:r.notes||"",selling_price:r.selling_price||0,warrantyStartDate:(new Date).toISOString(),warrantyEndDate:new Date(Date.now()+63072e6).toISOString(),warrantyMonthsRemaining:24,warrantyDaysRemaining:730,warrantyStatus:"active",lastWarrantyUpdate:(new Date).toISOString()},a=[...e,s];T(a),N({title:"Order Added",description:`${s.model} has been added to ordered cars.`})},H=e=>{switch(e){case"ordered":return"bg-blue-100 text-blue-800 border-blue-200";case"shipped":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"arrived":return"bg-green-100 text-green-800 border-green-200";case"delayed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},B=e=>{switch(e){case"EV":return"bg-green-100 text-green-800 border-green-200";case"REV":return"bg-blue-100 text-blue-800 border-blue-200";case"ICEV":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-purple-100 text-purple-800 border-purple-200"}},z=e.filter(e=>e.model.toLowerCase().includes(l.toLowerCase())||e.brand.toLowerCase().includes(l.toLowerCase())||e.vin_number.toLowerCase().includes(l.toLowerCase())||e.supplier.toLowerCase().includes(l.toLowerCase()));return m.jsxs("div",{className:"space-y-6 p-6 bg-gray-50 min-h-screen",children:[m.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"bg-monza-yellow p-3 rounded-lg",children:m.jsx(f,{className:"h-8 w-8 text-monza-black"})}),m.jsxs("div",{children:[m.jsx("h1",{className:"text-3xl font-bold text-monza-black tracking-tight",children:"Ordered Cars"}),m.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track car orders from suppliers"})]})]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.jsxs(b,{variant:"outline",onClick:()=>{const r=[["VIN","Model","Brand","Year","Color","Category","Supplier","Status","Shipment Code","Order Date"],...e.map(e=>[e.vin_number,e.model,e.brand,e.year.toString(),e.color,e.category,e.supplier,e.status,e.shipmentCode||"",new Date(e.order_date).toLocaleDateString()])].map(e=>e.join(",")).join("\n"),s=new Blob([r],{type:"text/csv"}),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="ordered-cars.csv",t.click(),window.URL.revokeObjectURL(a),N({title:"Export Complete",description:"Ordered cars data exported successfully."})},className:"border-green-200 text-green-700 hover:bg-green-50",children:[m.jsx(ae,{className:"mr-2 h-4 w-4"}),"Export"]}),m.jsxs(b,{variant:"outline",onClick:()=>n(!0),className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:[m.jsx(A,{className:"mr-2 h-4 w-4"}),"Bulk Upload"]}),m.jsxs(b,{onClick:()=>a(!0),className:"bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:[m.jsx(L,{className:"mr-2 h-4 w-4"}),"Add New Car Order"]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsx("div",{className:"md:col-span-2",children:m.jsxs("div",{className:"relative",children:[m.jsx(Y,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),m.jsx(v,{placeholder:"Search orders by VIN, model, brand, or supplier...",className:"pl-10 border-gray-200 focus:border-monza-yellow focus:ring-monza-yellow",value:l,onChange:e=>c(e.target.value)})]})}),m.jsx(w,{className:"p-4",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-monza-black",children:e.length}),m.jsx("div",{className:"text-sm text-gray-600",children:"Total Orders"})]})}),m.jsx(w,{className:"p-4",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"arrived"===e.status).length}),m.jsx("div",{className:"text-sm text-gray-600",children:"Arrived"})]})})]}),m.jsxs(w,{className:"border border-gray-200 shadow-sm overflow-visible",children:[m.jsx(S,{className:"bg-gray-50 border-b",children:m.jsxs(E,{className:"text-monza-black",children:["Car Orders (",z.length,")"]})}),m.jsx(R,{className:"p-0 overflow-visible",children:m.jsx("div",{className:"overflow-x-auto overflow-y-visible relative",style:{overflowY:"visible"},children:m.jsxs($,{children:[m.jsx(Z,{children:m.jsxs(W,{className:"bg-gray-50",children:[m.jsx(X,{className:"font-semibold text-monza-black",children:"VIN"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Model"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Brand"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Category"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Color"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Status"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Warranty Life"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Supplier"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Shipment Code"}),m.jsx(X,{className:"font-semibold text-monza-black",children:"Order Date"}),m.jsx(X,{className:"font-semibold text-monza-black text-right",children:"Actions"})]})}),m.jsx(K,{children:z.length>0?z.map(e=>m.jsxs(W,{className:"hover:bg-monza-yellow/5 transition-colors",children:[m.jsx(Q,{className:"font-mono text-sm",children:e.vin_number}),m.jsx(Q,{className:"font-medium text-monza-black",children:e.model}),m.jsx(Q,{children:e.brand}),m.jsx(Q,{children:m.jsx(C,{variant:"outline",className:B(e.category),children:e.category})}),m.jsx(Q,{children:e.color}),m.jsx(Q,{children:m.jsx(C,{variant:"outline",className:H(e.status),children:e.status})}),m.jsx(se,{car:e}),m.jsx(Q,{children:e.supplier}),m.jsx(Q,{className:"font-mono text-sm",children:e.shipmentCode?m.jsx("div",{className:"flex items-center gap-2",children:m.jsx("span",{children:e.shipmentCode})}):m.jsx("span",{className:"text-gray-500 text-sm",children:"No code"})}),m.jsx(Q,{children:new Date(e.order_date).toLocaleDateString()}),m.jsx(Q,{className:"text-right",children:m.jsx(G,{variant:"dots",options:[{value:"edit",label:"Edit",icon:m.jsx(te,{className:"h-4 w-4"})},{value:"move",label:"Move Car",icon:m.jsx(_,{className:"h-4 w-4"}),isReceiveAction:!0,orderedId:e.id}],onAction:r=>{"edit"===r?(e=>{j(e),O(!0)})(e):"move"===r&&(e=>{V(e),P(!0)})(e)},id:`ordered-car-actions-${e.id}`,ariaLabel:`Actions for ${e.model} ${e.vin_number}`})})]},e.id)):m.jsx(W,{children:m.jsx(Q,{colSpan:10,className:"text-center py-8",children:m.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m.jsx(f,{className:"h-8 w-8 text-gray-400"}),m.jsx("p",{className:"font-medium text-gray-600",children:"No ordered cars found"}),m.jsx("p",{className:"text-sm text-gray-500",children:l?"No results match your search criteria.":"Start by adding your first car order."})]})})})})]})})})]}),m.jsx(ne,{isOpen:s,onClose:()=>a(!1),onAddOrder:F}),m.jsx(le,{isOpen:t,onClose:()=>n(!1),onSave:e=>{e.forEach(e=>{F(e)}),N({title:"Bulk Upload Complete",description:`Successfully added ${e.length} cars to ordered cars.`})}}),m.jsx(h,{open:I,onOpenChange:O,children:m.jsxs(g,{className:"sm:max-w-[600px]",children:[m.jsxs(u,{children:[m.jsx(p,{children:"Edit Ordered Car"}),m.jsx(J,{children:"Update the details of the ordered car."})]}),d&&m.jsxs("div",{className:"grid gap-4 py-4",children:[m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-model",className:"text-right",children:"Model"}),m.jsx(v,{id:"edit-model",defaultValue:d.model,className:"col-span-3",onChange:e=>j(o(i({},d),{model:e.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-vin",className:"text-right",children:"VIN"}),m.jsx(v,{id:"edit-vin",defaultValue:d.vin_number,className:"col-span-3",onChange:e=>j(o(i({},d),{vin_number:e.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-color",className:"text-right",children:"Color"}),m.jsx(v,{id:"edit-color",defaultValue:d.color,className:"col-span-3",onChange:e=>j(o(i({},d),{color:e.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-supplier",className:"text-right",children:"Supplier"}),m.jsx(v,{id:"edit-supplier",defaultValue:d.supplier,className:"col-span-3",onChange:e=>j(o(i({},d),{supplier:e.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-shipping",className:"text-right",children:"Shipping Company"}),m.jsx(v,{id:"edit-shipping",defaultValue:d.shipping_company,className:"col-span-3",onChange:e=>j(o(i({},d),{shipping_company:e.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-tracking",className:"text-right",children:"Tracking Number"}),m.jsx(v,{id:"edit-tracking",defaultValue:d.tracking_number||"",className:"col-span-3",onChange:e=>j(o(i({},d),{tracking_number:e.target.value}))})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(x,{htmlFor:"edit-notes",className:"text-right",children:"Notes"}),m.jsx(v,{id:"edit-notes",defaultValue:d.notes||"",className:"col-span-3",onChange:e=>j(o(i({},d),{notes:e.target.value}))})]})]}),m.jsxs(y,{children:[m.jsx(b,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),m.jsx(b,{onClick:()=>(r=>{if(d){const s=e.map(e=>e.id===d.id?i(i({},e),r):e);T(s),N({title:"Car Updated",description:`${d.model} has been updated successfully.`}),O(!1),j(null)}})(d||{}),children:"Save Changes"})]})]})}),m.jsx(ie,{isOpen:k,onClose:()=>{P(!1),V(null)},car:D,onMoveCar:r=>{if(!D)return;const s=e.map(e=>e.id===D.id?o(i({},e),{status:"arrived",arrival_date:(new Date).toISOString()}):e);T(s);const a={id:`car-${Date.now()}`,vinNumber:D.vin_number,model:D.model,brand:D.brand,year:D.year,color:D.color,category:D.category,price:D.selling_price||0,sellingPrice:D.selling_price||0,status:"in_stock",arrivalDate:(new Date).toISOString(),pdiCompleted:!1,customs:"not paid",batteryPercentage:100,range:520,warrantyStartDate:(new Date).toISOString(),warrantyEndDate:new Date(Date.now()+63072e6).toISOString(),warrantyMonthsRemaining:24,warrantyDaysRemaining:730,warrantyStatus:"active",lastWarrantyUpdate:(new Date).toISOString()};let t="";switch(r){case"floor1":const e=JSON.parse(localStorage.getItem("showroomFloor1Cars")||"[]");e.push(a),localStorage.setItem("showroomFloor1Cars",JSON.stringify(e)),t="Showroom Floor 1";break;case"floor2":const r=JSON.parse(localStorage.getItem("showroomFloor2Cars")||"[]");r.push(a),localStorage.setItem("showroomFloor2Cars",JSON.stringify(r)),t="Showroom Floor 2";break;case"garage":const s=JSON.parse(localStorage.getItem("garageInventory")||"[]");s.push(a),localStorage.setItem("garageInventory",JSON.stringify(s)),t="Garage Inventory";break;case"garage-schedule":const n=JSON.parse(localStorage.getItem("garageSchedule")||"[]");n.push(o(i({},a),{entryDate:(new Date).toISOString(),workType:"maintenance",garageLocation:"Bay 1"})),localStorage.setItem("garageSchedule",JSON.stringify(n)),t="Garage Schedule";break;default:const l=JSON.parse(localStorage.getItem("carInventory")||"[]");l.push(a),localStorage.setItem("carInventory",JSON.stringify(l)),t="Car Inventory"}N({title:"Car Moved Successfully",description:`${D.model} has been moved to ${t}.`}),P(!1),V(null)}})]})};export{oe as default};
