var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(s,r,a)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[r]=a,o=(e,s)=>{for(var r in s||(s={}))t.call(s,r)&&l(e,r,s[r]);if(a)for(var r of a(s))n.call(s,r)&&l(e,r,s[r]);return e},c=(e,a)=>s(e,r(a));import{l as i,j as d,L as m,I as p,H as h,k as u,aY as w,am as x,aZ as j,a6 as g,m as v,K as f,o as y,p as N,q as P,r as b,v as C,C as S,g as E,h as O,R as k,a as F}from"./index-BmUpYGrm.js";import{r as U}from"./vendor-vN6PtkFd.js";import{E as I}from"./eye-off-DKxk6IZx.js";import{L as A}from"./lock-BHJDt_OW.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";const D=({currentUser:e})=>{var s,r;const{toast:a}=i(),[t,n]=U.useState(c(o({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:(null==e?void 0:e.phone)||""},"OWNER"!==(null==(s=null==e?void 0:e.role)?void 0:s.toUpperCase())&&{department:(null==e?void 0:e.department)||""}),{notes:(null==e?void 0:e.notes)||""})),l=(e,s)=>{n(r=>c(o({},r),{[e]:s}))};return d.jsxs("form",{onSubmit:s=>{s.preventDefault();try{const s=JSON.parse(localStorage.getItem("employeeProfiles")||"[]").filter(s=>s.id!==(null==e?void 0:e.id));s.push(o(o({},e),t)),localStorage.setItem("employeeProfiles",JSON.stringify(s)),a({title:"Profile Updated",description:"Your profile information has been saved successfully."})}catch(r){a({title:"Error",description:"Failed to save profile information.",variant:"destructive"})}},className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"name",children:"Full Name"}),d.jsx(p,{id:"name",value:t.name,onChange:e=>l("name",e.target.value),placeholder:"Enter your full name"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"email",children:"Email Address"}),d.jsx(p,{id:"email",type:"email",value:t.email,onChange:e=>l("email",e.target.value),placeholder:"Enter your email"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"phone",children:"Phone Number"}),d.jsx(p,{id:"phone",type:"tel",value:t.phone,onChange:e=>l("phone",e.target.value),placeholder:"Enter your phone number"})]}),"OWNER"!==(null==(r=null==e?void 0:e.role)?void 0:r.toUpperCase())&&d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"department",children:"Department"}),d.jsx(p,{id:"department",value:t.department||"",onChange:e=>l("department",e.target.value),placeholder:"Enter your department"})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"notes",children:"Additional Notes"}),d.jsx(h,{id:"notes",value:t.notes,onChange:e=>l("notes",e.target.value),placeholder:"Any additional information",rows:4})]}),d.jsx(u,{type:"submit",className:"w-full",children:"Save Profile"})]})},L=({currentUser:e})=>{const{toast:s}=i(),[r,a]=U.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[t,n]=U.useState({current:!1,new:!1,confirm:!1}),[l,h]=U.useState(!1),f=(e,s)=>{a(r=>c(o({},r),{[e]:s}))},y=e=>{n(s=>c(o({},s),{[e]:!s[e]}))},N=(e=>{let s=0;const r={length:e.length>=8,uppercase:/[A-Z]/.test(e),lowercase:/[a-z]/.test(e),numbers:/\d/.test(e),special:/[!@#$%^&*(),.?":{}|<>]/.test(e)};return s=Object.values(r).filter(Boolean).length,{score:s,checks:r,label:s<2?"Weak":s<4?"Medium":"Strong",color:s<2?"text-red-600":s<4?"text-yellow-600":"text-green-600"}})(r.newPassword);return d.jsxs("form",{onSubmit:t=>{return n=void 0,l=null,o=function*(){if(t.preventDefault(),r.currentPassword?r.newPassword?r.newPassword.length<8?(s({title:"Error",description:"Password must be at least 8 characters long.",variant:"destructive"}),0):r.newPassword!==r.confirmPassword?(s({title:"Error",description:"New passwords do not match.",variant:"destructive"}),0):r.currentPassword!==r.newPassword||(s({title:"Error",description:"New password must be different from current password.",variant:"destructive"}),0):(s({title:"Error",description:"Please enter a new password.",variant:"destructive"}),0):(s({title:"Error",description:"Please enter your current password.",variant:"destructive"}),0)){h(!0);try{yield new Promise(e=>setTimeout(e,1500));const r={userId:null==e?void 0:e.id,email:null==e?void 0:e.email,changedAt:(new Date).toISOString(),changedBy:(null==e?void 0:e.name)||"Unknown"},t=JSON.parse(localStorage.getItem("passwordChangeLogs")||"[]");t.push(r),localStorage.setItem("passwordChangeLogs",JSON.stringify(t)),a({currentPassword:"",newPassword:"",confirmPassword:""}),s({title:"Password Changed Successfully",description:"Your password has been updated. Please use your new password for future logins."})}catch(n){s({title:"Error",description:"Failed to change password. Please try again.",variant:"destructive"})}finally{h(!1)}}},new Promise((e,s)=>{var r=e=>{try{c(o.next(e))}catch(t){s(t)}},a=e=>{try{c(o.throw(e))}catch(t){s(t)}},c=s=>s.done?e(s.value):Promise.resolve(s.value).then(r,a);c((o=o.apply(n,l)).next())});var n,l,o},className:"space-y-6",children:[d.jsxs(w,{children:[d.jsx(x,{className:"h-4 w-4"}),d.jsx(j,{children:"For security reasons, you'll need to enter your current password to make changes. Choose a strong password with at least 8 characters including uppercase, lowercase, numbers, and special characters."})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"current-password",children:"Current Password *"}),d.jsxs("div",{className:"relative",children:[d.jsx(p,{id:"current-password",name:"current_password",type:t.current?"text":"password",value:r.currentPassword,onChange:e=>f("currentPassword",e.target.value),placeholder:"Enter your current password",className:"pr-10",autocomplete:"current-password",required:!0}),d.jsx("button",{type:"button",onClick:()=>y("current"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:t.current?d.jsx(I,{className:"h-4 w-4"}):d.jsx(g,{className:"h-4 w-4"})})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"new-password",children:"New Password *"}),d.jsxs("div",{className:"relative",children:[d.jsx(p,{id:"new-password",name:"new_password",type:t.new?"text":"password",value:r.newPassword,onChange:e=>f("newPassword",e.target.value),placeholder:"Enter your new password",className:"pr-10",autocomplete:"new-password",required:!0}),d.jsx("button",{type:"button",onClick:()=>y("new"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:t.new?d.jsx(I,{className:"h-4 w-4"}):d.jsx(g,{className:"h-4 w-4"})})]}),r.newPassword&&d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Password strength:"}),d.jsx("span",{className:`text-sm font-medium ${N.color}`,children:N.label})]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[d.jsxs("div",{className:"flex items-center gap-1 "+(N.checks.length?"text-green-600":"text-gray-400"),children:[d.jsx(v,{className:"h-3 w-3"}),"At least 8 characters"]}),d.jsxs("div",{className:"flex items-center gap-1 "+(N.checks.uppercase?"text-green-600":"text-gray-400"),children:[d.jsx(v,{className:"h-3 w-3"}),"Uppercase letter"]}),d.jsxs("div",{className:"flex items-center gap-1 "+(N.checks.lowercase?"text-green-600":"text-gray-400"),children:[d.jsx(v,{className:"h-3 w-3"}),"Lowercase letter"]}),d.jsxs("div",{className:"flex items-center gap-1 "+(N.checks.numbers?"text-green-600":"text-gray-400"),children:[d.jsx(v,{className:"h-3 w-3"}),"Number"]}),d.jsxs("div",{className:"flex items-center gap-1 "+(N.checks.special?"text-green-600":"text-gray-400"),children:[d.jsx(v,{className:"h-3 w-3"}),"Special character"]})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(m,{htmlFor:"confirm-password",children:"Confirm New Password *"}),d.jsxs("div",{className:"relative",children:[d.jsx(p,{id:"confirm-password",name:"confirm_password",type:t.confirm?"text":"password",value:r.confirmPassword,onChange:e=>f("confirmPassword",e.target.value),placeholder:"Confirm your new password",className:"pr-10",autocomplete:"new-password",required:!0}),d.jsx("button",{type:"button",onClick:()=>y("confirm"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:t.confirm?d.jsx(I,{className:"h-4 w-4"}):d.jsx(g,{className:"h-4 w-4"})})]}),r.confirmPassword&&r.newPassword!==r.confirmPassword&&d.jsx("p",{className:"text-sm text-red-600",children:"Passwords do not match"})]})]}),d.jsx(u,{type:"submit",className:"w-full",disabled:l||!r.currentPassword||!r.newPassword||!r.confirmPassword||r.newPassword!==r.confirmPassword,children:l?d.jsxs(d.Fragment,{children:[d.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Changing Password..."]}):d.jsxs(d.Fragment,{children:[d.jsx(A,{className:"mr-2 h-4 w-4"}),"Change Password"]})})]})},q=()=>{const{user:e}=f();return d.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[d.jsxs("div",{className:"mb-6",children:[d.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[d.jsx(y,{className:"h-6 w-6"}),"Employee Profile"]}),d.jsx("p",{className:"text-gray-600 mt-1",children:"Update your personal information, contact details, and account settings"})]}),d.jsxs(N,{defaultValue:"profile",className:"space-y-6",children:[d.jsxs(P,{className:"grid w-full grid-cols-2",children:[d.jsxs(b,{value:"profile",className:"flex items-center gap-2",children:[d.jsx(y,{className:"h-4 w-4"}),"Profile Information"]}),d.jsxs(b,{value:"password",className:"flex items-center gap-2",children:[d.jsx(A,{className:"h-4 w-4"}),"Change Password"]})]}),d.jsx(C,{value:"profile",children:d.jsxs(S,{children:[d.jsxs(E,{children:[d.jsx(O,{children:"Personal Information"}),d.jsx(k,{children:"Keep your profile information up to date so management can reach you when needed"})]}),d.jsx(F,{children:d.jsx(D,{currentUser:e})})]})}),d.jsx(C,{value:"password",children:d.jsxs(S,{children:[d.jsxs(E,{children:[d.jsx(O,{children:"Change Password"}),d.jsx(k,{children:"Update your account password to keep your account secure"})]}),d.jsx(F,{children:d.jsx(L,{currentUser:e})})]})})]})]})};export{q as default};
