var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,l=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(s)for(var a of s(t))n.call(t,a)&&o(e,a,t[a]);return e},i=(e,s)=>t(e,a(s));import{l as c,j as d,y as m,z as x,E as u,F as p,ao as h,P as g,n as y,k as j,ab as v,b as f,m as N,d as b,ad as w,Q as _,S,I as C,C as D,a as I,g as k,h as E,e as O,W as M,X as P,V as W}from"./index-BmUpYGrm.js";import{r as T}from"./vendor-vN6PtkFd.js";import{C as V}from"./CarHistoryDetailsDialog-DrVVgh37.js";import{B as L}from"./battery-zPCpHw5W.js";import{u as $,W as B}from"./useWarrantyEditor-C-QeEmwQ.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";import"./testDriveService-Dw5zSlpe.js";import"./enhancedRepairHistoryService-DfLNwEz9.js";import"./enhancedMonzaBotService-CP3UVEVb.js";import"./errorHandling-Dc1u_gNS.js";import"./gauge-Cy8s4FVS.js";import"./fuel-DD7FDLWK.js";import"./smartphone-Cgftoe1I.js";import"./test-tube-BmzcAWFY.js";import"./phone-CUmdYfuI.js";import"./mail-BiNlmlXL.js";const F=({isOpen:e,onClose:t,car:a,onMoveCar:s})=>{const[r,n]=T.useState(""),[o,l]=T.useState("");c();const i=[{id:"floor1",label:"Showroom Floor 1",description:"Move to main showroom floor 1",icon:h},{id:"floor2",label:"Showroom Floor 2",description:"Move to luxury showroom floor 2",icon:h},{id:"inventory",label:"Car Inventory",description:"Move to main car inventory storage",icon:g},{id:"garage-schedule",label:"Garage Schedule",description:"Add to garage schedule for service/repair",icon:y}];return d.jsx(m,{open:e,onOpenChange:t,children:d.jsxs(x,{className:"sm:max-w-[400px]",children:[d.jsx(u,{children:d.jsxs(p,{children:["Move Car - ",null==a?void 0:a.model]})}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[d.jsxs("p",{className:"text-sm",children:[d.jsx("strong",{children:"VIN:"})," ",null==a?void 0:a.vinNumber]}),d.jsxs("p",{className:"text-sm",children:[d.jsx("strong",{children:"Model:"})," ",null==a?void 0:a.model]}),d.jsxs("p",{className:"text-sm",children:[d.jsx("strong",{children:"Color:"})," ",null==a?void 0:a.color]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-sm font-medium",children:"Select destination:"}),i.map(e=>d.jsx(j,{variant:"outline",className:"w-full justify-start",onClick:()=>s(e.id),children:e.label},e.id))]})]}),d.jsx(v,{children:d.jsx(j,{variant:"outline",onClick:t,children:"Cancel"})})]})})};function z(e){if(!e)return{status:"no_warranty",text:"No Warranty",className:"text-sm text-muted-foreground",icon:null,color:"text-gray-500"};const t=new Date,a=new Date(e),s=Math.floor((a.getTime()-t.getTime())/864e5);return s>=30?{status:"active",text:"Active",className:"rounded-full border font-semibold transition-colors bg-green-100 text-green-800 border-green-300 text-xs px-2 py-1 inline-flex items-center gap-1 hover:bg-green-200 cursor-pointer",icon:d.jsx(N,{className:"w-3 h-3"}),color:"text-green-800"}:s>=0?{status:"expiring_soon",text:"Expiring Soon",className:"rounded-full border font-semibold transition-colors bg-yellow-100 text-yellow-800 border-yellow-300 text-xs px-2 py-1 inline-flex items-center gap-1 hover:bg-yellow-200 cursor-pointer",icon:d.jsx(y,{className:"w-3 h-3"}),color:"text-yellow-800"}:{status:"expired",text:"Expired",className:"rounded-full border font-semibold transition-colors bg-red-100 text-red-800 border-red-300 text-xs px-2 py-1 inline-flex items-center gap-1 hover:bg-red-200 cursor-pointer",icon:d.jsx(b,{className:"w-3 h-3"}),color:"text-red-800"}}function A(e){if(!e)return null;const t=new Date,a=new Date(e);return Math.floor((a.getTime()-t.getTime())/864e5)}const G=({dms_deadline_date:e,battery_expiry_date:t,vehicle_expiry_date:a,delivery_date:s,warranty_life:r,onClick:n,compact:o=!1})=>{const c=function(e){const t=z(e);return i(l({},t),{text:"no_warranty"===t.status?"No DMS Warranty":`DMS: ${t.text}`,icon:"no_warranty"===t.status?d.jsx(y,{className:"w-3 h-3"}):t.icon})}(e),m=function(e){const t=z(e);return i(l({},t),{text:"no_warranty"===t.status?"No Battery Warranty":`Battery: ${t.text}`,icon:"no_warranty"===t.status?d.jsx(L,{className:"w-3 h-3"}):t.icon})}(t),x=function(e){const t=z(e);return i(l({},t),{text:"no_warranty"===t.status?"No Vehicle Warranty":`Vehicle: ${t.text}`,icon:"no_warranty"===t.status?d.jsx(f,{className:"w-3 h-3"}):t.icon})}(a);if(!(e||t||a))return d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm text-muted-foreground",children:"No Warranty"}),d.jsxs("button",{onClick:n,className:"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 px-2 py-1 rounded transition-colors",children:[d.jsx(w,{className:"w-3 h-3"}),"Add"]})]});if(o){const s=function(e,t,a){const s=[];if(e){const t=A(e);null!==t&&s.push("DMS: "+(t>=0?`${t} days`:"Expired"))}if(t){const e=A(t);null!==e&&s.push("Battery: "+(e>=0?`${e} days`:"Expired"))}if(a){const e=A(a);null!==e&&s.push("Vehicle: "+(e>=0?`${e} days`:"Expired"))}return s.length>0?s.join(" | "):"No Warranty Set"}(e,t,a);return d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-xs text-gray-600",children:s}),d.jsxs("button",{onClick:n,className:"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 px-2 py-1 rounded transition-colors",children:[d.jsx(w,{className:"w-3 h-3"}),"Edit"]})]})}return d.jsxs("div",{className:"space-y-2",children:[e&&d.jsxs("div",{className:c.className,onClick:n,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n())},children:[c.icon,c.text]}),t&&d.jsxs("div",{className:m.className,onClick:n,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n())},children:[m.icon,m.text]}),a&&d.jsxs("div",{className:x.className,onClick:n,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),n())},children:[x.icon,x.text]}),d.jsxs("button",{onClick:n,className:"inline-flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 px-2 py-1 rounded transition-colors w-full justify-center",children:[d.jsx(w,{className:"w-3 h-3"}),"Edit Warranty"]})]})},H=()=>{const[e,t]=T.useState([]),[a,s]=T.useState(""),[r,n]=T.useState(!0),[o,l]=T.useState(!1),[i,m]=T.useState(null),[x,u]=T.useState(!1),[p,h]=T.useState(null),[g,y]=T.useState(!1),[v,b]=T.useState(null),{toast:L}=c();T.useEffect(()=>{var e,a,s;e=void 0,a=null,s=function*(){try{n(!0),localStorage.removeItem("garageCars"),localStorage.removeItem("garageInventory"),localStorage.removeItem("garageSchedule"),localStorage.removeItem("garageSchedules"),localStorage.removeItem("inventoryGarage");const e={id:"test-garage-car-1",vinNumber:"TESTVIN12345678901",model:"Voyah FREE",year:2024,color:"White",brand:"Voyah",category:"EV",status:"available",arrivalDate:(new Date).toISOString(),batteryPercentage:85,sellingPrice:65e3,customs:"paid",customsAmount:5500,shipmentCode:"TEST-001",garageEntryDate:(new Date).toISOString(),garageLocation:"Bay 2",garageStatus:"stored",garageNotes:"Test car for demonstrating move functionality",pdiCompleted:!0,pdiDate:(new Date).toISOString(),pdiTechnician:"Tech-001",notes:"Test car",manufacturingDate:"2024-01-15",rangeExtenderNumber:"RE-001",highVoltageBatteryNumber:"HV-001",frontMotorNumber:"FM-001",rearMotorNumber:"RM-001",warranty_life:"1 year",delivery_date:(new Date).toISOString(),vehicle_expiry_date:new Date(Date.now()+31536e6).toISOString(),battery_expiry_date:new Date(Date.now()+31536e6).toISOString(),dms_deadline_date:new Date(Date.now()+2592e6).toISOString()};t([e])}catch(e){t([])}finally{n(!1)}},new Promise((t,r)=>{var n=e=>{try{l(s.next(e))}catch(t){r(t)}},o=e=>{try{l(s.throw(e))}catch(t){r(t)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);l((s=s.apply(e,a)).next())})},[]);const z=e.filter(e=>e.vinNumber.toLowerCase().includes(a.toLowerCase())||e.model.toLowerCase().includes(a.toLowerCase())||e.brand.toLowerCase().includes(a.toLowerCase())),A=e=>{h(e),u(!0)};if(r)return d.jsx("div",{className:"flex items-center justify-center h-64",children:d.jsx("div",{className:"text-lg",children:"Loading garage inventory..."})});const H=$();return d.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold",children:"Garage Car Inventory"}),d.jsx("p",{className:"text-muted-foreground",children:"Manage cars currently in garage"})]}),d.jsx("div",{className:"flex gap-2",children:d.jsxs(j,{variant:"outline",children:[d.jsx(_,{className:"h-4 w-4 mr-2"}),"Scan VIN"]})})]}),d.jsx("div",{className:"flex gap-4 mb-6",children:d.jsxs("div",{className:"relative flex-1",children:[d.jsx(S,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),d.jsx(C,{placeholder:"Search by VIN, model, or brand...",value:a,onChange:e=>s(e.target.value),className:"pl-10"})]})}),0===z.length?d.jsx(D,{children:d.jsxs(I,{className:"flex flex-col items-center justify-center py-16",children:[d.jsx(f,{className:"h-16 w-16 text-muted-foreground mb-4"}),d.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Cars in Garage"}),d.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:a?"No cars found matching your search criteria.":"There are currently no cars in the garage inventory. Cars will appear here when moved to garage."})]})}):d.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:z.map(e=>d.jsxs(D,{className:"hover:shadow-lg transition-shadow cursor-pointer hover:bg-blue-50",onClick:()=>{b(e),y(!0)},title:"Click to view complete car history",children:[d.jsx(k,{className:"pb-3",children:d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx(E,{className:"text-lg",children:e.model}),d.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.brand," • ",e.year]})]}),d.jsx(O,{variant:"ready_for_pickup"===e.garageStatus?"default":"secondary",children:e.garageStatus.replace("_"," ")})]})}),d.jsxs(I,{className:"space-y-3",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"VIN:"}),d.jsx("p",{className:"text-muted-foreground font-mono text-xs",children:e.vinNumber})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"Location:"}),d.jsx("p",{className:"text-muted-foreground",children:e.garageLocation})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"Battery:"}),d.jsxs("p",{className:"text-muted-foreground",children:[e.batteryPercentage,"%"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"PDI:"}),d.jsxs("div",{className:"flex items-center gap-1",children:[e.pdiCompleted?d.jsx(N,{className:"h-3 w-3 text-green-500"}):d.jsx(M,{className:"h-3 w-3 text-orange-500"}),d.jsx("span",{className:"text-xs",children:e.pdiCompleted?"Complete":"Pending"})]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-medium",children:"Warranty:"}),d.jsx("div",{className:"mt-1",children:d.jsx(G,{warranty_life:e.warranty_life,delivery_date:e.delivery_date,vehicle_expiry_date:e.vehicle_expiry_date,battery_expiry_date:e.battery_expiry_date,dms_deadline_date:e.dms_deadline_date,compact:!0,onClick:()=>{H.openWarrantyDialog(e.id,"garage_cars",{warranty_life:e.warranty_life,delivery_date:e.delivery_date,vehicle_expiry_date:e.vehicle_expiry_date,battery_expiry_date:e.battery_expiry_date,dms_deadline_date:e.dms_deadline_date})}})})]}),d.jsxs("div",{className:"col-span-2",children:[d.jsx("span",{className:"font-medium",children:"Customs:"}),d.jsx("div",{className:"inline-flex items-center ml-2",children:d.jsx(O,{variant:"paid"===e.customs?"default":"destructive",className:"cursor-pointer hover:opacity-80 transition-opacity",onClick:t=>{t.stopPropagation(),A(e)},title:"Click to manage customs",children:"paid"===e.customs?d.jsxs(d.Fragment,{children:[" ",d.jsx(N,{className:"h-3 w-3 mr-1"})," paid"]}):d.jsxs(d.Fragment,{children:[" ",d.jsx(P,{className:"h-3 w-3 mr-1"})," ",e.customs||"not paid"]})})})]})]}),e.garageNotes&&d.jsxs("div",{className:"pt-2 border-t",children:[d.jsx("span",{className:"font-medium text-sm",children:"Notes:"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:e.garageNotes})]}),d.jsxs("div",{className:"flex gap-2 pt-2",children:[d.jsxs(j,{variant:"outline",size:"sm",className:"flex-1",onClick:e=>{e.stopPropagation()},children:[d.jsx(w,{className:"h-3 w-3 mr-1"}),"Edit"]}),d.jsxs(j,{variant:"outline",size:"sm",className:"flex-1",onClick:e=>{e.stopPropagation()},children:[d.jsx(M,{className:"h-3 w-3 mr-1"}),"PDI"]}),d.jsx(j,{variant:"outline",size:"sm",className:"flex-1",onClick:t=>{t.stopPropagation(),A(e)},children:"Customs"}),d.jsxs(j,{variant:"outline",size:"sm",className:"flex-1",onClick:t=>{t.stopPropagation(),(e=>{m(e),l(!0)})(e)},children:[d.jsx(W,{className:"h-3 w-3 mr-1"}),"Move"]})]})]})]},e.id))}),o&&i&&d.jsx(F,{isOpen:o,onClose:()=>{l(!1),m(null)},car:i,onMoveCar:(e,a)=>{i&&(t(e=>e.filter(e=>e.id!==i.id)),L({title:"Car Moved Successfully",description:`${i.model} has been moved to ${e}.`}),l(!1),m(null))}}),d.jsx(V,{isOpen:g,onClose:()=>{y(!1),b(null)},car:v}),d.jsx(B,{isOpen:H.isWarrantyDialogOpen,onClose:H.closeWarrantyDialog,carId:H.selectedCarId||"",tableName:H.selectedTableName||"garage_cars",currentWarranty:H.selectedCarWarranty||void 0,onSave:H.handleWarrantySave})]})};export{H as default};
