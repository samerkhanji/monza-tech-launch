import{a8 as e,K as s,j as t,N as i,U as a,k as l,C as r,g as c,h as n,S as d,R as o,a as x,I as m,e as h,p as u,q as j,r as v,B as p,c as g,f as N,v as f,m as w,o as b,ac as y,a6 as A,n as T,y as C,z as D,E as L,F as R,a9 as S,t as O,a7 as E}from"./index-BmUpYGrm.js";import{r as I}from"./vendor-vN6PtkFd.js";import{T as U,a as k,b as M,c as W,d as P,e as _}from"./table-BEISn_Te.js";import{u as G}from"./useAuditLog-BKBIiLUr.js";import{D as F}from"./download-CLPHGjzE.js";import{G as z}from"./globe-DlCryj_B.js";import{X as V}from"./x-circle-HKM8FhbF.js";import{S as B}from"./smartphone-Cgftoe1I.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";
/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=e("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),$=()=>{var e,$;const{user:J}=s(),{auditLogs:Y}=G(),[q,K]=I.useState("overview"),[X,Q]=I.useState(""),[Z,ee]=I.useState(null),[se,te]=I.useState("all"),[ie,ae]=I.useState("all"),[le,re]=I.useState("all"),[ce,ne]=I.useState(!1),[de,oe]=I.useState(null),[xe,me]=I.useState([]),[he,ue]=I.useState(!0);I.useMemo(()=>xe.length?{total:xe.length,today:0,thisWeek:0}:{total:0,today:0,thisWeek:0},[xe]),I.useMemo(()=>xe||[],[xe]),I.useMemo(()=>[],[xe]);const je=I.useMemo(()=>{var e,s;if("OWNER"!==(null==(e=null==J?void 0:J.role)?void 0:e.toUpperCase())&&"garage_manager"!==(null==(s=null==J?void 0:J.role)?void 0:s.toLowerCase()))return[];const t=new Map;return Y.forEach(e=>{var s,i;t.has(e.userId)||t.set(e.userId,{userId:e.userId,userName:e.userName,userRole:e.userRole,totalActivities:0,todayActivities:0,weekActivities:0,monthActivities:0,lastActivity:e.timestamp,firstActivity:e.timestamp,mostActiveSection:"",mostCommonAction:"",deviceTypes:{},browsers:{},errorCount:0,successRate:100,recentActivities:[]});const a=t.get(e.userId);a.totalActivities++;const l=new Date(e.timestamp),r=new Date,c=new Date(r.getFullYear(),r.getMonth(),r.getDate()),n=new Date(r.getTime()-6048e5),d=new Date(r.getTime()-2592e6);l>=c&&a.todayActivities++,l>=n&&a.weekActivities++,l>=d&&a.monthActivities++,new Date(e.timestamp)>new Date(a.lastActivity)&&(a.lastActivity=e.timestamp),new Date(e.timestamp)<new Date(a.firstActivity)&&(a.firstActivity=e.timestamp),(null==(s=e.metadata)?void 0:s.deviceType)&&(a.deviceTypes[e.metadata.deviceType]=(a.deviceTypes[e.metadata.deviceType]||0)+1),(null==(i=e.metadata)?void 0:i.browserName)&&(a.browsers[e.metadata.browserName]=(a.browsers[e.metadata.browserName]||0)+1)}),t.forEach((e,s)=>{var t,i;const a=Y.filter(e=>e.userId===s),l=a.reduce((e,s)=>(e[s.section]=(e[s.section]||0)+1,e),{});e.mostActiveSection=(null==(t=Object.entries(l).sort(([,e],[,s])=>s-e)[0])?void 0:t[0])||"None";const r=a.reduce((e,s)=>(e[s.action]=(e[s.action]||0)+1,e),{});e.mostCommonAction=(null==(i=Object.entries(r).sort(([,e],[,s])=>s-e)[0])?void 0:i[0])||"None",e.recentActivities=a.slice(0,20);const c=a.filter(e=>e.details.toLowerCase().includes("error")||e.details.toLowerCase().includes("failed")||"DELETE"===e.action).length;e.errorCount=c,e.successRate=e.totalActivities>0?Math.round((e.totalActivities-c)/e.totalActivities*100):100}),Array.from(t.values()).sort((e,s)=>new Date(s.lastActivity).getTime()-new Date(e.lastActivity).getTime())},[Y,J]);if("OWNER"!==(null==(e=null==J?void 0:J.role)?void 0:e.toUpperCase())&&"garage_manager"!==(null==($=null==J?void 0:J.role)?void 0:$.toLowerCase()))return t.jsx(i,{to:"/dashboard",replace:!0});const ve=I.useMemo(()=>je.filter(e=>{const s=!X||e.userName.toLowerCase().includes(X.toLowerCase())||e.userRole.toLowerCase().includes(X.toLowerCase())||e.userId.toLowerCase().includes(X.toLowerCase()),t="all"===se||"today"===se&&e.todayActivities>0||"week"===se&&e.weekActivities>0||"month"===se&&e.monthActivities>0;return s&&t}),[je,X,se]),pe=I.useMemo(()=>Y.filter(e=>{var s,t,i,a,l;if(!X)return!0;const r=X.toLowerCase();return e.userName.toLowerCase().includes(r)||e.details.toLowerCase().includes(r)||(null==(s=e.entityName)?void 0:s.toLowerCase().includes(r))||(null==(t=e.vinNumber)?void 0:t.toLowerCase().includes(r))||(null==(i=e.partNumber)?void 0:i.toLowerCase().includes(r))||(null==(a=e.carModel)?void 0:a.toLowerCase().includes(r))||(null==(l=e.carBrand)?void 0:l.toLowerCase().includes(r))||e.section.toLowerCase().includes(r)||e.action.toLowerCase().includes(r)||e.entityType.toLowerCase().includes(r)}).filter(e=>{if("all"!==ie&&e.section!==ie)return!1;if("all"!==le&&e.action!==le)return!1;if(Z&&e.userId!==Z)return!1;if("all"!==se){const s=new Date(e.timestamp),t=new Date;switch(se){case"today":return s.toDateString()===t.toDateString();case"week":return s>=new Date(t.getTime()-6048e5);case"month":return s>=new Date(t.getTime()-2592e6)}}return!0}),[Y,X,ie,le,Z,se]),ge=e=>{switch(e){case"mobile":return t.jsx(B,{className:"h-4 w-4"});case"tablet":return t.jsx(H,{className:"h-4 w-4"});default:return t.jsx(E,{className:"h-4 w-4"})}},Ne=e=>{switch(e){case"CREATE":case"LOGIN":return t.jsx(w,{className:"h-4 w-4 text-green-600"});case"UPDATE":return t.jsx(g,{className:"h-4 w-4 text-blue-600"});case"DELETE":return t.jsx(V,{className:"h-4 w-4 text-red-600"});case"VIEW":return t.jsx(A,{className:"h-4 w-4 text-gray-600"});case"LOGOUT":return t.jsx(V,{className:"h-4 w-4 text-orange-600"});default:return t.jsx(g,{className:"h-4 w-4 text-gray-600"})}},fe=e=>({INVENTORY:"bg-blue-100 text-blue-800",SHOWROOM_1:"bg-green-100 text-green-800",SHOWROOM_2:"bg-purple-100 text-purple-800",GARAGE:"bg-orange-100 text-orange-800",FINANCIAL:"bg-yellow-100 text-yellow-800",REPAIRS:"bg-red-100 text-red-800",PDI:"bg-indigo-100 text-indigo-800",USERS:"bg-gray-100 text-gray-800"}[e]||"bg-gray-100 text-gray-800");return t.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(a,{className:"h-8 w-8 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"User Activity Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor employee activities, track usage patterns, and review individual user histories"})]})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(l,{variant:"outline",onClick:()=>{const e={summary:je,allActivities:Y},s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(s),i=document.createElement("a");i.href=t,i.download=`all-user-activities-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)},children:[t.jsx(F,{className:"mr-2 h-4 w-4"}),"Export All Data"]})})]}),t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsxs(n,{className:"flex items-center gap-2",children:[t.jsx(d,{className:"h-5 w-5"}),"Advanced Search & Filters"]}),t.jsx(o,{children:"Search across all activities, users, and data. Filter by time range, section, action, or specific user."})]}),t.jsxs(x,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(m,{id:"user-activity-search",placeholder:"Search users, activities, VINs, parts, details...",value:X,onChange:e=>Q(e.target.value),className:"w-full"})}),t.jsxs("select",{id:"timeRange",value:se,onChange:e=>te(e.target.value),className:"h-10 w-full px-3 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 relative z-10",style:{appearance:"auto"},children:[t.jsx("option",{value:"all",children:"All Time"}),t.jsx("option",{value:"today",children:"Today"}),t.jsx("option",{value:"week",children:"This Week"}),t.jsx("option",{value:"month",children:"This Month"})]}),t.jsxs("select",{id:"section",value:ie,onChange:e=>ae(e.target.value),className:"h-10 w-full px-3 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 relative z-10",style:{appearance:"auto"},children:[t.jsx("option",{value:"all",children:"All Sections"}),t.jsx("option",{value:"INVENTORY",children:"Inventory"}),t.jsx("option",{value:"SHOWROOM_1",children:"Showroom 1"}),t.jsx("option",{value:"SHOWROOM_2",children:"Showroom 2"}),t.jsx("option",{value:"GARAGE",children:"Garage"}),t.jsx("option",{value:"FINANCIAL",children:"Financial"}),t.jsx("option",{value:"REPAIRS",children:"Repairs"}),t.jsx("option",{value:"PDI",children:"PDI"}),t.jsx("option",{value:"USERS",children:"Users"})]}),t.jsxs("select",{id:"action",value:le,onChange:e=>re(e.target.value),className:"h-10 w-full px-3 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 relative z-10",style:{appearance:"auto"},children:[t.jsx("option",{value:"all",children:"All Actions"}),t.jsx("option",{value:"CREATE",children:"Create"}),t.jsx("option",{value:"UPDATE",children:"Update"}),t.jsx("option",{value:"DELETE",children:"Delete"}),t.jsx("option",{value:"VIEW",children:"View"}),t.jsx("option",{value:"LOGIN",children:"Login"}),t.jsx("option",{value:"LOGOUT",children:"Logout"}),t.jsx("option",{value:"UPLOAD",children:"Upload"}),t.jsx("option",{value:"DOWNLOAD",children:"Download"})]})]}),(X||"all"!==se||"all"!==ie||"all"!==le)&&t.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[t.jsxs(h,{variant:"outline",children:[pe.length," results found"]}),t.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{Q(""),te("all"),ae("all"),re("all"),ee(null)},children:"Clear Filters"})]})]})]}),t.jsxs(u,{value:q,onValueChange:K,className:"space-y-4",children:[t.jsxs(j,{className:"grid w-full grid-cols-4",children:[t.jsxs(v,{value:"overview",className:"flex items-center gap-2",children:[t.jsx(p,{className:"h-4 w-4"}),"Overview"]}),t.jsxs(v,{value:"users",className:"flex items-center gap-2",children:[t.jsx(a,{className:"h-4 w-4"}),"User Profiles"]}),t.jsxs(v,{value:"activities",className:"flex items-center gap-2",children:[t.jsx(g,{className:"h-4 w-4"}),"All Activities"]}),t.jsxs(v,{value:"analytics",className:"flex items-center gap-2",children:[t.jsx(N,{className:"h-4 w-4"}),"Analytics"]})]}),t.jsxs(f,{value:"overview",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[t.jsxs(r,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(n,{className:"text-sm font-medium",children:"Total Users"}),t.jsx(a,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold",children:je.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Active in system"})]})]}),t.jsxs(r,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(n,{className:"text-sm font-medium",children:"Today's Activities"}),t.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold",children:je.reduce((e,s)=>e+s.todayActivities,0)}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all users"})]})]}),t.jsxs(r,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(n,{className:"text-sm font-medium",children:"Active Today"}),t.jsx(w,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold",children:je.filter(e=>e.todayActivities>0).length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Users active today"})]})]}),t.jsxs(r,{children:[t.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(n,{className:"text-sm font-medium",children:"Total Activities"}),t.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(x,{children:[t.jsx("div",{className:"text-2xl font-bold",children:Y.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"All time activities"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsx(n,{children:"Most Active Users"}),t.jsx(o,{children:"Users with highest activity counts"})]}),t.jsx(x,{children:t.jsx("div",{className:"space-y-4",children:je.slice(0,5).map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(b,{className:"h-5 w-5 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e.userName}),t.jsx("div",{className:"text-sm text-muted-foreground",children:e.userRole})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-bold",children:e.totalActivities}),t.jsx("div",{className:"text-xs text-muted-foreground",children:"activities"})]})]},e.userId))})})]}),t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsx(n,{children:"Recent Activities"}),t.jsx(o,{children:"Latest system activities"})]}),t.jsx(x,{children:t.jsx("div",{className:"space-y-3",children:Y.slice(0,8).map(e=>t.jsxs("div",{className:"flex items-start gap-3 p-2 border rounded",children:[t.jsx("div",{className:"flex items-center gap-2",children:Ne(e.action)}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"font-medium text-sm",children:e.userName}),t.jsx(h,{className:fe(e.section),variant:"outline",children:e.section.replace("_"," ")})]}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e.details}),t.jsx("p",{className:"text-xs text-muted-foreground",children:y.formatDateTime(e.timestamp)})]})]},e.id))})})]})]})]}),t.jsx(f,{value:"users",children:t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsx(n,{children:"User Activity Profiles"}),t.jsx(o,{children:"Click on any user to view their detailed activity history and analytics"})]}),t.jsx(x,{children:t.jsx("div",{className:"space-y-4",children:ve.map(e=>t.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>(e=>{const s=je.find(s=>s.userId===e);s&&(oe(s),ne(!0))})(e.userId),children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(b,{className:"h-6 w-6 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-lg",children:e.userName}),t.jsx("div",{className:"text-sm text-muted-foreground",children:e.userRole})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(l,{variant:"outline",size:"sm",onClick:s=>{s.stopPropagation(),(e=>{const s=je.find(s=>s.userId===e);if(!s)return;const t={summary:s,activities:Y.filter(s=>s.userId===e)},i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(i),l=document.createElement("a");l.href=a,l.download=`user-activity-${s.userName}-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a),O({title:"Export Complete",description:`Activity data for ${s.userName} has been exported.`})})(e.userId)},children:[t.jsx(F,{className:"h-4 w-4 mr-1"}),"Export"]}),t.jsxs(l,{variant:"outline",size:"sm",children:[t.jsx(A,{className:"h-4 w-4 mr-1"}),"View Details"]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:e.totalActivities}),t.jsx("div",{className:"text-xs text-blue-600",children:"Total Activities"})]}),t.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[t.jsx("div",{className:"text-lg font-bold text-green-600",children:e.todayActivities}),t.jsx("div",{className:"text-xs text-green-600",children:"Today"})]}),t.jsxs("div",{className:"text-center p-2 bg-purple-50 rounded",children:[t.jsx("div",{className:"text-lg font-bold text-purple-600",children:e.weekActivities}),t.jsx("div",{className:"text-xs text-purple-600",children:"This Week"})]}),t.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded",children:[t.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[e.successRate,"%"]}),t.jsx("div",{className:"text-xs text-orange-600",children:"Success Rate"})]})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(g,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("span",{children:["Most Active: ",e.mostActiveSection.replace("_"," ")]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(T,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("span",{children:["Last: ",y.formatDateTime(e.lastActivity)]})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:Object.entries(e.deviceTypes).map(([e,s])=>t.jsxs("div",{className:"flex items-center gap-1",children:[ge(e),t.jsx("span",{className:"text-xs",children:s})]},e))})]})]},e.userId))})})]})}),t.jsx(f,{value:"activities",children:t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsx(n,{children:"All Activities"}),t.jsxs(o,{children:["Complete activity log with advanced filtering (",pe.length," activities shown)"]})]}),t.jsx(x,{children:t.jsx("div",{className:"border rounded-lg",children:t.jsxs(U,{children:[t.jsx(k,{children:t.jsxs(M,{children:[t.jsx(W,{children:"Time"}),t.jsx(W,{children:"User"}),t.jsx(W,{children:"Action"}),t.jsx(W,{children:"Section"}),t.jsx(W,{children:"Details"}),t.jsx(W,{children:"Device"})]})}),t.jsx(P,{children:pe.slice(0,100).map(e=>{var s,i;return t.jsxs(M,{children:[t.jsx(_,{className:"text-sm",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(T,{className:"h-3 w-3 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{children:y.formatDateTime(e.timestamp).split(" ")[1]}),t.jsx("div",{className:"text-xs text-muted-foreground",children:y.formatDateTime(e.timestamp).split(" ")[0]})]})]})}),t.jsx(_,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(b,{className:"h-3 w-3 text-muted-foreground"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm",children:e.userName}),t.jsx("div",{className:"text-xs text-muted-foreground",children:e.userRole})]})]})}),t.jsx(_,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[Ne(e.action),t.jsx(h,{variant:"outline",children:e.action})]})}),t.jsx(_,{children:t.jsx(h,{className:fe(e.section),variant:"outline",children:e.section.replace("_"," ")})}),t.jsxs(_,{className:"max-w-md",children:[t.jsx("p",{className:"text-sm truncate",children:e.details}),e.entityName&&t.jsx("p",{className:"text-xs text-muted-foreground",children:e.entityName})]}),t.jsx(_,{children:t.jsxs("div",{className:"flex items-center gap-1",children:[ge((null==(s=e.metadata)?void 0:s.deviceType)||"desktop"),t.jsx("span",{className:"text-xs",children:(null==(i=e.metadata)?void 0:i.browserName)||"Unknown"})]})})]},e.id)})})]})})})]})}),t.jsx(f,{value:"analytics",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsx(n,{children:"Section Usage"}),t.jsx(o,{children:"Activity distribution across system sections"})]}),t.jsx(x,{children:t.jsx("div",{className:"space-y-3",children:Object.entries(Y.reduce((e,s)=>(e[s.section]=(e[s.section]||0)+1,e),{})).sort(([,e],[,s])=>s-e).map(([e,s])=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(h,{className:fe(e),variant:"outline",children:e.replace("_"," ")})}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium",children:s}),t.jsxs("div",{className:"text-xs text-muted-foreground",children:[(s/Y.length*100).toFixed(1),"%"]})]})]},e))})})]}),t.jsxs(r,{children:[t.jsxs(c,{children:[t.jsx(n,{children:"Device & Browser Usage"}),t.jsx(o,{children:"User device and browser preferences"})]}),t.jsx(x,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Device Types"}),t.jsx("div",{className:"space-y-2",children:Object.entries(Y.reduce((e,s)=>{var t;const i=(null==(t=s.metadata)?void 0:t.deviceType)||"desktop";return e[i]=(e[i]||0)+1,e},{})).map(([e,s])=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[ge(e),t.jsx("span",{className:"capitalize",children:e})]}),t.jsx("span",{className:"font-medium",children:s})]},e))})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2",children:"Browsers"}),t.jsx("div",{className:"space-y-2",children:Object.entries(Y.reduce((e,s)=>{var t;const i=(null==(t=s.metadata)?void 0:t.browserName)||"Unknown";return e[i]=(e[i]||0)+1,e},{})).map(([e,s])=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(z,{className:"h-4 w-4"}),t.jsx("span",{children:e})]}),t.jsx("span",{className:"font-medium",children:s})]},e))})]})]})})]})]})})]}),t.jsx(C,{open:ce,onOpenChange:ne,children:t.jsxs(D,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[t.jsxs(L,{children:[t.jsxs(R,{className:"flex items-center gap-2",children:[t.jsx(b,{className:"h-5 w-5"}),null==de?void 0:de.userName," - Detailed Activity History"]}),t.jsxs(S,{children:["Complete activity history and analytics for ",null==de?void 0:de.userName," (",null==de?void 0:de.userRole,")"]})]}),de&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:de.totalActivities}),t.jsx("div",{className:"text-sm text-blue-600",children:"Total Activities"})]}),t.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:de.todayActivities}),t.jsx("div",{className:"text-sm text-green-600",children:"Today"})]}),t.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:de.weekActivities}),t.jsx("div",{className:"text-sm text-purple-600",children:"This Week"})]}),t.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[t.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[de.successRate,"%"]}),t.jsx("div",{className:"text-sm text-orange-600",children:"Success Rate"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Recent Activities (Last 20)"}),t.jsx("div",{className:"border rounded-lg",children:t.jsxs(U,{children:[t.jsx(k,{children:t.jsxs(M,{children:[t.jsx(W,{children:"Time"}),t.jsx(W,{children:"Action"}),t.jsx(W,{children:"Section"}),t.jsx(W,{children:"Details"})]})}),t.jsx(P,{children:de.recentActivities.map(e=>t.jsxs(M,{children:[t.jsx(_,{className:"text-sm",children:y.formatDateTime(e.timestamp)}),t.jsx(_,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[Ne(e.action),t.jsx(h,{variant:"outline",children:e.action})]})}),t.jsx(_,{children:t.jsx(h,{className:fe(e.section),variant:"outline",children:e.section.replace("_"," ")})}),t.jsx(_,{className:"max-w-md",children:t.jsx("p",{className:"text-sm truncate",children:e.details})})]},e.id))})]})})]})]})]})})]})};export{$ as default};
