const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DatabaseManager-DSqM9OXw.js","assets/Floor1Table-CJw2rxss.js","assets/index-BmUpYGrm.js","assets/vendor-vN6PtkFd.js","assets/charts-XrXYWaKo.js","assets/utils-DhcIvS4g.js","assets/index-wQIKT8W8.css","assets/Floor2Table-BV_QDsVu.js","assets/CarInventoryTable-DhKHS77Q.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,r=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(r,a,t)=>a in r?e(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t,i=(e,r)=>{for(var a in r||(r={}))s.call(r,a)&&n(e,a,r[a]);if(t)for(var a of t(r))o.call(r,a)&&n(e,a,r[a]);return e},l=(e,t)=>r(e,a(t)),d=(e,r,a)=>new Promise((t,s)=>{var o=e=>{try{i(a.next(e))}catch(r){s(r)}},n=e=>{try{i(a.throw(e))}catch(r){s(r)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,n);i((a=a.apply(e,r)).next())});import{j as c,k as m,X as u,l as p,a1 as h,b as g,Q as v,O as x,C as j,g as b,h as y,a as f,e as w,n as N,m as C,t as S,y as D,z as I,E as P,F,L as O,I as _}from"./index-BmUpYGrm.js";import{r as k}from"./vendor-vN6PtkFd.js";import{V as E}from"./VinScannerDialog-C38X97Jl.js";import{T as V,a as T}from"./TestDriveSelectionDialog-BapOPyU0.js";import{E as M,M as A}from"./MoveCarDialog-DOaKAUng.js";import{A as L,P as U}from"./PdiChecklistPdf-B4FKiplK.js";import{C as $}from"./CarStatusSelectionDialog-BKEPwv76.js";import{E as q,I as R}from"./ITSoftwareUpdateDialog-CuoSWa5I.js";import{C as J}from"./CustomsManagementDialog-CpmILlI3.js";import{T as z,a as B,b as W,c as G,d as H,e as Y}from"./table-BEISn_Te.js";import{S as Q}from"./SmartActionDropdown-CocWn_7w.js";import{T as K}from"./table-search-Bl4Inyz2.js";import{S as X}from"./StandardWarrantyButton-EBT9bBYI.js";import{a as Z}from"./errorHandling-Dc1u_gNS.js";import{B as ee}from"./battery-zPCpHw5W.js";import{F as re}from"./fuel-DD7FDLWK.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";import"./cameraPermissionManager-D3sOAAEG.js";import"./ocrUtils-boR-SCDU.js";import"./index-dUlNy-FG.js";import"./enhancedMonzaBotService-CP3UVEVb.js";import"./camera-CKQtJJJ8.js";import"./file-text-bXPYLusF.js";import"./arrow-left-DqrDEplE.js";import"./briefcase-BNfZZfKX.js";import"./datetime-input-Dxp48WV8.js";import"./carClientLinkingService-K_T_il58.js";import"./phone-CUmdYfuI.js";import"./pen-line--cRXdmmD.js";import"./share-2-zYou0fbF.js";import"./cpu-N9C-mmK2.js";import"./x-circle-HKM8FhbF.js";import"./download-CLPHGjzE.js";import"./truck-KpDOpNzC.js";import"./smartphone-Cgftoe1I.js";import"./index-DNyRc51V.js";const ae=({isOpen:e,onClose:r,car:a,onPdiComplete:t})=>{if(!e||!a)return null;return c.jsxs(c.Fragment,{children:[c.jsx("style",{children:"\n          /* PDI Scrollbar Styles */\n          .overflow-y-auto::-webkit-scrollbar {\n            width: 8px !important;\n          }\n          \n          .overflow-y-auto::-webkit-scrollbar-track {\n            background: #f1f1f1 !important;\n            border-radius: 4px !important;\n          }\n          \n          .overflow-y-auto::-webkit-scrollbar-thumb {\n            background: #888 !important;\n            border-radius: 4px !important;\n          }\n          \n          .overflow-y-auto::-webkit-scrollbar-thumb:hover {\n            background: #555 !important;\n          }\n        "}),c.jsxs(L,{open:e,onClose:r,maxWidth:"max-w-6xl",children:[c.jsx("div",{className:"flex-shrink-0 border-b pb-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-xl font-semibold",children:["PDI Checklist - ",null==a?void 0:a.model," (",null==a?void 0:a.vinNumber,")"]}),c.jsx(m,{variant:"ghost",size:"sm",onClick:r,className:"h-6 w-6 p-0",children:c.jsx(u,{className:"h-4 w-4"})})]})}),c.jsx("div",{id:"pdi-pro","data-pdi":"pro",className:"flex-1 overflow-y-auto p-5",children:c.jsx(U,{car:a,onSave:(e,a)=>{var s,o;if(t){const r={technician:(null==(o=null==(s=a.signatures)?void 0:s.technician)?void 0:o.date)||"",notes:Object.values(a.overhauls||{}).join(", "),photos:[]};t(e,r)}r()}})})]})]})},te=()=>{const[e,r]=k.useState([]),[a,t]=k.useState(null),[s,o]=k.useState(!1),[n,L]=k.useState(!1),[U,te]=k.useState(!1),[se,oe]=k.useState(!1),[ne,ie]=k.useState(!1),[le,de]=k.useState(!1),[ce,me]=k.useState(!1),[ue,pe]=k.useState(!1),[he,ge]=k.useState(!1),[ve,xe]=k.useState(null),[je,be]=k.useState(!1),[ye,fe]=k.useState(null),[we,Ne]=k.useState(!1),[Ce,Se]=k.useState(null),[De,Ie]=k.useState(!1),[Pe,Fe]=k.useState(null),[Oe,_e]=k.useState(""),ke=e.filter(e=>{var r,a,t,s,o,n,i,l,d,c,m,u;if(!Oe.trim())return!0;const p=Oe.toLowerCase();return(null==(r=e.vinNumber)?void 0:r.toLowerCase().includes(p))||(null==(a=e.model)?void 0:a.toLowerCase().includes(p))||(null==(t=e.color)?void 0:t.toLowerCase().includes(p))||(null==(s=e.category)?void 0:s.toLowerCase().includes(p))||(null==(o=e.status)?void 0:o.toLowerCase().includes(p))||(null==(n=e.brand)?void 0:n.toLowerCase().includes(p))||(null==(i=e.clientName)?void 0:i.toLowerCase().includes(p))||(null==(l=e.clientPhone)?void 0:l.toLowerCase().includes(p))||(null==(d=e.notes)?void 0:d.toLowerCase().includes(p))||(null==(c=e.year)?void 0:c.toString().includes(p))||(null==(m=e.price)?void 0:m.toString().includes(p))||(null==(u=e.batteryPercentage)?void 0:u.toString().includes(p))}),[Ee,Ve]=k.useState({vinNumber:"",model:"Voyah Dream",brand:"Voyah",year:(new Date).getFullYear(),color:"",price:0,batteryPercentage:100,range:0,status:"available",category:"EV",customs:"not paid",pdiStatus:"pending",horsePower:0,torque:0,acceleration:"",topSpeed:0,chargingTime:"",warranty:"",location:"Showroom Floor 2"}),[Te,Me]=k.useState(0),[Ae,Le]=k.useState("");p();const Ue=()=>d(void 0,null,function*(){try{const{DatabaseManager:e}=yield h(()=>d(void 0,null,function*(){const{DatabaseManager:e}=yield import("./DatabaseManager-DSqM9OXw.js");return{DatabaseManager:e}}),__vite__mapDeps([0,1,2,3,4,5,6,7,8])),a=yield e.getFloor2Cars();if(a&&a.length>0){const e=a.map(e=>({id:e.id,vinNumber:e.vin,model:e.model,year:e.year,color:e.color,brand:e.brand,category:e.vehicle_type||"EV",price:e.selling_price||0,status:e.status||"in_stock",batteryPercentage:e.battery_percentage||100,range:e.range||520,features:[],arrivalDate:e.delivery_date||e.created_at,pdiCompleted:e.pdi_completed||!1,pdiStatus:e.pdi_completed?"completed":"pending",pdiTechnician:e.pdi_technician,pdiDate:e.pdi_date,pdiNotes:e.pdi_notes,customs:"paid"===e.custom_duty?"paid":"not paid",currentFloor:e.current_floor,notes:e.notes,lastModified:e.updated_at,warrantyStartDate:e.warranty_start_date,warrantyEndDate:e.warranty_end_date,warrantyMonthsRemaining:e.warranty_months_remaining,warrantyDaysRemaining:e.warranty_days_remaining,warrantyStatus:e.warranty_status,lastWarrantyUpdate:e.last_warranty_update,warranty_life:e.warranty_life}));r(e)}else r([])}catch(e){r([])}});k.useEffect(()=>{Ue()},[]),k.useEffect(()=>{let e=null;return d(void 0,null,function*(){const{supabase:e}=yield h(()=>d(void 0,null,function*(){const{supabase:e}=yield import("./index-BmUpYGrm.js").then(e=>e.bJ);return{supabase:e}}),__vite__mapDeps([2,3,4,5,6]));return e.channel("floor2-cars-changes").on("postgres_changes",{event:"*",schema:"public",table:"car_inventory"},e=>{"UPDATE"!==e.eventType&&"INSERT"!==e.eventType&&"DELETE"!==e.eventType||Ue()}).subscribe()}).then(r=>{e=r}),()=>{e&&h(()=>d(void 0,null,function*(){const{supabase:e}=yield import("./index-BmUpYGrm.js").then(e=>e.bJ);return{supabase:e}}),__vite__mapDeps([2,3,4,5,6])).then(({supabase:r})=>{r.removeChannel(e)})}},[]);const $e=e=>{switch(e){case"in_stock":return"bg-green-100 text-green-800";case"reserved":return"bg-yellow-100 text-yellow-800";case"sold":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},qe=e=>{switch(e){case"in_stock":return"Available";case"reserved":return"Reserved";case"sold":return"Sold";default:return e}},Re=e=>{switch(e){case"EV":return"category-ev";case"REV":return"category-rev";case"ICEV":return"category-icev";default:return"bg-gray-400 text-white"}};return c.jsxs("div",{className:"container mx-auto py-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(g,{className:"h-8 w-8"}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Showroom Floor 2"}),c.jsx("p",{className:"text-gray-600",children:"Premium upper floor display area"})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(m,{onClick:()=>oe(!0),variant:"outline",className:"flex items-center gap-2 border-green-200 text-green-700 hover:bg-green-50",children:[c.jsx(v,{className:"h-4 w-4"}),"VIN Scanner"]}),c.jsxs(m,{onClick:()=>te(!0),className:"flex items-center gap-2 bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:[c.jsx(x,{className:"h-4 w-4"}),"Add Car Manually"]})]})]}),c.jsxs(j,{children:[c.jsx(b,{children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs(y,{className:"flex items-center gap-2",children:[c.jsx(g,{className:"h-5 w-5"}),"Cars on Display (",ke.length," ",Oe?`of ${e.length}`:"",")"]}),c.jsx(K,{id:"showroom-floor2-search",value:Oe,onChange:_e,placeholder:"Search VINs, models, clients, colors...",className:"w-full sm:w-auto"})]})}),c.jsx(f,{children:c.jsx("div",{className:"rounded-md border",children:c.jsxs(z,{children:[c.jsx(B,{children:c.jsxs(W,{className:"bg-gray-50",children:[c.jsx(G,{className:"font-semibold",children:"VIN"}),c.jsx(G,{className:"font-semibold",children:"Model"}),c.jsx(G,{className:"font-semibold",children:"Category"}),c.jsx(G,{className:"font-semibold",children:"Year"}),c.jsx(G,{className:"font-semibold",children:"Color"}),c.jsx(G,{className:"font-semibold",children:"Color interior"}),c.jsx(G,{className:"font-semibold",children:"Price"}),c.jsx(G,{className:"font-semibold",children:"Status"}),c.jsx(G,{className:"font-semibold",children:"Warranty Life"}),c.jsx(G,{className:"font-semibold",children:"Battery"}),c.jsx(G,{className:"font-semibold",children:"Range"}),c.jsx(G,{className:"font-semibold",children:"Test Drive"}),c.jsx(G,{className:"font-semibold",children:"PDI"}),c.jsx(G,{className:"font-semibold",children:"Customs"}),c.jsx(G,{className:"font-semibold",children:"Software Model"}),c.jsx(G,{className:"font-semibold",children:"Actions"})]})}),c.jsx(H,{children:ke.map(e=>{var r;return c.jsxs(W,{className:"hover:bg-gray-50",children:[c.jsx(Y,{className:"font-mono text-sm",children:e.vinNumber}),c.jsx(Y,{className:"font-medium",children:e.model}),c.jsx(Y,{children:c.jsx(w,{className:Re(e.category),children:e.category})}),c.jsx(Y,{children:e.year}),c.jsx(Y,{children:e.color}),c.jsx(Y,{children:e.interiorColor||e.interior_color||"-"}),c.jsxs(Y,{className:"font-medium",children:["$",e.price.toLocaleString()]}),c.jsx(Y,{children:c.jsx(w,{className:`${$e(e.status)} cursor-pointer hover:opacity-80 transition-all hover:scale-105 active:scale-95`,onClick:r=>{r.preventDefault(),r.stopPropagation(),(e=>{xe(e),ge(!0)})(e)},title:"Click to change status",children:qe(e.status)})}),c.jsx(X,{car:e}),c.jsx(Y,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(ee,{className:"h-4 w-4"}),e.batteryPercentage,"%"]})}),c.jsx(Y,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(re,{className:"h-4 w-4"}),e.range," km"]})}),c.jsx(Y,{children:(null==(r=e.testDriveInfo)?void 0:r.isOnTestDrive)?c.jsxs(w,{className:"bg-blue-100 text-blue-800 border-blue-200",children:[c.jsx(N,{className:"mr-1 h-3 w-3"}),e.testDriveInfo.isClientTestDrive?"Client":"Employee"," Test Drive"]}):"sold"===e.status||"reserved"===e.status?c.jsx(w,{variant:"outline",className:"bg-gray-50 text-gray-500",children:"Not Available"}):c.jsx(w,{variant:"outline",className:"bg-gray-50 text-gray-500 cursor-pointer hover:bg-blue-50 hover:text-blue-600 transition-colors",onClick:r=>{r.preventDefault(),r.stopPropagation(),(e=>{o(!1),t(e),L(!0)})(e)},title:"Click to schedule test drive",children:"Available"})}),c.jsx(Y,{children:c.jsx("div",{className:"cursor-pointer",onClick:()=>(e=>{t(e),me(!0)})(e),children:c.jsx(w,{className:e.pdiCompleted?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200",children:e.pdiCompleted?c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"mr-1 text-lg",children:"☺"})," Complete"]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{className:"mr-1 text-lg",children:"☹"})," Pending"]})})})}),c.jsx(Y,{children:c.jsx(w,{variant:"paid"===e.customs?"default":"destructive",className:"cursor-pointer hover:opacity-80 transition-opacity active:scale-95",onClick:()=>(e=>{Fe(e),Ie(!0)})(e),title:"Click to manage customs payment",children:"paid"===e.customs?c.jsxs(c.Fragment,{children:[c.jsx(C,{className:"mr-1 h-4 w-4"})," paid"]}):c.jsxs(c.Fragment,{children:[c.jsx(u,{className:"mr-1 h-4 w-4"})," ",e.customs||"not paid"]})})}),c.jsx(Y,{children:c.jsx("div",{className:"flex items-center gap-1 text-xs cursor-pointer",onClick:()=>(e=>{Se(e),Ne(!0)})(e),title:"Click to manage software updates",children:e.softwareVersion?c.jsxs(c.Fragment,{children:[c.jsxs(w,{variant:"outline",className:"text-xs hover:bg-blue-50 transition-colors",children:["v",e.softwareVersion]}),e.softwareLastUpdated&&c.jsx("span",{className:"text-gray-500",children:new Date(e.softwareLastUpdated).toLocaleDateString()})]}):c.jsx(w,{variant:"secondary",className:"text-xs text-yellow-700 bg-yellow-100 hover:bg-yellow-200 transition-colors",children:"Update Needed"})})}),c.jsx(Y,{children:c.jsx(Q,{options:[{value:"details",label:"View Details"},{value:"edit",label:"Edit Car"},{value:"move",label:"Move Car",isMoveAction:!0,carId:e.id,currentFloor:"SHOWROOM_2",tableContext:"FLOOR_2"}],onAction:r=>{"details"===r?(e=>{fe(e),be(!0)})(e):"edit"===r?(t(e),ie(!0)):"move"===r&&(t(e),de(!0))},id:`actions-${e.id}`,ariaLabel:`Actions for ${e.model} ${e.vinNumber}`})})]},e.id)})})]})})})]}),c.jsx(E,{isOpen:se,onClose:()=>oe(!1),onVinScanned:e=>{Ue(),S({title:"VIN Scanned Successfully",description:`VIN ${e} has been processed for Floor 2.`})},targetLocation:"Showroom Floor 2",onCarMoved:(e,r,a)=>{S({title:"Car Moved",description:`Car moved from ${r} to ${a}`}),window.location.reload()},onCarAdded:e=>{S({title:"Car Added Successfully",description:"New car has been added to Showroom Floor 2."})}}),c.jsx(D,{open:U,onOpenChange:te,children:c.jsxs(I,{className:"sm:max-w-[600px]",children:[c.jsx(P,{children:c.jsxs(F,{className:"flex items-center gap-2",children:[c.jsx(g,{className:"h-5 w-5"}),"Add Car to Showroom Floor 2"]})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(O,{htmlFor:"vinNumber",children:"VIN Number *"}),c.jsx(_,{id:"vinNumber",value:Ee.vinNumber,onChange:e=>Ve(r=>l(i({},r),{vinNumber:e.target.value})),placeholder:"Enter VIN number",required:!0})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"model",children:"Model *"}),c.jsx(_,{id:"model",value:Ee.model,onChange:e=>Ve(r=>l(i({},r),{model:e.target.value})),placeholder:"Enter model name",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(O,{htmlFor:"year",children:"Year *"}),c.jsx(_,{id:"year",type:"number",min:"2020",max:"2030",value:Ee.year,onChange:e=>Ve(r=>l(i({},r),{year:Z(e.target.value,2024)})),required:!0})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"color",children:"Color *"}),c.jsx(_,{id:"color",value:Ee.color,onChange:e=>Ve(r=>l(i({},r),{color:e.target.value})),placeholder:"e.g., Midnight Silver",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(O,{htmlFor:"category",children:"Category *"}),c.jsxs("select",{id:"category",value:Ee.category,onChange:e=>Ve(r=>l(i({},r),{category:e.target.value})),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",required:!0,children:[c.jsx("option",{value:"EV",children:"EV (Electric Vehicle)"}),c.jsx("option",{value:"REV",children:"REV (Range Extended Vehicle)"}),c.jsx("option",{value:"ICEV",children:"ICEV (Internal Combustion Engine)"})]})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"price",children:"Price (USD) *"}),c.jsx(_,{id:"price",type:"number",min:"0",value:Ee.price,onChange:e=>Ve(r=>l(i({},r),{price:Z(e.target.value,0)})),placeholder:"e.g., 85000",required:!0})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx(O,{htmlFor:"status",children:"Status"}),c.jsxs("select",{id:"status",value:Ee.status,onChange:e=>Ve(r=>l(i({},r),{status:e.target.value})),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",children:[c.jsx("option",{value:"available",children:"Available"}),c.jsx("option",{value:"sold",children:"Sold"}),c.jsx("option",{value:"reserved",children:"Reserved"}),c.jsx("option",{value:"pending",children:"Pending"})]})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"batteryPercentage",children:"Battery %"}),c.jsx(_,{id:"batteryPercentage",type:"number",min:"0",max:"100",value:Ee.batteryPercentage,onChange:e=>Ve(r=>l(i({},r),{batteryPercentage:Z(e.target.value,85)}))})]})]}),c.jsx("div",{className:"grid grid-cols-2 gap-4",children:c.jsxs("div",{children:[c.jsx(O,{htmlFor:"range",children:"Range (km)"}),c.jsx(_,{id:"range",type:"number",min:"0",value:Ee.range,onChange:e=>Ve(r=>l(i({},r),{range:Z(e.target.value,520)})),placeholder:"e.g., 520"})]})}),c.jsxs("details",{className:"border rounded-lg p-4",children:[c.jsx("summary",{className:"font-medium cursor-pointer",children:"Technical Specifications (Optional)"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[c.jsxs("div",{children:[c.jsx(O,{htmlFor:"horsePower",children:"Horse Power"}),c.jsx(_,{id:"horsePower",type:"number",min:"0",value:Ee.horsePower,onChange:e=>Ve(r=>l(i({},r),{horsePower:Z(e.target.value,0)})),placeholder:"e.g., 408"})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"torque",children:"Torque (Nm)"}),c.jsx(_,{id:"torque",type:"number",min:"0",value:Ee.torque,onChange:e=>Ve(r=>l(i({},r),{torque:Z(e.target.value,0)})),placeholder:"e.g., 700"})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"acceleration",children:"0-100 km/h (seconds)"}),c.jsx(_,{id:"acceleration",value:Ee.acceleration,onChange:e=>Ve(r=>l(i({},r),{acceleration:e.target.value})),placeholder:"e.g., 4.5"})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"topSpeed",children:"Top Speed (km/h)"}),c.jsx(_,{id:"topSpeed",type:"number",min:"0",value:Ee.topSpeed,onChange:e=>Ve(r=>l(i({},r),{topSpeed:Z(e.target.value,0)})),placeholder:"e.g., 200"})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"chargingTime",children:"Charging Time (10-80%)"}),c.jsx(_,{id:"chargingTime",value:Ee.chargingTime,onChange:e=>Ve(r=>l(i({},r),{chargingTime:e.target.value})),placeholder:"e.g., 30 minutes"})]}),c.jsxs("div",{children:[c.jsx(O,{htmlFor:"warranty",children:"Warranty"}),c.jsx(_,{id:"warranty",value:Ee.warranty,onChange:e=>Ve(r=>l(i({},r),{warranty:e.target.value})),placeholder:"e.g., 4 years / 80,000 km"})]})]})]})]}),c.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[c.jsx(m,{variant:"outline",onClick:()=>te(!1),children:"Cancel"}),c.jsx(m,{onClick:()=>{if(!Ee.vinNumber||!Ee.model||!Ee.color)return void S({title:"Incomplete Form",description:"Please fill in VIN, model, and color"});if(e.find(e=>e.vinNumber===Ee.vinNumber))return void S({title:"Car Exists",description:"A car with this VIN is already on Floor 2"});const a=Ee.vinNumber&&Ee.model&&Ee.color&&Ee.price>0&&Ee.batteryPercentage>0&&Ee.range>0,t=l(i({id:`floor2-manual-${Date.now()}`},Ee),{status:"in_stock",category:Ee.category,customs:Ee.customs,features:[],arrivalDate:(new Date).toISOString(),pdiCompleted:a,pdiDate:a?(new Date).toISOString():void 0,pdiTechnician:a?"System Auto-Complete":void 0,pdiNotes:a?"PDI auto-completed - all required fields filled during registration":void 0});r(e=>[...e,t]),te(!1),Ve({vinNumber:"",model:"Voyah Dream",brand:"Voyah",year:(new Date).getFullYear(),color:"",price:0,batteryPercentage:100,range:0,status:"available",category:"EV",customs:"not paid",pdiStatus:"pending",horsePower:0,torque:0,acceleration:"",topSpeed:0,chargingTime:"",warranty:"",location:"Showroom Floor 2"}),S({title:"Car Added Successfully",description:`${Ee.model} added to Floor 2${a?" - PDI auto-completed":" - PDI pending"}`})},className:"bg-monza-yellow hover:bg-monza-yellow/90 text-black",children:"Add Car to Showroom"})]})]})}),a&&c.jsxs(c.Fragment,{children:[c.jsx(V,{isOpen:n,onClose:()=>{L(!1),t(null)},onSelectTestDriveType:e=>{pe(e),L(!1),requestAnimationFrame(()=>{o(!0)})},carModel:a.model,carVin:a.vinNumber}),c.jsx(T,{isOpen:s,onClose:()=>{o(!1),t(null)},car:a,onScheduleTestDrive:(e,a)=>{r(r=>r.map(r=>r.id===e?l(i({},r),{testDriveInfo:l(i({},a),{isOnTestDrive:!0})}):r)),S({title:"Test Drive Scheduled",description:(a.isClientTestDrive?"Client":"Employee")+" test drive scheduled"}),o(!1),t(null)},isClientTestDrive:ue}),c.jsx(M,{isOpen:ne,onClose:()=>{ie(!1),t(null)},car:a,onSave:(e,a)=>{r(r=>r.map(r=>r.id===e?i(i({},r),a):r))}}),c.jsx(A,{isOpen:le,onClose:()=>{de(!1),t(null)},car:a,onMoveCar:(s,o)=>{if(!a)return;const n=(new Date).toISOString(),d=e=>e.filter(e=>e.vinNumber!==a.vinNumber),c=()=>{const t=e.filter(e=>e.id!==a.id);r(t)};if("garage-schedule"===s){const e=localStorage.getItem("garageSchedule"),r=e?JSON.parse(e):{scheduledCars:[]},t={id:Date.now().toString(),vinNumber:a.vinNumber,model:a.model,brand:a.brand,year:a.year,color:a.color,status:"waiting",priority:"normal",estimatedDuration:120,notes:o||"Moved from Showroom Floor 2",clientName:a.clientName||"",clientPhone:a.clientPhone||"",arrivalTime:n,scheduledTime:n};r.scheduledCars=d(r.scheduledCars||[]),r.scheduledCars.push(t),localStorage.setItem("garageSchedule",JSON.stringify(r)),S({title:"Car Added to Garage Schedule",description:`${a.model} added to schedule.`}),c()}else if("garage"===s){const e=d(JSON.parse(localStorage.getItem("garageCars")||"[]"));e.push(l(i({},a),{id:`garage-${Date.now()}`,currentFloor:"Garage",lastModified:n})),localStorage.setItem("garageCars",JSON.stringify(e)),S({title:"Car Moved",description:`${a.model} moved to Garage Inventory.`}),c()}else if("inventory"===s){const e=d(JSON.parse(localStorage.getItem("carInventory")||"[]"));e.push(l(i({},a),{id:`inventory-${Date.now()}`,lastModified:n})),localStorage.setItem("carInventory",JSON.stringify(e)),S({title:"Car Moved",description:`${a.model} moved to Car Inventory.`}),c()}else if("floor1"===s){const e=d(JSON.parse(localStorage.getItem("showroomFloor1Cars")||"[]"));e.push(l(i({},a),{id:`floor1-${Date.now()}`,currentFloor:"Showroom Floor 1",lastModified:n})),localStorage.setItem("showroomFloor1Cars",JSON.stringify(e)),S({title:"Car Moved",description:`${a.model} moved to Showroom Floor 1.`}),c()}else{if("new-arrivals"===s)return S({title:"Not Allowed",description:"Existing cars cannot be moved to New Arrivals.",variant:"destructive"}),de(!1),void t(null);S({title:"Move Failed",description:"Unknown destination.",variant:"destructive"})}de(!1),t(null)}}),c.jsx(ae,{isOpen:ce,onClose:()=>{me(!1),t(null)},car:a,onPdiComplete:(e,a)=>{r(r=>r.map(r=>r.id===e?l(i({},r),{pdiCompleted:!0,pdiTechnician:a.technician,pdiNotes:a.notes,pdiPhotos:a.photos,pdiDate:(new Date).toISOString()}):r))}})]}),ve&&c.jsx($,{isOpen:he,onClose:()=>{ge(!1),xe(null)},car:ve,onStatusUpdate:(a,t,s)=>{var o;r(e=>e.map(e=>e.id===a?l(i(l(i({},e),{status:t}),s),{lastUpdated:(new Date).toISOString()}):e));const n=null==(o=e.find(e=>e.id===a))?void 0:o.model;S({title:"Status Updated",description:`${n} status updated to ${t}`})}}),ye&&c.jsx(q,{isOpen:je,onClose:()=>{be(!1),fe(null)},car:ye,onCarUpdate:(e,a)=>{r(r=>r.map(r=>r.id===e?i(i({},r),a):r))}}),Pe&&c.jsx(J,{open:De,onOpenChange:Ie,car:Pe,onCustomsUpdate:(e,a)=>{r(r=>{const t=r.map(r=>r.id===e?l(i(i({},r),a),{lastModified:(new Date).toISOString()}):r);try{localStorage.setItem("showroomFloor2Cars",JSON.stringify(t))}catch(s){}return t}),S({title:"Customs Updated",description:"Customs information updated successfully"})}}),c.jsx(R,{isOpen:we,onClose:()=>{Ne(!1),Se(null)},car:Ce?{vinNumber:Ce.vinNumber,model:Ce.model,currentVersion:Ce.softwareVersion,lastUpdated:Ce.softwareLastUpdated,lastUpdatedBy:Ce.softwareUpdateBy,notes:Ce.softwareUpdateNotes,needsUpdate:!Ce.softwareVersion,priority:Ce.softwareVersion?"medium":"critical"}:null,onUpdateComplete:(a,t)=>{var s;const o=null==(s=e.find(e=>e.vinNumber===a))?void 0:s.id;o&&((e,a)=>{r(r=>r.map(r=>r.id===e?l(i(i({},r),a),{lastUpdated:(new Date).toISOString()}):r)),S({title:"Software Updated",description:"Car software information has been updated"})})(o,t)}})]})};export{te as default};
