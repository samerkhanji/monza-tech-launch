const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Floor1Table-CJw2rxss.js","assets/index-BmUpYGrm.js","assets/vendor-vN6PtkFd.js","assets/charts-XrXYWaKo.js","assets/utils-DhcIvS4g.js","assets/index-wQIKT8W8.css","assets/Floor2Table-BV_QDsVu.js","assets/CarInventoryTable-DhKHS77Q.js","assets/DatabaseManager-DSqM9OXw.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,n=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&o(e,a,t[a]);if(r)for(var a of r(t))i.call(t,a)&&o(e,a,t[a]);return e},l=(e,r)=>t(e,a(r)),d=(e,t,a)=>new Promise((r,s)=>{var i=e=>{try{n(a.next(e))}catch(t){s(t)}},o=e=>{try{n(a.throw(e))}catch(t){s(t)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,o);n((a=a.apply(e,t)).next())});import{s as c,t as m,M as p,j as u,e as h,m as v,d as g,k as x,Q as y,O as b,C as f,g as j,h as N,R as w,X as _,a as C,b as D,V as S,n as k,y as I,z as P,E,F as T,L as V,I as F,Y as O,Z as U,_ as L,$ as M,a0 as A,a1 as R}from"./index-BmUpYGrm.js";import{r as $}from"./vendor-vN6PtkFd.js";import{T as B,a as z,b as q,c as W,d as Y,e as G}from"./table-BEISn_Te.js";import{S as H}from"./SmartActionDropdown-CocWn_7w.js";import{V as K}from"./VinScannerDialog-C38X97Jl.js";import{E as Q,M as J}from"./MoveCarDialog-DOaKAUng.js";import{P as Z}from"./PdiViewDialog-C6B7h77-.js";import{T as X,a as ee}from"./TestDriveSelectionDialog-BapOPyU0.js";import{C as te}from"./CarStatusSelectionDialog-BKEPwv76.js";import{k as ae,E as re,I as se}from"./ITSoftwareUpdateDialog-CuoSWa5I.js";import{t as ie}from"./testDriveService-Dw5zSlpe.js";import{T as oe}from"./table-search-Bl4Inyz2.js";import{W as ne,S as le}from"./StandardWarrantyButton-EBT9bBYI.js";import{R as de}from"./refresh-cw-C6MAcERo.js";import{B as ce}from"./battery-zPCpHw5W.js";import{F as me}from"./fuel-DD7FDLWK.js";import"./charts-XrXYWaKo.js";import"./utils-DhcIvS4g.js";import"./index-DNyRc51V.js";import"./cameraPermissionManager-D3sOAAEG.js";import"./ocrUtils-boR-SCDU.js";import"./index-dUlNy-FG.js";import"./enhancedMonzaBotService-CP3UVEVb.js";import"./camera-CKQtJJJ8.js";import"./file-text-bXPYLusF.js";import"./arrow-left-DqrDEplE.js";import"./errorHandling-Dc1u_gNS.js";import"./PdiChecklistPdf-B4FKiplK.js";import"./briefcase-BNfZZfKX.js";import"./datetime-input-Dxp48WV8.js";import"./carClientLinkingService-K_T_il58.js";import"./phone-CUmdYfuI.js";import"./pen-line--cRXdmmD.js";import"./share-2-zYou0fbF.js";import"./cpu-N9C-mmK2.js";import"./x-circle-HKM8FhbF.js";import"./download-CLPHGjzE.js";import"./truck-KpDOpNzC.js";import"./smartphone-Cgftoe1I.js";function pe(){const[e,t]=$.useState([]),[a,r]=$.useState(!0),[s,i]=$.useState(null),{subscribe:o}={connectedUsers:[],currentPageUsers:[],isConnected:!1,broadcastUpdate:()=>d(void 0,null,function*(){}),updateUserStatus:()=>d(void 0,null,function*(){}),subscribe:()=>()=>{}},m=()=>d(this,null,function*(){try{r(!0),i(null);const{data:e,error:a}=yield c.from("car_inventory").select("*").order("created_at",{ascending:!1});if(a)throw a;const s=(null==e?void 0:e.filter(e=>{const t=e.current_location,a=e.current_floor;return"CAR_INVENTORY"===t||null===t||"Inventory"===t||"INVENTORY"===a||"Inventory"===a||null===t&&null===a}))||[];t(s||[])}catch(e){const t=e instanceof Error?e.message:"Failed to fetch cars";i(t)}finally{r(!1)}});return $.useEffect(()=>{m()},[]),$.useEffect(()=>o(),[o]),{cars:e,loading:a,error:s,refetch:()=>d(this,null,function*(){yield m()}),addCar:e=>d(this,null,function*(){try{const{data:a,error:r}=yield c.from("car_inventory").insert([e]).select().single();if(r)throw r;return t(e=>[a,...e]),a}catch(a){return i(a instanceof Error?a.message:"Failed to add car"),null}}),updateCar:(e,a)=>d(this,null,function*(){try{const r=(e=>{const t={};return Object.entries(e).forEach(([e,a])=>{switch(e){case"currentFloor":t.current_floor=a;break;case"lastUpdated":case"lastModified":t.updated_at=a;break;case"vinNumber":t.vin=a;break;case"vehicleType":t.vehicle_type=a;break;case"clientName":t.client_name=a;break;case"clientPhone":t.client_phone=a;break;case"clientEmail":t.client_email=a;break;case"clientLicensePlate":t.client_license_plate=a;break;case"interiorColor":t.interior_color=a;break;case"purchasePrice":t.purchase_price=a;break;case"sellingPrice":t.selling_price=a;break;case"batteryPercentage":t.battery_percentage=a;break;case"pdiCompleted":t.pdi_completed=a;break;case"pdiTechnician":t.pdi_technician=a;break;case"pdiDate":t.pdi_date=a;break;case"pdiPhotos":t.pdi_photos=a;break;case"pdiNotes":t.pdi_notes=a;break;case"customs":t.custom_duty=a;break;case"inShowroom":t.in_showroom=a;break;case"showroomEntryDate":t.showroom_entry_date=a;break;case"showroomExitDate":t.showroom_exit_date=a;break;case"showroomNote":t.showroom_note=a;break;case"arrivalDate":t.delivery_date=a;break;case"soldDate":t.sold_date=a;break;case"expectedDeliveryDate":t.expected_delivery_date=a;break;case"testDriveInfo":t.test_drive_status=(null==a?void 0:a.isOnTestDrive)||!1;break;case"softwareVersion":t.software_version=a;break;case"softwareLastUpdated":t.software_last_updated=a;break;case"softwareUpdateBy":t.software_update_by=a;break;case"softwareUpdateNotes":t.software_update_notes=a;break;case"horsePower":t.horse_power=a;break;case"torque":t.torque=a;break;case"acceleration":t.acceleration=a;break;case"topSpeed":t.top_speed=a;break;case"chargingTime":t.charging_time=a;break;case"vehicleWarrantyExpiry":t.vehicle_warranty_expiry=a;break;case"batteryWarrantyExpiry":t.battery_warranty_expiry=a;break;case"dmsWarrantyDeadline":t.dms_warranty_deadline=a;break;case"warrantyStartDate":t.warranty_start_date=a;break;case"warrantyEndDate":t.warranty_end_date=a;break;case"warrantyMonthsRemaining":t.warranty_months_remaining=a;break;case"warrantyDaysRemaining":t.warranty_days_remaining=a;break;case"warrantyStatus":t.warranty_status=a;break;case"rangeExtenderNumber":t.range_extender_number=a;break;case"highVoltageBatteryNumber":t.high_voltage_battery_number=a;break;case"frontMotorNumber":t.front_motor_number=a;break;case"rearMotorNumber":t.rear_motor_number=a;break;case"manufacturingDate":t.manufacturing_date=a;break;case"shipmentCode":t.shipment_code=a;break;case"garageLocation":t.garage_location=a;break;case"garageStatus":t.garage_status=a;break;case"garageNotes":t.garage_notes=a;break;case"kilometersDriven":t.kilometers_driven=a;break;case"features":t.features=a;break;case"photos":t.photos=a;break;case"notes":t.notes=a;break;case"createdAt":t.created_at=a;break;default:["id","status","model","brand","year","color","category","range","arrivalDate"].includes(e)&&(t[e]=a)}}),t})(a),{data:s,error:i}=yield c.from("car_inventory").update(l(n({},r),{updated_at:(new Date).toISOString()})).eq("id",e).select().single();if(i)throw i;return t(t=>t.map(t=>t.id===e?s:t)),s}catch(r){return i(r instanceof Error?r.message:"Failed to update car"),null}}),deleteCar:e=>d(this,null,function*(){try{const{error:a}=yield c.from("car_inventory").delete().eq("id",e);if(a)throw a;return t(t=>t.filter(t=>t.id!==e)),!0}catch(a){return i(a instanceof Error?a.message:"Failed to delete car"),!1}})}}const ue=e=>{let t="in_stock";if(e.status){const a=e.status.toLowerCase();t="sold"===a||"available"===a?"sold":"reserved"===a?"reserved":"in_stock"}return{id:e.id,vinNumber:e.vin||e.vin_number||e.vinNumber,model:e.model,brand:e.brand,year:e.year,color:e.color,interiorColor:e.interior_color||e.interiorColor,category:e.vehicle_type||e.category,status:t,currentFloor:e.current_floor||e.current_location||e.currentLocation||e.currentFloor,arrivalDate:e.delivery_date||e.arrival_date||e.arrivalDate||(new Date).toISOString(),soldDate:e.sold_date||e.soldDate,reservedDate:e.reserved_date||e.reservedDate,sellingPrice:e.selling_price||e.sellingPrice,batteryPercentage:e.battery_percentage||e.batteryPercentage,pdiCompleted:e.pdi_completed||e.pdiCompleted,inShowroom:e.in_showroom||e.inShowroom,showroomNote:e.showroom_note||e.showroomNote,showroomEntryDate:e.showroom_entry_date||e.showroomEntryDate,showroomExitDate:e.showroom_exit_date||e.showroomExitDate,clientName:e.client_name||e.clientName,clientPhone:e.client_phone||e.clientPhone,clientLicensePlate:e.client_license_plate||e.clientLicensePlate,clientEmail:e.client_email||e.clientEmail,clientAddress:e.client_address||e.clientAddress,pdiTechnician:e.pdi_technician||e.pdiTechnician,pdiNotes:e.pdi_notes||e.pdiNotes,pdiPhotos:e.pdi_photos||e.pdiPhotos,pdiDate:e.pdi_date||e.pdiDate,notes:e.notes,lastUpdated:e.updated_at||e.last_updated||e.lastUpdated||(new Date).toISOString()}},he=()=>{var e;const{cars:t}=(()=>{const{cars:e,loading:t,error:a,addCar:r,updateCar:s,refetch:i}=pe(),[o,c]=$.useState([]),[p,u]=$.useState(!1);return $.useEffect(()=>{if(!t&&!p){let t=[];e&&e.length>0&&(t=e.map(ue)),c(t),u(!0)}},[e,t,p]),$.useEffect(()=>{if(p&&e&&e.length>0){const t=e.map(ue);c(t)}},[e,p]),{cars:o,loading:t,error:a,handleStatusUpdate:(e,t)=>d(void 0,null,function*(){try{const a={status:t,soldDate:"sold"===t?(new Date).toISOString():void 0,reservedDate:"reserved"===t?(new Date).toISOString():void 0,lastUpdated:(new Date).toISOString()};yield s(e,a),m({title:"Status Updated",description:`Car status updated to ${t.replace("_"," ")}.`})}catch(a){m({title:"Update Failed",description:"Failed to update car status. Please try again.",variant:"destructive"})}}),handleShowroomToggle:(e,t,a)=>d(void 0,null,function*(){try{const r={inShowroom:t,showroomNote:a,showroomEntryDate:t?(new Date).toISOString():void 0,showroomExitDate:t?void 0:(new Date).toISOString(),lastUpdated:(new Date).toISOString()};yield s(e,r),m({title:"Showroom Status Updated",description:`Car ${t?"added to":"removed from"} showroom.`})}catch(r){m({title:"Update Failed",description:"Failed to update showroom status. Please try again.",variant:"destructive"})}}),handleClientInfoSave:(e,t)=>d(void 0,null,function*(){try{const a=l(n({},t),{lastUpdated:(new Date).toISOString()});yield s(e,a),m({title:"Client Information Saved",description:"Client information has been updated successfully."})}catch(a){m({title:"Save Failed",description:"Failed to save client information. Please try again.",variant:"destructive"})}}),handlePdiComplete:(e,t)=>d(void 0,null,function*(){try{const a={pdiCompleted:!0,pdiTechnician:t.technician,pdiNotes:t.notes,pdiPhotos:t.photos,pdiDate:(new Date).toISOString(),lastUpdated:(new Date).toISOString()};yield s(e,a),m({title:"PDI Completed",description:`PDI completed successfully by ${t.technician}.`})}catch(a){m({title:"PDI Update Failed",description:"Failed to complete PDI. Please try again.",variant:"destructive"})}}),handleCarUpdate:(e,t)=>d(void 0,null,function*(){try{const a=l(n({},t),{lastUpdated:(new Date).toISOString()});yield s(e,a),m({title:"Car Updated",description:"Car information has been updated successfully."})}catch(a){m({title:"Update Failed",description:"Failed to update car information. Please try again.",variant:"destructive"})}}),addCarQuick:e=>d(void 0,null,function*(){var t;const a={vin_number:e.vinNumber,model:e.model,brand:e.brand,year:e.year,color:e.color,interior_color:e.interiorColor,category:e.category,status:e.status||"in_stock",arrival_date:e.arrivalDate||(new Date).toISOString(),selling_price:null!=(t=e.sellingPrice)?t:e.price,battery_percentage:e.batteryPercentage,pdi_completed:e.pdiCompleted,notes:e.notes};return Object.keys(a).forEach(e=>{void 0===a[e]&&delete a[e]}),yield r(a)}),loadCars:()=>d(void 0,null,function*(){try{yield i()}catch(e){m({title:"Load Failed",description:"Failed to load car inventory. Please refresh the page.",variant:"destructive"})}})}})(),[a,r]=$.useState([]),s=a.length>0?a:t.map(e=>{let t="in_stock";t="sold"===e.status?"sold":"reserved"===e.status?"reserved":"in_stock";const a=["EV","REV","ICEV"].includes(e.category)?e.category:"EV";return{id:e.id,vinNumber:e.vinNumber,model:e.model,year:e.year,color:e.color,price:e.sellingPrice||0,status:t,category:a,batteryPercentage:e.batteryPercentage||100,range:e.range||520,features:e.features||[],arrivalDate:e.arrivalDate||(new Date).toISOString(),pdiCompleted:e.pdiCompleted,pdiStatus:e.pdiCompleted?"completed":"pending",pdiTechnician:e.pdiTechnician,pdiDate:e.pdiDate,pdiNotes:e.pdiNotes,testDriveInfo:e.testDriveInfo,customs:"paid"===e.customs?"paid":"not paid",brand:e.brand,currentFloor:e.current_location||e.category,purchasePrice:e.purchase_price,clientName:e.client_name,clientPhone:e.client_phone,clientLicensePlate:e.client_license_plate,expectedDeliveryDate:e.expected_delivery_date,notes:e.notes,lastModified:e.updated_at,softwareVersion:Math.random()>.5?e.softwareVersion||"2.1.0":void 0,softwareLastUpdated:Math.random()>.5?e.softwareLastUpdated||"2024-01-15":void 0,softwareUpdateBy:Math.random()>.5?e.softwareUpdateBy||"IT Team":void 0,softwareUpdateNotes:Math.random()>.5?e.softwareUpdateNotes||"Routine update":void 0}});$.useEffect(()=>{if(t.length>0&&0===a.length){const e=t.map(e=>{let t="in_stock";t="sold"===e.status?"sold":"reserved"===e.status?"reserved":"in_stock";const a=["EV","REV","ICEV"].includes(e.category)?e.category:"EV";return{id:e.id,vinNumber:e.vinNumber,model:e.model,year:e.year,color:e.color,price:e.sellingPrice||0,status:t,category:a,batteryPercentage:e.batteryPercentage||100,range:e.range||520,features:e.features||[],arrivalDate:e.arrivalDate||(new Date).toISOString(),pdiCompleted:e.pdiCompleted,pdiStatus:e.pdiCompleted?"completed":"pending",pdiTechnician:e.pdiTechnician,pdiDate:e.pdiDate,pdiNotes:e.pdiNotes,testDriveInfo:e.testDriveInfo,customs:"paid"===e.customs?"paid":"not paid",brand:e.brand,currentFloor:e.current_location||e.category,purchasePrice:e.purchase_price,clientName:e.client_name,clientPhone:e.client_phone,clientLicensePlate:e.client_license_plate,expectedDeliveryDate:e.expected_delivery_date,notes:e.notes,lastModified:e.updated_at,softwareVersion:Math.random()>.5?e.softwareVersion||"2.1.0":void 0,softwareLastUpdated:Math.random()>.5?e.softwareLastUpdated||"2024-01-15":void 0,softwareUpdateBy:Math.random()>.5?e.softwareUpdateBy||"IT Team":void 0,softwareUpdateNotes:Math.random()>.5?e.softwareUpdateNotes||"Routine update":void 0}});r(e)}},[t,a.length]);const[i]=p(),o=i.get("filter"),[c,he]=$.useState(!1),[ve,ge]=$.useState(!1),[xe,ye]=$.useState(!1),[be,fe]=$.useState(!1),[je,Ne]=$.useState(!1),[we,_e]=$.useState(!1),[Ce,De]=$.useState(!1),[Se,ke]=$.useState(!1),[Ie,Pe]=$.useState(!1),[Ee,Te]=$.useState(!1),[Ve,Fe]=$.useState(null),[Oe,Ue]=$.useState(null),[Le,Me]=$.useState(null),[Ae,Re]=$.useState(!1),[$e,Be]=$.useState(null),[ze,qe]=$.useState(!1),[We,Ye]=$.useState(""),Ge=$.useMemo(()=>{const e=(()=>{switch(o){case"ready":return s.filter(e=>"sold"===e.status||"completed"===e.pdiStatus||"showroom"===e.currentFloor||!0===e.pdiCompleted);case"attention":return s.filter(e=>{var t,a,r;return"reserved"===e.status||"failed"===e.pdiStatus||"not paid"===e.customs||void 0===e.softwareVersion||(null==(t=e.notes)?void 0:t.toLowerCase().includes("issue"))||(null==(a=e.notes)?void 0:a.toLowerCase().includes("problem"))||(null==(r=e.notes)?void 0:r.toLowerCase().includes("repair"))});default:return s}})();if(!We.trim())return e;const t=We.toLowerCase();return e.filter(e=>{var a,r,s,i;return e.vinNumber.toLowerCase().includes(t)||e.model.toLowerCase().includes(t)||e.color.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)||e.status.toLowerCase().includes(t)||(null==(a=e.brand)?void 0:a.toLowerCase().includes(t))||(null==(r=e.clientName)?void 0:r.toLowerCase().includes(t))||(null==(s=e.clientPhone)?void 0:s.toLowerCase().includes(t))||(null==(i=e.notes)?void 0:i.toLowerCase().includes(t))||e.year.toString().includes(t)||e.price.toString().includes(t)})},[s,o,We]),[He,Ke]=$.useState({vinNumber:"",model:"Voyah Dream",year:2024,color:"",price:0,status:"available",category:"EV",batteryPercentage:100,range:520,pdiStatus:"pending",customs:"not paid",horsePower:350,torque:500,acceleration:"4.5",topSpeed:250,chargingTime:"30 minutes",warranty:"4 years / 80,000 km"}),Qe=(e,t)=>{l(n({},t),{sellingPrice:t.price,status:"available"===t.status?"in_stock":t.status,customs:"paid"===t.customs?"paid":"not_paid",softwareVersion:t.softwareVersion,softwareLastUpdated:t.softwareLastUpdated,softwareUpdateBy:t.softwareUpdateBy,softwareUpdateNotes:t.softwareUpdateNotes}),fe(!1),Me(null),m({title:"Car Updated",description:"Car details have been updated"})},Je=(e,t)=>d(void 0,null,function*(){try{const{Floor1Table:a}=yield R(()=>d(void 0,null,function*(){const{Floor1Table:e}=yield import("./Floor1Table-CJw2rxss.js");return{Floor1Table:e}}),__vite__mapDeps([0,1,2,3,4,5]));if(!(yield a.addCar(e.id,t)))throw new Error("Failed to move car to Floor 1")}catch(a){throw a}}),Ze=(e,t)=>d(void 0,null,function*(){try{const{Floor2Table:a}=yield R(()=>d(void 0,null,function*(){const{Floor2Table:e}=yield import("./Floor2Table-BV_QDsVu.js");return{Floor2Table:e}}),__vite__mapDeps([6,1,2,3,4,5]));if(!(yield a.addCar(e.id,t)))throw new Error("Failed to move car to Floor 2")}catch(a){throw a}}),Xe=(e,t)=>d(void 0,null,function*(){try{const{CarInventoryTable:a}=yield R(()=>d(void 0,null,function*(){const{CarInventoryTable:e}=yield import("./CarInventoryTable-DhKHS77Q.js");return{CarInventoryTable:e}}),__vite__mapDeps([7,1,2,3,4,5]));if(!(yield a.moveCar(e.id,"garage",t)))throw new Error("Failed to move car to Garage")}catch(a){throw a}}),et=(e,t)=>d(void 0,null,function*(){try{const{CarInventoryTable:a}=yield R(()=>d(void 0,null,function*(){const{CarInventoryTable:e}=yield import("./CarInventoryTable-DhKHS77Q.js");return{CarInventoryTable:e}}),__vite__mapDeps([7,1,2,3,4,5]));if(!(yield a.moveCar(e.id,"garage-schedule",t)))throw new Error("Failed to move car to Garage Schedule")}catch(a){throw a}}),tt=e=>{switch(e){case"available":case"in_stock":return"bg-green-100 text-green-800 border-green-200";case"sold":return"bg-blue-100 text-blue-800 border-blue-200";case"reserved":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},at=e=>{switch(e){case"available":case"in_stock":return"Available";case"reserved":return"Reserved";case"sold":return"Sold";default:return e}},rt=e=>{switch(e){case"EV":return"category-ev";case"REV":return"category-rev";case"ICEV":return"category-icev";default:return"bg-gray-400 text-white"}};return u.jsx(ne,{onSaved:()=>{},children:u.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Car Inventory"}),o&&u.jsxs(h,{variant:"outline",className:"text-sm font-medium",children:["ready"===o&&u.jsxs(u.Fragment,{children:[u.jsx(v,{className:"w-4 h-4 mr-1"}),"Ready Cars"]}),"attention"===o&&u.jsxs(u.Fragment,{children:[u.jsx(g,{className:"w-4 h-4 mr-1"}),"Need Attention"]})]})]}),u.jsxs("p",{className:"text-gray-600 mt-1",children:["ready"===o&&"Cars ready for delivery and completed processing","attention"===o&&"Cars requiring immediate attention or action",!o&&"Manage your car inventory and track vehicle details"]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(x,{onClick:()=>he(!0),variant:"outline",className:"flex items-center gap-2 border-green-200 text-green-700 hover:bg-green-50",children:[u.jsx(y,{className:"h-4 w-4"}),"VIN Scanner"]}),u.jsxs(x,{onClick:()=>ge(!0),className:"flex items-center gap-2 bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:[u.jsx(b,{className:"h-4 w-4"}),"Add Car Manually"]})]})]}),u.jsxs(f,{children:[u.jsxs(j,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0 pb-4",children:[u.jsxs("div",{children:[u.jsx(N,{className:"text-2xl font-bold",children:"Car Inventory"}),u.jsx(w,{children:"Manage and track all vehicles in inventory"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs(x,{variant:"outline",size:"sm",onClick:()=>{window.location.reload()},className:"flex items-center gap-2",children:[u.jsx(de,{className:"h-4 w-4"}),"Refresh"]}),u.jsxs(x,{onClick:()=>he(!0),className:"bg-monza-yellow text-monza-black hover:bg-monza-yellow/80",children:[u.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Car"]})]})]}),u.jsx("div",{className:"px-6 pb-4",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsx("div",{className:"flex items-center gap-2",children:o&&u.jsxs(x,{variant:"outline",size:"sm",onClick:()=>window.location.href="/car-inventory",className:"text-xs",children:[u.jsx(_,{className:"h-3 w-3 mr-1"}),"Clear Filter"]})}),u.jsx(oe,{value:We,onChange:Ye,placeholder:"Search VINs, models, clients, colors...",className:"w-full sm:w-auto"})]})}),u.jsx(C,{children:u.jsxs("div",{className:"rounded-md border",children:[u.jsx("div",{className:"px-4 py-2 border-b bg-gray-50",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(D,{className:"h-4 w-4"}),u.jsxs("span",{className:"font-medium",children:["ready"===o&&`Ready Cars (${Ge.length})`,"attention"===o&&`Cars Needing Attention (${Ge.length})`,!o&&`Car Inventory (${Ge.length} ${We?`of ${s.length}`:""})`]})]}),u.jsxs("div",{className:"text-sm text-gray-500",children:[s.length," total vehicles"]})]})}),u.jsxs(B,{children:[u.jsx(z,{children:u.jsxs(q,{className:"bg-gray-50",children:[u.jsx(W,{className:"font-semibold",children:"VIN"}),u.jsx(W,{className:"font-semibold",children:"Model"}),u.jsx(W,{className:"font-semibold",children:"Category"}),u.jsx(W,{className:"font-semibold",children:"Year"}),u.jsx(W,{className:"font-semibold",children:"Color"}),u.jsx(W,{className:"font-semibold",children:"Price"}),u.jsx(W,{className:"font-semibold",children:"Status"}),u.jsx(W,{className:"font-semibold",children:"Warranty Life"}),u.jsx(W,{className:"font-semibold",children:"Battery"}),u.jsx(W,{className:"font-semibold",children:"Range Capacity"}),u.jsx(W,{className:"font-semibold",children:"Km Driven"}),u.jsx(W,{className:"font-semibold",children:"Test Drive"}),u.jsx(W,{className:"font-semibold",children:"PDI"}),u.jsx(W,{className:"font-semibold",children:"Customs"}),u.jsx(W,{className:"font-semibold",children:"Software Model"}),u.jsx(W,{className:"font-semibold",children:"Actions"})]})}),u.jsx(Y,{children:Ge.map(e=>{var t;return u.jsxs(q,{className:"hover:bg-gray-50",children:[u.jsx(G,{className:"font-mono text-sm",children:e.vinNumber}),u.jsx(G,{className:"font-medium",children:e.model}),u.jsx(G,{children:u.jsx(h,{className:rt(e.category),children:e.category})}),u.jsx(G,{children:e.year}),u.jsx(G,{children:e.color}),u.jsxs(G,{className:"font-medium",children:["$",e.price.toLocaleString()]}),u.jsx(G,{children:u.jsx(h,{className:`${tt(e.status)} cursor-pointer hover:opacity-80 transition-all hover:scale-105 active:scale-95`,onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{Fe(e),Pe(!0)})(e)},title:"Click to change status",children:at(e.status)})}),u.jsx(le,{car:e}),u.jsx(G,{children:u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(ce,{className:"h-4 w-4"}),e.batteryPercentage,"%"]})}),u.jsx(G,{children:u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(me,{className:"h-4 w-4"}),e.range," km"]})}),u.jsx(G,{children:u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(S,{className:"h-4 w-4"}),ae.getKilometersDriven(e.id)," km"]})}),u.jsx(G,{children:(null==(t=e.testDriveInfo)?void 0:t.isOnTestDrive)?u.jsxs(h,{className:"bg-blue-100 text-blue-800 border-blue-200 cursor-pointer hover:opacity-80 transition-opacity",onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{const t=s.find(t=>t.id===e);if(!t||!t.testDriveInfo)return;const a={isOnTestDrive:t.testDriveInfo.isOnTestDrive,testDriveStartTime:t.testDriveInfo.testDriveStartTime,testDriverName:t.testDriveInfo.testDriverName,testDriverPhone:t.testDriveInfo.testDriverPhone,testDriverLicense:t.testDriveInfo.testDriverLicense,notes:t.testDriveInfo.notes,purpose:t.testDriveInfo.purpose||"Test drive",isClientTestDrive:t.testDriveInfo.isClientTestDrive||!1,loggedBy:t.testDriveInfo.loggedBy||"System",loggedByName:t.testDriveInfo.loggedByName||"System User",loggedAt:t.testDriveInfo.loggedAt||(new Date).toISOString(),emergencyContact:t.testDriveInfo.emergencyContact,emergencyContactPhone:t.testDriveInfo.emergencyContactPhone,vehicleVin:t.vinNumber,vehicleModel:t.model},r=ie.endTestDrive(a),i=ie.addToHistory(t,r);Qe(0,{testDriveInfo:void 0,testDriveHistory:i.testDriveHistory});const o=ie.formatDuration(r.actualDuration||0);m({title:"Test Drive Completed",description:`Test drive completed in ${o}. Added to vehicle history.`})})(e.id)},title:"Click to end test drive",children:[u.jsx(k,{className:"mr-1 h-3 w-3"}),e.testDriveInfo.isClientTestDrive?"Client":"Employee"," Test Drive"]}):"sold"===e.status||"reserved"===e.status?u.jsx(h,{variant:"outline",className:"bg-gray-50 text-gray-500",children:"Not Available"}):u.jsx(h,{variant:"outline",className:"bg-gray-50 text-gray-500 cursor-pointer hover:bg-blue-50 hover:text-blue-600 transition-colors",onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{Me(e),De(!0)})(e)},title:"Click to schedule test drive",children:"Available"})}),u.jsx(G,{children:u.jsx("div",{className:"cursor-pointer",onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{Me(e),ke(!0)})(e)},children:u.jsx(h,{className:e.pdiCompleted?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200",children:e.pdiCompleted?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"mr-1 text-lg",children:"☺"})," Complete"]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"mr-1 text-lg",children:"☹"})," Pending"]})})})}),u.jsx(G,{children:u.jsx(h,{variant:"paid"===e.customs?"default":"destructive",className:"cursor-pointer hover:opacity-80 transition-opacity active:scale-95",onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{Ue(e),Te(!0)})(e)},title:"Click to manage customs payment",children:"paid"===e.customs?u.jsxs(u.Fragment,{children:[u.jsx(v,{className:"mr-1 h-4 w-4"})," paid"]}):u.jsxs(u.Fragment,{children:[u.jsx(_,{className:"mr-1 h-4 w-4"})," ",e.customs||"not paid"]})})}),u.jsx(G,{children:u.jsx("div",{className:"flex items-center gap-1 text-xs cursor-pointer hover:scale-105 transition-transform",onClick:t=>{t.preventDefault(),t.stopPropagation(),(e=>{Be(e),qe(!0)})(e)},title:"Click to manage software updates",children:e.softwareVersion?u.jsxs(u.Fragment,{children:[u.jsxs(h,{variant:"outline",className:"text-xs hover:bg-blue-50 transition-colors cursor-pointer",children:["v",e.softwareVersion]}),e.softwareLastUpdated&&u.jsx("span",{className:"text-gray-500",children:new Date(e.softwareLastUpdated).toLocaleDateString()})]}):u.jsx(h,{variant:"secondary",className:"text-xs text-yellow-700 bg-yellow-100 hover:bg-yellow-200 transition-colors cursor-pointer border border-yellow-300 hover:border-yellow-400 active:scale-95",children:"Update Needed"})})}),u.jsx(G,{children:u.jsx(H,{options:[{value:"details",label:"View Details"},{value:"edit",label:"Edit Car"},{value:"move",label:"Move Car",isMoveAction:!0,carId:e.id,currentFloor:"CAR_INVENTORY",tableContext:"CAR_INVENTORY"}],onAction:t=>{"details"===t?(e=>{Me(e),ye(!0)})(e):"edit"===t?(Me(e),fe(!0)):"move"===t&&(Me(e),Ne(!0))},ariaLabel:`Actions for ${e.model} ${e.vinNumber}`})})]},e.id)})})]})]})})]}),u.jsx(K,{isOpen:c,onClose:()=>he(!1),onVinScanned:e=>{he(!1),m({title:"VIN Scanned",description:`VIN ${e} detected`})},targetLocation:"Inventory",onCarMoved:(e,t,a)=>{m({title:"Car Moved",description:`Car moved from ${t} to ${a}`})},onCarAdded:e=>{m({title:"Car Added",description:"Car has been added to inventory"})},onPdiAction:e=>{const t={id:e.id,vinNumber:e.vin_number,model:e.model,year:e.year,color:e.color,price:e.selling_price,status:e.status,category:e.category,batteryPercentage:e.battery_percentage||100,range:e.range_km||0,features:[],arrivalDate:e.arrival_date,pdiCompleted:e.pdi_completed,pdiTechnician:e.pdi_technician,pdiDate:e.pdi_date,pdiNotes:e.notes,testDriveInfo:{isOnTestDrive:e.test_drive_status},customs:"not_paid"===e.customs?"not paid":"paid"===e.customs?"paid":"not paid"};Me(t),ke(!0),he(!1)}}),u.jsx(I,{open:xe,onOpenChange:ye,children:u.jsxs(P,{className:"sm:max-w-4xl max-h-[80vh] bg-white border border-gray-300 shadow-xl car-status-dialog flex flex-col",style:{height:"80vh"},children:[u.jsx(E,{className:"border-b border-gray-200 pb-4 flex-shrink-0",children:u.jsxs(T,{className:"flex items-center gap-2",children:[u.jsx(D,{className:"h-5 w-5"}),"Vehicle Details - ",null==Le?void 0:Le.model]})}),Le&&u.jsx("div",{className:"flex-1 overflow-y-scroll pr-2",style:{height:"calc(80vh - 120px)",scrollbarWidth:"auto",scrollbarColor:"#ffd700 #f8fafc"},children:u.jsxs("div",{className:"space-y-6 pt-4 pb-20",style:{paddingRight:"10px"},children:[u.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{className:"text-xs text-gray-500",children:"VIN Number"}),u.jsx("p",{className:"font-mono text-sm font-medium",children:Le.vinNumber})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-xs text-gray-500",children:"Model"}),u.jsx("p",{className:"font-medium",children:Le.model})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-xs text-gray-500",children:"Brand"}),u.jsx("p",{className:"font-medium",children:Le.brand||"Voyah"})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-xs text-gray-500",children:"Year"}),u.jsx("p",{className:"font-medium",children:Le.year})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b pb-2",children:"Basic Information"}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Color"}),u.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u.jsx("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:null==(e=Le.color)?void 0:e.toLowerCase()}}),u.jsx("p",{className:"font-medium",children:Le.color})]})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Category"}),u.jsx(h,{className:"mt-1",variant:"outline",children:Le.category})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Current Location"}),u.jsx("p",{className:"font-medium mt-1",children:Le.currentFloor||"Main Inventory"})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Arrival Date"}),u.jsx("p",{className:"font-medium mt-1",children:Le.arrivalDate||"N/A"})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b pb-2",children:"Technical Specifications"}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Battery Level"}),u.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${Le.batteryPercentage}%`}})}),u.jsxs("span",{className:"text-sm font-medium",children:[Le.batteryPercentage,"%"]})]})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Range"}),u.jsxs("p",{className:"font-medium mt-1",children:[Le.range," km"]})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b pb-2",children:"Pricing Information"}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Selling Price"}),u.jsxs("p",{className:"font-bold text-lg text-green-600",children:["$",Le.price.toLocaleString()]})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Purchase Price"}),u.jsxs("p",{className:"font-medium",children:["$",(Le.purchasePrice||0).toLocaleString()]})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b pb-2",children:"Features & Equipment"}),Le.features&&Le.features.length>0?u.jsx("div",{className:"flex flex-wrap gap-2",children:Le.features.map((e,t)=>u.jsx(h,{variant:"secondary",className:"text-xs",children:e},t))}):u.jsx("p",{className:"text-gray-500 italic",children:"No features listed"})]})]}),Le.clientName&&u.jsxs("div",{className:"space-y-4 bg-amber-50 border border-amber-200 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b border-amber-200 pb-2",children:"Client Information"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Client Name"}),u.jsx("p",{className:"font-medium",children:Le.clientName})]}),u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Phone Number"}),u.jsx("p",{className:"font-medium",children:Le.clientPhone||"N/A"})]}),Le.clientLicensePlate&&u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"License Plate"}),u.jsx("p",{className:"font-medium",children:Le.clientLicensePlate})]}),Le.expectedDeliveryDate&&u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Expected Delivery"}),u.jsx("p",{className:"font-medium",children:Le.expectedDeliveryDate})]})]})]}),Le.notes&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b pb-2",children:"Additional Notes"}),u.jsx("div",{className:"bg-gray-50 border rounded-lg p-4",children:u.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:Le.notes})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-lg border-b pb-2",children:"Important Dates"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Arrival Date"}),u.jsx("p",{className:"font-medium",children:Le.arrivalDate||"N/A"})]}),Le.pdiDate&&u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"PDI Completed"}),u.jsx("p",{className:"font-medium",children:Le.pdiDate})]}),Le.lastModified&&u.jsxs("div",{children:[u.jsx(V,{className:"text-sm text-gray-600",children:"Last Updated"}),u.jsx("p",{className:"font-medium",children:Le.lastModified})]})]})]})]})})]})}),u.jsx(I,{open:ve,onOpenChange:ge,children:u.jsxs(P,{className:"sm:max-w-[600px]",children:[u.jsx(E,{children:u.jsxs(T,{className:"flex items-center gap-2",children:[u.jsx(D,{className:"h-5 w-5"}),"Add Car to Inventory"]})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{htmlFor:"vinNumber",children:"VIN Number *"}),u.jsx(F,{id:"vinNumber",value:He.vinNumber,onChange:e=>Ke(t=>l(n({},t),{vinNumber:e.target.value})),placeholder:"Enter VIN number",required:!0})]}),u.jsxs("div",{children:[u.jsx(V,{htmlFor:"model",children:"Model *"}),u.jsxs("select",{id:"model",value:He.model,onChange:e=>Ke(t=>l(n({},t),{model:e.target.value})),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",required:!0,children:[u.jsx("option",{value:"Voyah Dream",children:"Voyah Dream"}),u.jsx("option",{value:"Voyah Free",children:"Voyah Free"}),u.jsx("option",{value:"Voyah Passion",children:"Voyah Passion"}),u.jsx("option",{value:"Voyah Free 318",children:"Voyah Free 318"}),u.jsx("option",{value:"Mhero",children:"Mhero"})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{htmlFor:"year",children:"Year *"}),u.jsx(F,{id:"year",type:"number",min:"2020",max:"2030",value:He.year,onChange:e=>Ke(t=>l(n({},t),{year:parseInt(e.target.value)})),required:!0})]}),u.jsxs("div",{children:[u.jsx(V,{htmlFor:"color",children:"Color *"}),u.jsx(F,{id:"color",value:He.color,onChange:e=>Ke(t=>l(n({},t),{color:e.target.value})),placeholder:"e.g., Midnight Silver",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{htmlFor:"category",children:"Category *"}),u.jsxs(O,{value:He.category,onValueChange:e=>Ke(t=>l(n({},t),{category:e})),children:[u.jsx(U,{children:u.jsx(L,{placeholder:"Select category"})}),u.jsxs(M,{children:[u.jsx(A,{value:"EV",children:"EV (Electric Vehicle)"}),u.jsx(A,{value:"REV",children:"REV (Range Extended Vehicle)"}),u.jsx(A,{value:"ICEV",children:"ICEV (Internal Combustion Engine)"})]})]})]}),u.jsxs("div",{children:[u.jsx(V,{htmlFor:"price",children:"Price (USD) *"}),u.jsx(F,{id:"price",type:"number",min:"0",value:He.price,onChange:e=>Ke(t=>l(n({},t),{price:parseInt(e.target.value)})),placeholder:"e.g., 85000",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(V,{htmlFor:"status",children:"Status"}),u.jsxs("select",{id:"status",value:He.status,onChange:e=>Ke(t=>l(n({},t),{status:e.target.value})),className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",children:[u.jsx("option",{value:"available",children:"Available"}),u.jsx("option",{value:"sold",children:"Sold"}),u.jsx("option",{value:"reserved",children:"Reserved"}),u.jsx("option",{value:"pending",children:"Pending"})]})]}),u.jsxs("div",{children:[u.jsx(V,{htmlFor:"batteryPercentage",children:"Battery %"}),u.jsx(F,{id:"batteryPercentage",type:"number",min:"0",max:"100",value:He.batteryPercentage,onChange:e=>Ke(t=>l(n({},t),{batteryPercentage:parseInt(e.target.value)}))})]})]}),u.jsx("div",{className:"grid grid-cols-2 gap-4",children:u.jsxs("div",{children:[u.jsx(V,{htmlFor:"range",children:"Range (km)"}),u.jsx(F,{id:"range",type:"number",min:"0",value:He.range,onChange:e=>Ke(t=>l(n({},t),{range:parseInt(e.target.value)})),placeholder:"e.g., 520"})]})})]}),u.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[u.jsx(x,{variant:"outline",onClick:()=>ge(!1),children:"Cancel"}),u.jsx(x,{onClick:()=>{const e=l(n({},He),{id:Date.now().toString(),arrivalDate:(new Date).toISOString()});ge(!1),Ke({vinNumber:"",model:"Voyah Dream",year:2024,color:"",price:0,status:"available",category:"EV",batteryPercentage:100,range:520,pdiStatus:"pending",customs:"not paid",horsePower:350,torque:500,acceleration:"4.5",topSpeed:250,chargingTime:"30 minutes",warranty:"4 years / 80,000 km"}),m({title:"Car Added",description:`${e.model} has been added to inventory`})},className:"bg-monza-yellow text-monza-black hover:bg-monza-yellow/90",children:"Add Car"})]})]})}),Le&&u.jsx(Q,{isOpen:be,onClose:()=>{fe(!1),Me(null)},car:Le,onSave:Qe}),Le&&u.jsx(J,{isOpen:je,onClose:()=>{Ne(!1),Me(null)},car:Le,onMoveCar:(e,t)=>d(void 0,null,function*(){if(Le)try{const s=n({},Le);switch(e){case"floor1":yield Je(s,t);break;case"floor2":yield Ze(s,t);break;case"garage":yield Xe(s,t);break;case"garage-schedule":yield et(s,t)}try{const{DatabaseManager:a}=yield R(()=>d(void 0,null,function*(){const{DatabaseManager:e}=yield import("./DatabaseManager-DSqM9OXw.js");return{DatabaseManager:e}}),__vite__mapDeps([8,0,1,2,3,4,5,6,7]));if(!(yield a.moveCar(s.id,e,t)))throw new Error("Failed to move car using DatabaseManager")}catch(a){m({title:"Warning",description:"Car was moved but database update failed. Please refresh the page.",variant:"destructive"})}let i;switch(r(e=>e.filter(e=>e.id!==s.id)),e){case"floor1":i="SHOWROOM_1";break;case"floor2":i="SHOWROOM_2";break;case"garage":case"garage-schedule":i="GARAGE";break;default:i="INVENTORY"}Ne(!1),Me(null),yield new Promise(e=>setTimeout(e,100));const o={floor1:"Showroom Floor 1",floor2:"Showroom Floor 2",garage:"Garage Inventory","garage-schedule":"Garage Schedule"},l={floor1:"/showroom-floor1",floor2:"/showroom-floor2",garage:"/inventory-garage","garage-schedule":"/garage-schedule"}[e];m({title:"Car Moved Successfully",description:`${s.model} has been moved to ${o[e]||e}.`,duration:4e3}),l&&setTimeout(()=>{m({title:"View Car in New Location",description:`Click to view ${s.model} on the ${o[e]||e} page`,action:u.jsx(x,{variant:"outline",size:"sm",onClick:()=>window.open(l,"_blank"),className:"ml-2",children:"View Car"})})},1500)}catch(a){m({title:"Move Failed",description:"Failed to move car. Please try again.",variant:"destructive"})}})}),Le&&u.jsx(Z,{isOpen:Se,onClose:()=>{ke(!1),Me(null)},car:Le,onPdiComplete:(e,t)=>{Qe(0,{pdiCompleted:!0,pdiTechnician:t.technician,pdiNotes:t.notes,pdiPhotos:t.photos,pdiDate:(new Date).toISOString()}),m({title:"PDI Completed",description:"Pre-Delivery Inspection has been completed successfully."})}}),Le&&u.jsx(X,{isOpen:Ce,onClose:()=>{De(!1),Me(null)},onSelectTestDriveType:e=>{Re(e),De(!1),_e(!0)},carModel:Le.model,carVin:Le.vinNumber}),Le&&u.jsx(ee,{isOpen:we,onClose:()=>{_e(!1),Me(null)},car:l(n({},Le),{currentFloor:Le.currentFloor||"Inventory"}),onScheduleTestDrive:(e,t)=>{Qe(0,{testDriveInfo:l(n({},t),{isOnTestDrive:!0})}),m({title:"Test Drive Scheduled",description:(t.isClientTestDrive?"Client":"Employee")+" test drive scheduled"}),_e(!1),Me(null)},isClientTestDrive:Ae}),Ve&&u.jsx(te,{isOpen:Ie,onClose:()=>{Pe(!1),Fe(null)},car:Ve,onStatusUpdate:(e,t,a)=>{var r;Qe(0,l(n({status:t},a),{lastUpdated:(new Date).toISOString()}));const i=null==(r=s.find(t=>t.id===e))?void 0:r.model;m({title:"Car Status Updated",description:`${i} status updated to ${t.replace("_"," ")}`})}}),Oe&&u.jsx(re,{isOpen:Ee,onClose:()=>{Te(!1),Ue(null)},car:Oe,onCarUpdate:(e,t)=>{}}),u.jsx(se,{isOpen:ze,onClose:()=>{qe(!1),Be(null)},car:$e?{vinNumber:$e.vinNumber,model:$e.model,currentVersion:$e.softwareVersion,lastUpdated:$e.softwareLastUpdated,lastUpdatedBy:$e.softwareUpdateBy,notes:$e.softwareUpdateNotes,needsUpdate:!$e.softwareVersion,priority:$e.softwareVersion?"medium":"critical"}:null,onUpdateComplete:(e,t)=>{var a;const r=null==(a=s.find(t=>t.vinNumber===e))?void 0:a.id;r&&(Qe(0,t),m({title:"Software Updated",description:"Software updated successfully"}))}})]})})};export{he as default};
