var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(s,t,r)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,n=(e,s)=>{for(var t in s||(s={}))i.call(s,t)&&l(e,t,s[t]);if(r)for(var t of r(s))a.call(s,t)&&l(e,t,s[t]);return e},d=(e,r)=>s(e,t(r));import{j as o,L as c,n as m,k as u,X as x,be as h,y as p,z as g,E as b,F as j,I as f,U as v,d as y,H as N,t as w,O as k,C as S,e as C}from"./index-BmUpYGrm.js";import{r as E}from"./vendor-vN6PtkFd.js";import{C as D}from"./calendar-DQ6SJzpq.js";import{C as P}from"./checkbox-CbEst83x.js";import{D as $}from"./download-CLPHGjzE.js";import{B as T}from"./bell-2Hz6KiRm.js";import{f as M}from"./utils-DhcIvS4g.js";import"./charts-XrXYWaKo.js";import"./chevron-left-D5y0IByA.js";const O=({label:e,value:s,onChange:t,required:r=!1,showTime:i=!0})=>{const[a,l]=E.useState(!1),[n,d]=E.useState(s),[h,p]=E.useState("12:00"),[g,b]=E.useState(new Date),j=E.useRef(null),f=E.useRef(null),v=e.toLowerCase().includes("reservation");E.useEffect(()=>{s&&(d(s),p(`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`))},[s]),E.useEffect(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&l(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),E.useEffect(()=>{const e=e=>{"Escape"===e.key&&a&&l(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a]);const y=e=>e.toLocaleDateString()+" at "+e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),N=(w=g,new Date(w.getFullYear(),w.getMonth()+1,0).getDate());var w;const k=(e=>new Date(e.getFullYear(),e.getMonth(),1).getDay())(g),S=Array.from({length:N},(e,s)=>s+1),C=Array.from({length:k},(e,s)=>s),D=new Date,P=e=>D.getDate()===e&&D.getMonth()===g.getMonth()&&D.getFullYear()===g.getFullYear(),$=e=>n&&n.getDate()===e&&n.getMonth()===g.getMonth()&&n.getFullYear()===g.getFullYear();return o.jsxs("div",{className:`relative space-y-3 p-4 ${v?"bg-blue-50 border-blue-500":"bg-green-50 border-green-500"} border-2 rounded-lg`,ref:j,children:[o.jsxs(c,{className:`text-sm font-bold ${v?"text-blue-800":"text-green-800"} flex items-center gap-2`,children:[o.jsx(m,{className:"h-4 w-4"}),e," ",r&&o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("div",{className:"space-y-2",children:o.jsx(u,{type:"button",onClick:()=>l(!a),className:`w-full px-4 py-3 border-2 ${v?"border-blue-300 hover:border-blue-500 focus:border-blue-600 focus:ring-blue-200":"border-green-300 hover:border-green-500 focus:border-green-600 focus:ring-green-200"} rounded-lg bg-white text-gray-900 text-base font-medium cursor-pointer focus:ring-2 transition-all flex items-center justify-between`,style:{minHeight:"48px",fontSize:"16px"},children:o.jsx("span",{children:n?y(n):`Select ${e}`})})}),a&&o.jsxs("div",{ref:f,className:"absolute top-full left-0 right-0 z-[9999] bg-white border-2 border-gray-800 rounded-lg shadow-2xl p-4 mt-2 min-w-[300px] max-h-[400px] overflow-y-auto custom-datetime-calendar-popup",style:{position:"absolute",top:"100%",left:"0",right:"0",zIndex:99999,backgroundColor:"#ffffff !important",background:"#ffffff !important",border:"3px solid #000000",borderRadius:"8px",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 10px 20px -5px rgba(0, 0, 0, 0.3)",padding:"16px",marginTop:"8px",minWidth:"300px",maxHeight:"400px",overflowY:"auto",opacity:"1 !important",backdropFilter:"none",filter:"none"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx(u,{type:"button",onClick:()=>b(new Date(g.getFullYear(),g.getMonth()-1)),variant:"outline",size:"sm",children:"←"}),o.jsx("span",{className:"font-semibold",children:g.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),o.jsx(u,{type:"button",onClick:()=>b(new Date(g.getFullYear(),g.getMonth()+1)),variant:"outline",size:"sm",children:"→"})]}),o.jsxs("div",{className:"grid grid-cols-7 gap-1 mb-4",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>o.jsx("div",{className:"text-center text-sm font-medium text-gray-500 p-1",children:e},e)),C.map((e,s)=>o.jsx("div",{className:"p-1"},`empty-${s}`)),S.map(e=>o.jsx(u,{type:"button",onClick:()=>(e=>{const s=new Date(g.getFullYear(),g.getMonth(),e);d(s)})(e),variant:$(e)?"default":"ghost",className:`p-1 h-8 w-8 text-sm ${P(e)?"ring-2 ring-blue-500":""} ${$(e)?"bg-blue-500 text-white":"hover:bg-gray-100"}`,children:e},e))]}),i&&o.jsxs("div",{className:"mb-4",children:[o.jsx(c,{className:"text-sm font-medium mb-2 block",children:"Time"}),o.jsx("input",{type:"time",value:h,onChange:e=>{return s=e.target.value,void p(s);var s},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(u,{onClick:()=>{if(n){const[e,s]=h.split(":").map(Number),r=new Date(n);r.setHours(e,s,0,0),t(r)}l(!1)},className:"flex-1",children:"Confirm"}),o.jsx(u,{onClick:()=>{d(void 0),p("12:00"),t(void 0)},variant:"outline",size:"sm",children:o.jsx(x,{className:"h-4 w-4"})})]})]}),n&&o.jsxs("div",{className:`p-3 ${v?"bg-blue-100 border-blue-300 text-blue-800":"bg-green-100 border-green-300 text-green-800"} border-2 rounded-lg`,children:[o.jsxs("p",{className:"text-sm font-semibold mb-1",children:["✅ SELECTED ",e.toUpperCase(),":"]}),o.jsx("p",{className:"text-lg font-bold "+(v?"text-blue-900":"text-green-900"),children:y(n)})]})]})},F=["Houssam (Owner)","Samer (Owner)","Kareem (Owner)","Mark (Garage Manager)","Lara (Assistant)","Samaya (Assistant)","Khalil (Hybrid: Sales + Garage Manager + Marketing)","Tamara (Hybrid: Sales + Marketing + Personal Assistant)","Elie (Hybrid: Technician + Sales + Marketing)"],q=["Technical","Mechanical","Electrical","Customer Service","Organization","Attention to Detail","Problem Solving","Communication","Leadership","Training"],H=({open:e,onOpenChange:s,onEventAdded:t})=>{const{addNotification:r}=h(),[i,a]=E.useState({title:"",description:"",priority:"medium",workType:"project",estimatedDuration:"",assignedEmployees:[],requiredSkills:[]}),[l,m]=E.useState();return o.jsx(p,{open:e,onOpenChange:s,children:o.jsxs(g,{className:"max-w-2xl max-h-[90vh] overflow-visible",children:[o.jsx(b,{children:o.jsx(j,{children:"Schedule New Work"})}),o.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!i.title||!l)return;const n={id:Date.now().toString(),title:i.title,date:l,createdBy:"Current User",assignedEmployees:i.assignedEmployees,description:i.description||void 0,priority:i.priority,status:"scheduled",workType:i.workType,requiredSkills:i.requiredSkills.length>0?i.requiredSkills:void 0,estimatedDuration:i.estimatedDuration?parseInt(i.estimatedDuration):void 0};t(n);const d=[...new Set([...i.assignedEmployees,"Houssam (Owner)","Samer (Owner)","Kareem (Owner)"])];d.forEach(e=>{r({title:"New Calendar Event Assignment",description:`You have been assigned to "${i.title}" scheduled for ${format(l,"PPP")} at ${format(l,"p")}. Priority: ${i.priority}`,link:"/business-calendar",assignedTo:e,eventId:n.id})}),w({title:"Event Created & Notifications Sent",description:`${i.title} has been scheduled and notifications sent to ${d.length} team members.`}),a({title:"",description:"",priority:"medium",workType:"project",estimatedDuration:"",assignedEmployees:[],requiredSkills:[]}),m(void 0),s(!1)},className:"space-y-4 overflow-visible relative",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"col-span-2",children:[o.jsx(c,{htmlFor:"title",children:"Work Title *"}),o.jsx(f,{id:"title",value:i.title,onChange:e=>a(s=>d(n({},s),{title:e.target.value})),placeholder:"Enter work title...",required:!0})]}),o.jsxs("div",{children:[o.jsx(c,{htmlFor:"workType",children:"Work Type"}),o.jsxs("select",{id:"workType",value:i.workType,onChange:e=>a(s=>d(n({},s),{workType:e.target.value})),className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer",style:{fontSize:"14px",lineHeight:"1.4",appearance:"auto"},children:[o.jsx("option",{value:"",children:"Select work type"}),o.jsx("option",{value:"meeting",children:"Meeting"}),o.jsx("option",{value:"project",children:"Project"}),o.jsx("option",{value:"training",children:"Training"}),o.jsx("option",{value:"maintenance",children:"Maintenance"}),o.jsx("option",{value:"other",children:"Other"})]})]}),o.jsxs("div",{children:[o.jsx(c,{htmlFor:"priority",children:"Priority"}),o.jsxs("select",{id:"priority",value:i.priority,onChange:e=>a(s=>d(n({},s),{priority:e.target.value})),className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-pointer",style:{fontSize:"14px",lineHeight:"1.4",appearance:"auto"},children:[o.jsx("option",{value:"",children:"Select priority"}),o.jsx("option",{value:"low",children:"Low Priority"}),o.jsx("option",{value:"medium",children:"Medium Priority"}),o.jsx("option",{value:"high",children:"High Priority"})]})]})]}),o.jsx("div",{className:"relative overflow-visible",children:o.jsx(O,{label:"Event Date & Time",value:l,onChange:m,required:!0,showTime:!0})}),o.jsxs("div",{children:[o.jsx(c,{htmlFor:"duration",children:"Estimated Duration (hours)"}),o.jsx(f,{id:"duration",type:"number",min:"0.5",step:"0.5",value:i.estimatedDuration,onChange:e=>a(s=>d(n({},s),{estimatedDuration:e.target.value})),placeholder:"e.g., 2.5"})]}),o.jsxs("div",{children:[o.jsxs(c,{className:"flex items-center gap-2",children:[o.jsx(v,{className:"h-4 w-4"}),"Assign Employees"]}),o.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 p-3 border rounded-md",children:F.map((e,s)=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(P,{id:`employee-checkbox-${e}-${s}`,checked:i.assignedEmployees.includes(e),onCheckedChange:()=>(e=>{a(s=>d(n({},s),{assignedEmployees:s.assignedEmployees.includes(e)?s.assignedEmployees.filter(s=>s!==e):[...s.assignedEmployees,e]}))})(e)}),o.jsx(c,{htmlFor:`employee-checkbox-${e}-${s}`,className:"text-sm cursor-pointer",children:e})]},`employee-${e}-${s}`))}),i.assignedEmployees.length>0&&o.jsxs("div",{className:"mt-2 flex items-center gap-1 text-sm text-green-600",children:[o.jsx(y,{className:"h-3 w-3"}),o.jsx("span",{children:"Selected employees will be notified automatically"})]})]}),o.jsxs("div",{children:[o.jsx(c,{children:"Required Skills (Optional)"}),o.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2 p-3 border rounded-md max-h-32 overflow-y-auto",children:q.map((e,s)=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(P,{id:`skill-checkbox-${e}-${s}`,checked:i.requiredSkills.includes(e),onCheckedChange:()=>(e=>{a(s=>d(n({},s),{requiredSkills:s.requiredSkills.includes(e)?s.requiredSkills.filter(s=>s!==e):[...s.requiredSkills,e]}))})(e)}),o.jsx(c,{htmlFor:`skill-checkbox-${e}-${s}`,className:"text-sm cursor-pointer",children:e})]},`skill-${e}-${s}`))})]}),o.jsxs("div",{children:[o.jsx(c,{htmlFor:"description",children:"Description (Optional)"}),o.jsx(N,{id:"description",value:i.description,onChange:e=>a(s=>d(n({},s),{description:e.target.value})),placeholder:"Add any additional details or instructions...",rows:3})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(u,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Cancel"}),o.jsx(u,{type:"submit",disabled:!i.title||!l,children:"Schedule Work & Notify"})]})]})]})})},L=[],W=()=>{const[e,s]=E.useState(new Date),[t,r]=E.useState(L),[i,a]=E.useState(!1),l=new Date,n=t.filter(e=>e.date>l&&"scheduled"===e.status).sort((e,s)=>e.date.getTime()-s.date.getTime())[0],d=e?t.filter(s=>s.date.getDate()===e.getDate()&&s.date.getMonth()===e.getMonth()&&s.date.getFullYear()===e.getFullYear()):[],c=t.filter(e=>"scheduled"===e.status).map(e=>e.date),x=e=>{switch(e){case"high":return o.jsx(C,{className:"bg-red-100 text-red-800",children:"High Priority"});case"medium":return o.jsx(C,{className:"bg-yellow-100 text-yellow-800",children:"Medium Priority"});case"low":return o.jsx(C,{className:"bg-green-100 text-green-800",children:"Low Priority"});default:return o.jsx(C,{variant:"outline",children:e})}},h=e=>{switch(e){case"completed":return o.jsx(C,{className:"bg-green-100 text-green-800",children:"Completed"});case"in-progress":return o.jsx(C,{className:"bg-blue-100 text-blue-800",children:"In Progress"});case"canceled":return o.jsx(C,{className:"bg-red-100 text-red-800",children:"Canceled"});default:return o.jsx(C,{className:"bg-gray-100 text-gray-800",children:"Scheduled"})}};return o.jsxs("div",{className:"container p-4 mx-auto max-w-7xl",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4",children:[o.jsx("h1",{className:"text-2xl font-bold",children:"Business Calendar"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs(u,{variant:"outline",onClick:()=>{w({title:"Calendar Exported",description:"Business calendar data exported to Excel successfully."})},className:"h-9 text-sm",children:[o.jsx($,{className:"mr-1 h-4 w-4"}),"Export"]}),o.jsxs(u,{variant:"default",onClick:()=>{a(!0)},className:"h-9 text-sm",children:[o.jsx(k,{className:"mr-1 h-4 w-4"}),"Schedule Work"]})]})]}),n&&o.jsx(S,{className:"p-4 mb-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:o.jsx(m,{className:"h-5 w-5 text-blue-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-blue-900",children:"Next Scheduled Work"}),o.jsx("p",{className:"text-blue-700 font-medium",children:n.title}),o.jsxs("p",{className:"text-sm text-blue-600",children:[M(n.date,"PPPP")," at ",M(n.date,"h:mm a")]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx(v,{className:"h-3 w-3 text-blue-600"}),o.jsxs("p",{className:"text-sm text-blue-600",children:["Assigned to: ",n.assignedEmployees.join(", ")]})]})]})]}),o.jsx(u,{variant:"outline",size:"sm",onClick:()=>{n&&s(n.date)},className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:"View Details"})]})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4",children:[o.jsx("div",{className:"lg:col-span-4",children:o.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-2",children:[o.jsx(D,{mode:"single",selected:e,onSelect:s,className:"rounded-md mx-auto pointer-events-auto",modifiers:{hasEvent:c,nextEvent:n?[n.date]:[]},modifiersStyles:{hasEvent:{backgroundColor:"#fef3c7",color:"#92400e",fontWeight:"bold"},nextEvent:{backgroundColor:"#dbeafe",color:"#1e40af",fontWeight:"bold",border:"2px solid #3b82f6"}}}),o.jsxs("div",{className:"mt-2 text-center",children:[o.jsx("p",{className:"text-xs text-muted-foreground",children:e?M(e,"PPPP"):"No date selected"}),o.jsxs("div",{className:"flex justify-center gap-4 mt-2 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-3 h-3 bg-yellow-200 rounded border"}),o.jsx("span",{children:"Has Work"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-3 h-3 bg-blue-200 rounded border-2 border-blue-500"}),o.jsx("span",{children:"Next Work"})]})]})]})]})}),o.jsx(S,{className:"p-3 lg:col-span-8 shadow-sm rounded-lg border border-gray-200",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h2",{className:"text-lg font-semibold border-b pb-2 border-gray-200",children:["Scheduled Work for ",e?M(e,"PPPP"):"Selected Date"]}),d.length>0?o.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[500px] pr-1",children:d.map(e=>o.jsx(S,{className:`p-3 shadow-sm border-l-4 rounded-md ${"high"===e.priority?"border-l-red-500":"medium"===e.priority?"border-l-yellow-500":"border-l-green-500"} ${e.id===(null==n?void 0:n.id)?"ring-2 ring-blue-300 bg-blue-50":""}`,children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("h3",{className:"font-medium text-sm flex items-center gap-2",children:[e.title,e.id===(null==n?void 0:n.id)&&o.jsx(C,{variant:"outline",className:"text-xs bg-blue-100 text-blue-700 border-blue-300",children:"Next Work"})]}),o.jsxs("div",{className:"flex gap-1",children:[x(e.priority),h(e.status)]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(m,{className:"h-3 w-3 text-muted-foreground mr-1"}),o.jsx("span",{children:M(e.date,"h:mm a")}),e.estimatedDuration&&o.jsxs("span",{className:"ml-1 text-muted-foreground",children:["(",e.estimatedDuration,"h)"]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"text-muted-foreground mr-1",children:"Created by:"}),o.jsx("span",{className:"font-medium",children:e.createdBy})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(v,{className:"h-3 w-3 text-muted-foreground"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Assigned to:"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:e.assignedEmployees.map((e,s)=>o.jsx(C,{variant:"outline",className:"text-xs h-5",children:e},s))})]}),e.assignedEmployees.length>0&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[o.jsx(T,{className:"h-3 w-3"}),o.jsx("span",{children:"Notified"})]})]}),e.description&&o.jsx("p",{className:"text-xs text-muted-foreground border-t pt-2",children:e.description}),e.requiredSkills&&e.requiredSkills.length>0&&o.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[o.jsx("span",{className:"text-muted-foreground",children:"Required skills:"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:e.requiredSkills.map((e,s)=>o.jsx(C,{variant:"secondary",className:"text-xs h-5",children:e},s))})]})]})},e.id))}):o.jsx("div",{className:"flex items-center justify-center py-10 text-muted-foreground bg-gray-50 rounded-md",children:o.jsxs("div",{className:"text-center",children:[o.jsx(m,{className:"mx-auto h-6 w-6 text-muted-foreground/60 mb-1"}),o.jsx("p",{className:"text-sm",children:"No work scheduled for this date."})]})})]})})]}),o.jsx(H,{open:i,onOpenChange:a,onEventAdded:e=>{r(s=>[...s,e]),e.assignedEmployees.length>0&&w({title:"Event Created & Notifications Sent",description:`${e.title} has been scheduled and all assigned employees have been notified.`})}})]})};export{W as default};
